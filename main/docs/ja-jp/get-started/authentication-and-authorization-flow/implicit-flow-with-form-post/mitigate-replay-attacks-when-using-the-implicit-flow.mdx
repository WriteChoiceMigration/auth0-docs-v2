---
og:description: Learn how to securely generate and validate a cryptographic nonce
  for use with the Implicit Flow with Form Post.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: 暗黙フロー使用時にリプレイ攻撃を軽減する
og:url: https://auth0.com/docs/
permalink: mitigate-replay-attacks-when-using-the-implicit-flow
title: 暗黙フロー使用時にリプレイ攻撃を軽減する
twitter:description: Learn how to securely generate and validate a cryptographic nonce
  for use with the Implicit Flow with Form Post.
twitter:title: 暗黙フロー使用時にリプレイ攻撃を軽減する
---

[フォームPOSTを使用した暗黙フロー](/login/flows/implicit-flow-with-form-post)でリプレイ攻撃を軽減するために、認証要求では必ずノンスを送信しなければなりません。これは[OpenID Connect（OIDC）の仕様でも要求](https://openid.net/specs/openid-connect-core-1_0.html#ImplicitAuthRequest)されています。

ノンスはアプリケーションが生成し、`nonce`クエリ文字列パラメーターとして認可要求に含めて送信され、Auth0からのIDトークン応答に含まれます。そうすることで、アプリケーションはAuth0からのIDトークン応答と当初の認証要求を相互に関連付けることができます。

ノンスを含める場所については、「[フォームPOSTを使用した暗黙フローでログインを追加する](/login/authentication/add-login-using-the-implicit-flow-with-form-post)」を参照してください。



## 暗号的にランダムのノンスを生成する

暗号的にランダムのノンスを生成するには、1つの方法として[Nano ID](https://github.com/ai/nanoid)などのツールを使用することができます。ただし、ツールとJavaScriptコードをバンドルする必要があります。それが不可能な場合には、[最新のブラウザー](http://caniuse.com/#feat=cryptography)が[Web Crypto API](https://www.w3.org/TR/WebCryptoAPI/)を使用して暗号的に安全なランダムの文字列をノンス用に生成できることを活用することができます。



## 要求間でノンスを保持する

生成されたノンスは、以下の方法を使って、Webアプリケーションで保持されなければなりません。

* `HttpOnly`セッションクッキー
* HTML5のローカルストレージ値

例：



## IDトークンを検証する

Auth0が[IDトークン](/security/tokens/id-tokens)で応答したら、このトークンを通常通りに[検証してデコード](/security/tokens/id-tokens/validate-id-tokens)する必要があります。`nonce`クレームには、要求で送信したのと完全に同じ値が含まれていなければなりません。そうでない場合には、アプリケーションが認証を拒否する必要があります。