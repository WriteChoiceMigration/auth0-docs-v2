---
og:description: Learn how to use JWT-Secured Authorization Requests (JAR) with the
  Authorization Code Flow.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: JWT-Secured Authorization Requests（JAR）を使った認可コードフロー
og:url: https://auth0.com/docs/
permalink: authorization-code-flow-with-jar
title: JWT-Secured Authorization Requests（JAR）を使った認可コードフロー
twitter:description: Learn how to use JWT-Secured Authorization Requests (JAR) with
  the Authorization Code Flow.
twitter:title: JWT-Secured Authorization Requests（JAR）を使った認可コードフロー
---

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

To use Highly Regulated Identity features, you must have an Enterprise Plan with the Highly Regulated Identity add-on. Refer to [Auth0 Pricing](https://auth0.com/pricing/) for details.

</Callout>

[JWT-Secured Authorization Request (JAR)](https://datatracker.ietf.org/doc/html/rfc9101) is an extension of the OAuth2 protocol and adds a layer of security to protect the integrity of authorization request parameters.

## 前提条件

To use JAR, you must first [generate an RSA key pair](/docs/secure/application-credentials/generate-rsa-key-pair). Then, register the public key with Auth0 as explained in [Configure JWT-Secured Authorization Requests](/docs/get-started/applications/configure-jar).

During the authorization code flow, the client application takes the parameters they would like to send to the `/authorize` or `/oauth/par` endpoints and wraps them in a [JSON Web Token (JWT)](/docs/secure/tokens/json-web-tokens), which they then sign using the private key.

The <Tooltip tip="Authorization Server: Centralized server that contributes to defining the boundaries of a user’s access. For example, your authorization server can control the data, tasks, and features available to a user." cta="View Glossary" href="/docs/glossary?term=authorization+server">authorization server</Tooltip> verifies the signature with your application's public key. If the signature is valid, the authorization server extracts the request parameters from JAR and processes the request as usual. As a result, the parameter values are guaranteed to come from a known source, and cannot be tampered with or accessed by intermediaries.

## JAR要求を生成する

To generate a JAR request, you need to first create a [JSON Web Token (JWT)](/docs/secure/tokens/json-web-tokens). Use the [Auth0 JWT library](https://jwt.io/libraries) to help you generate a <Tooltip tip="JSON Web Token (JWT): Standard ID Token format (and often Access Token format) used to represent claims securely between two parties." cta="View Glossary" href="/docs/glossary?term=JWT">JWT</Tooltip> in your preferred language.

### ヘッダー

JAR要求の場合、JWTヘッダーには次のフィールドが含まれている必要があります：

* `alg`：JWTに署名するために使用されるアルゴリズム。RS256、RS384、またはPS256のいずれかである必要があります。
* `typ`：JWTの種類です。`jwt`または`oauth-authz-req+jwt`のいずれかである必要があります。

The header may also contain a `kid` field that identifies the key used to sign the JWT. If a `kid` is present, Auth0 will look for a public key registered during [JAR configuration](/docs/get-started/applications/configure-jar) that has a matching key ID and use that key to verify the JWT’s signature.

### ペイロード

JWTペイロードには次のクレームが含まれている必要があります：

* `iss`：これにはアプリの`client_id`が含まれている必要があります
* `aud`: This must be your tenant’s domain, with the protocol and a trailing forward slash. For example, `https://your_domain.auth0.com/`

JWTには、`/authorize`の呼び出しに必要なパラメータも含まれている必要があります。例：

* `client_id`：これにはアプリの`client_id`も含まれている必要があります
* `response_type`: Indicates to Auth0 which <Tooltip tip="OAuth 2.0: Authorization framework that defines authorization protocols and workflows." cta="View Glossary" href="/docs/glossary?term=OAuth+2.0">OAuth 2.0</Tooltip> flow you want to perform. Use `code` for Authorization Code Grant Flow.

The JWT may contain any of the optional parameters for the <Tooltip tip="Authorization Flow: Authorization grant (or workflow) specified in the OAuth 2.0 framework." cta="View Glossary" href="/docs/glossary?term=authorization+flow">authorization flow</Tooltip> that is being requested, such as `audience`, `scope`, `state`, `redirect_uri`, among others.

さらに、JWTには次のオプションのクレームが含まれる場合があります：

* `iat`：数値の日付である必要があります。
* `nbf`：過去の時間を表す数値の日付である必要があります。
* `exp`：将来の時刻を表す数値の日付である必要があります。
* `jti`：64バイト以下の文字列である必要があります。

### JWTの生成例

The following JavaScript code sample demonstrates how to build and sign a JWT using JavaScript and the [jsonwebtoken library](https://www.npmjs.com/package/jsonwebtoken?activeTab=readme). It outputs the generated JWT to the console:

```javascript lines expandable
const jwt = require('jsonwebtoken');
const crypto = require("crypto");
const fs = require('fs');

const privateKey = fs.readFileSync('[PATH TO YOUR PEM FILE]');
const client_id = '[YOUR CLIENT ID]';
const nonce = crypto.randomBytes(16).toString('hex');

const requestObject = jwt.sign(
{
  iss: client_id,    
  aud: 'https://your_tenant.auth0.com/', // your tenant's domain
  client_id,
  response_type: "code",
  scope: "openid profile",
  redirect_uri : "https://myapp.com/callback" // your app's callback URL
  nonce
},
privateKey,
{
  keyid: '[YOUR KID]', // optional key id (kid) value from your public key
  algorithm: 'RS256',
  header: {
    typ: 'oauth-authz-req+jwt',
  },
});

console.log(requestObject);
```






### 認可エンドポイントを呼び出す

To call the `/authorize` endpoint using your signed JWT, open a new browser window. Pass your <Tooltip tip="Client ID: Identification value given to your registered resource from Auth0." cta="View Glossary" href="/docs/glossary?term=Client+ID">Client ID</Tooltip> as the `client_id` parameter and the signed and URL-encoded JWT as the `request` parameter.

```bash lines
# MacOS
open "https://your_tenant.auth0.com/authorize?client_id=[YOUR CLIENT ID]&request=[URL ENCODED JWT]"

# Windows
explorer "https://your_tenant.auth0.com/authorize?client_id=[YOUR CLIENT ID]&request=[URL ENCODED JWT]"
```






## Learn more

* [Configure JWT-secured Authorization Requests (JAR)](/docs/get-started/applications/configure-jar)