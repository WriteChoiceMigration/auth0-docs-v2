---
og:description: Describes how to build an assertion to use Private Key JWT Authentication.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: 秘密鍵JWTで認証する
og:url: https://auth0.com/docs/
permalink: authenticate-with-private-key-jwt
title: 秘密鍵JWTで認証する
twitter:description: Describes how to build an assertion to use Private Key JWT Authentication.
twitter:title: 秘密鍵JWTで認証する
---

`private_key_jwt:`で認証をするには、2つの手順を完了する必要があります。

1. クライアントアサーションを構築します。このアサーションはキーペアを生成した際に秘密鍵で署名されたJWTです。キーペア生成の詳細については、「[秘密鍵JWTの認証を構成する](/applications/configure-private-key-jwt)」をお読みください。
2. Auth0に対してアサーションを使用して認証します。

## アサーションを構築する

Auth0のSDKのいずれかを使用して、アサーションを自動的に構築できます。SDKを使用しない場合、ご自身でアサーションを構築する必要があります。

アサーションとは、以下のプロパティとクレームを含む必要があるJSON Web Token（JWT）のことです。



* ヘッダー

* `alg`：アサーションの署名に使用されるアルゴリズム。アルゴリズムはアプリケーションの資格情報を作成した際に指定されたアルゴリズムと一致している必要があります。
* `kid`**：**（任意）Auth0が生成した資格情報の`kid`。`kid`は、資格情報を作成する際に作られます。
* ペイロード

* `iss`**：**アプリケーションのクライアントID。この値はアプリケーション設定にあり、[［Auth0 Dashboard］>［Applications（アプリケーション）］>［Applications（アプリケーション］](https://manage.auth0.com/dashboard/#/applications/)に移動して、**［Settings（設定）］**タブを選択すると見つかります。
* `sub`**：**アプリケーションのクライアントID。この値もアプリケーション設定で見つけることができます。[［Auth0 Dashboard］>［Applications（アプリケーション）］>［Applications（アプリケーション］](https://manage.auth0.com/dashboard/#/applications/)に移動して、**［Settings（設定）］**タブを選択します。
* `aud`**：**アサーションを受け取るAuth0テナントのURLまたはカスタムドメイン。例：`https://{yourTenant}.auth0.com/`**。**末尾のスラッシュを含めます。
* `iat`（任意）と`exp`：「発行日時」と「有効期限」クレームを正しいタイムスタンプで設定します。クライアントのアサーションは、一度限り使用できるトークンで、可能な限り短い有効期限の設定をお勧めします。Auth0はトークンのライフタイムとして最長5分間をサポートします。
* `jti`：クライアントが作成した一意のクレームID。Universally Unique Identifier（UUID）フォーマットの使用をお勧めします。

そしてトークンは、秘密鍵JWT認証のためにアプリケーションを作成または構成した際に生成された秘密鍵で署名される必要があります。その方法については、「[JSON Web Tokenの仕様](https://www.rfc-editor.org/rfc/rfc7519#section-7.1)」をご確認ください。

標準ツールやこの機能をサポートするサードパーティライブラリを使用してトークンを構築することを推奨します。ゼロから独自に実装するのは避けてください。サポートしているライブラリの詳細については、[JWT.io](https://jwt.io/libraries)のリストを参照してください。

### 例

以下の例では、Node.jsスクリプトが[joseパッケージ](https://github.com/panva/jose)を使用してアサーションを生成しています。



秘密鍵で署名したクライアントアサーションの例

以下に対応しています。



必要な情報でJWTを生成したら、Auth0に対してアプリケーションを認証する準備が整います。

## アサーションをアクセストークンと交換する



JWTアサーションをアクセストークンと交換するには、以下のパラメーターで認証APIの[トークンエンドポイント](https://auth0.com/docs/api/authentication#authenticate-user)を呼び出します。

* `$client_assertion`：JWTアサーション
* `$resource_server_identifier`：リソースサーバーの識別子。詳細については、「[APIを登録する](/get-started/set-up-apis)」お読みください。



## サポートされているエンドポイント

[https://$tenant/oauth/token](https://auth0.com/docs/api/authentication#get-token)エンドポイントに加え、以下のAuth0 Authentication APIエンドポイントは、構成済みアプリケーションの`private_key_jwt`認証をサポートしています。

* [POST /oauth/revoke](https://auth0.com/docs/api/authentication#revoke-refresh-token)
* [POST /mfa/challenge](https://auth0.com/docs/api/authentication#challenge-request)
* [POST /passwordless/start](https://auth0.com/docs/api/authentication#get-code-or-link)

## アサーションの制限

JWTアサーションの最大長は2048バイトです。

アサーション内のクレームには次の制限があります。

* `iss`：64文字
* `sub`：64文字
* `jti`：64文字
* `alg`：16文字