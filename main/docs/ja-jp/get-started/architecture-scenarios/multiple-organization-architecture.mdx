---
og:description: An integration guide to multi-tenant architectures that must accommodate
  application instances for multiple Auth0 Organizations.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: 複数組織のアーキテクチャ
og:url: https://auth0.com/docs/
permalink: multiple-organization-architecture
sidebarTitle: 複数組織のアーキテクチャ
title: 複数組織のアーキテクチャ
twitter:description: An integration guide to multi-tenant architectures that must
  accommodate application instances for multiple Auth0 Organizations.
twitter:title: 複数組織のアーキテクチャ
---

ユーザーがサードパーティーの組織に属していて、指定のサービスでサインアップしなければならないユースケースはいくつかあります。そのようなユーザーは、サードパーティー組織の従業員や顧客、またはその両方であるかもしれません。状況にかかわらず、このガイドでは複数テナントのアプリケーションについて、一般的なユースケースの技術的な概要を説明します。

B2Bアプリケーションは、サービスを提供する企業の社員や顧客を対象に、快適なユーザーエクスペリエンスの作成を目指しています。これを達成するために、B2B環境のサービスプロバイダーは通常、利用者である各組織のサービスにブランディングを追加できるようにします。たとえば、勤めているAwesomeSaaS（SaaSソフトウェア企業）にHuman0という人事アプリケーションがあり、福利厚生や他の人事業務を管理しているとします。人事アプリにアクセスして、ログインするときには、ログインエクスペリエンスがAwesomeSaaSのロゴと色を表示するようにカスタマイズされます。

Auth0との統合はB2Bサービスプロバイダーが設計するため、顧客（サードパーティーの組織）が自社専有のアプリケーションインスタンスに他の組織からのユーザーログインを許可するのか、そして、それらのユーザーを組織間で共有するのか、それとも単一組織に分離するのかを検討することが必要になります。

さまざまなユースケースが理解できるように、いくつかのアプリケーションを例にして説明します。Travel0は、オンラインの旅行代理店サービスを提供する架空の会社です。Travel0にはいくつかのアプリケーションがありますが、この例では、以下の組織に直接提供される2つのアプリケーションに的を絞って説明します。

* **Travel0 Corporate Booking**：組織にオンラインアプリケーションを提供し、社員がログインして出張を手配できるようにしている。このアプリケーションの顧客は次のような組織です。

  + **Hoekstra & Associates**：社員が数人だけの小規模の法律事務所。IT部はなく、会社にIDプロバイダー（IdP）をセットアップする方法を学ぶ時間・人材もない。
  + **Gupta & Smith Law**：大規模の法律事務所だが、IT部はなく、会社にIdPをセットアップする方法を学ぶ時間・人材もない。
  + **MetaHexa Bank**：大規模の金融機関。銀行・保険サービスを提供し、自社専有のIdPがある。
  + **Many Student University（MSU）**：大規模の大学でいくつかのキャンパスがあり、それぞれのキャンパスに専有のIdPがある。
* **Travel0 Adventure Management**：組織が急流下りなどのアドベンチャーを計画して販売できるようにしている。ガイド（フリーランス、またはサードパーティーの旅行会社やイベント会社の社員）はこのアプリケーションを使用して、アカウントの作成とアドベンチャーのスケジュール管理を行う。このアプリケーションの顧客は次のような組織です。

  + **AdventureZ**：大規模の旅行・イベント企画会社。社員のための専有のIdPがある。スタッフとして十分な人数のガイドを雇っているため、フリーランスを手配する必要がほとんどなく、多忙なときにだけ働くスタッフもいる。雇用しているガイドがフリーランスとして他企業の仕事を受けられるようにもしている。
  + **Rocky Mountain High Adventures**：初めて市場に参入する新興企業。共同創立者がツアーを担当し、多忙なときにはフリーランスを雇っている。
  + **Suzie’s Rafting and Ziplines**：創業してから長く営業を続けている会社。ほんとんどのイベントはスタッフがガイドとして担当しているが、多忙なときにはフリーランスも雇っている。

## 用語

ガイダンスで使われている用語の多くには、いくつかの異なる意味があります。例で登場する人物がどのような役割を果たしているのかがはっきりと分かるように、それぞれの用語の意味を読んで理解してください。

* **Auth0 Tenant** (otherwise known as **<Tooltip tip="Authorization Server: Centralized server that contributes to defining the boundaries of a user’s access. For example, your authorization server can control the data, tasks, and features available to a user." cta="View Glossary" href="/docs/glossary?term=Authorization+Server">Authorization Server</Tooltip>**)**:** Tenant that you create in Auth0. It is an instance of an Authorization Server and represents one or more user domains.
* **Auth0 Organizations:** Refers to the Auth0 Tenant feature designed to support organizations. An instance of an [Auth0 Organization](/docs/manage-users/organizations/organizations-overview) will typically refer to a specific customer of yours.
* **Employee**: Person who works for your company. They will typically have an account in your <Tooltip tip="Identity Provider (IdP): Service that stores and manages digital identities." cta="View Glossary" href="/docs/glossary?term=Identity+Provider">Identity Provider</Tooltip> (IdP) and may need admin access to one or more Organization Tenant instances. We will only use the term Employee to refer to Employees of your company. For users who belong to your customers' Organizations, see **Organization User**.
* **IDプロバイダー（IdP）：**Auth0など、ユーザーの認証を管理するサービスです。ユーザープロファイル情報や資格情報を管理することもあります。サードパーティーIdP（Azure AD・Google・Facebookなど）を使用して資格情報検証やプロファイル管理の委任を可能にすることもあります。
* **Organization:** Third-party company that is one of you customers. You may refer to an organization instance that is created for your application as a tenant; we will refer to it as an **Organization Tenant** to avoid confusing it with an Auth0 Tenant.
* **組織テナント：**貴社のアプリケーションのサブスクリプションやプロビジョニングの一部として、貴社の顧客のために作成したテナントのことです。Auth0テナントとは異なります。
* **組織ユーザー：**組織のメンバーとしてアプリケーションにログインする人のことです。顧客や（組織の）社員であるかもしれません。組織のコンテキストで言及される「ユーザー」は、組織ユーザーと考えることができます。

## ユーザーの分離

組織ユーザーを分離する場合には、アプリケーションの種類を決めることが重要です。それぞれのユーザーを分離する場所と方法については、基本的に[組織でユーザーを分離する](#users-isolated-by-organization)方法と[組織間でユーザーを共有する](#users-shared-between-organizations)方法の2つがあります。

<Frame>![Architecture Scenarios - Multitenancy - Diagram - Multiple organizations shared decision](/images/cdy7uua7fh8z/5PIUlQgG5PmnzaWjtD6J5t/9956e135a587611c234ece90ab7e3af4/multiple-org-shared-decision.png)</Frame>

上のフロー図は、意思決定のプロセスを表します。また、組織インスタンスに[管理者タイプのアクセス](#administrative-access-to-organizations)が必要かどうかも検討しなければなりません。これは、1つ以上の組織の管理者である貴社組織の社員や、ヘルプデスクサービスなどを提供する何らかのサードパーティーに必要かもしれません。

以下のセクションでは、ユーザーを分離するそれぞれの方法について詳しく説明します。（ユーザーに複数組織へのアクセスが必要になる）変則的なシナリオをよく理解してください。そのようなユースケースによって、貴社の要件に合致した方法が分かることがよくあります。

### 組織別に分離するユーザー

組織には、それぞれ独自のユーザーセットがあり、ユーザーが他組織にアクセスできないようにする必要があります。アクセスしようとした場合には、不正として拒否されなければなりません。必要であれば、ユーザーがそれぞれの所属組織で個別のアカウントを作成するように強制できます。その場合には、1人でも、ユーザーとしては異なる2人以上の人だと見なされます。

このシナリオでは、所属する組織またはアクセス権のある組織にユーザーを直接結びつけます。どのようにログインするかについて、ユーザーには以下の2つのオプションがあります：Ａ）適切な組織にプロビジョニングされたIDストレージで資格情報を作成する（Auth0テナントにあるユーザーIDとパスワードのデータベース接続）か、B）ユーザーが自身の組織のIdPでログインする。このユースケースでは、ユーザーが複数組織に属することは理にかないません。それぞれの組織に個別のIDを作成する方が便利です。Travel0 Corporate Bookingを例にすると、下の図のようになります。

<Frame>![Architecture Scenarios - Multitenancy - Diagram - Isolated users](/images/cdy7uua7fh8z/42jUyjrrYapzZaxEsCTvw6/3722ece70744d0853a39e0c51fe6c380/isolated-users.png)</Frame>

Sallyは、典型的なユーザーです。MetaHexa Bankの社員で、MetaHexa BankのTravel0 Corporate Bookingインスタンスにのみアクセスできます。

そして、Patは特殊なユーザーです。Patは、フリーランスのパラリーガルとしてHoekstra & AssociatesとGupta & Smith Lawの両方から仕事を受けているため、個別のユーザーIDを使ってそれぞれの組織のTravel0 Corporate Bookingインスタンスにアクセスします。この方法での利点の1つは、Patに法律事務所でそれぞれ個別にペルソナの作成を強制すると、エラー発生の可能性を制限できることです。Patは、出張関連の予約を行うときに、該当する組織のインスタンスに個別にログインしなければなりません。

Patの状況はおそらく稀なユースケースですが、ユーザーの分離要件を決めるときに考慮するべき事柄がはっきりと分かります。ユーザーを関連する組織で分離したい場合には、個別のユーザーIDを作成する必要があります。Patには、Hoekstra & AssociatesのTravel0 Corporate BookingインスタンスにアクセスするためのIDと、Gupta & Smith LawのTravel0 Corporate BookingインスタンスにアクセスするためのIDがあります。

#### 組織別に分離するユースケース

ユーザーを組織別に分離したアプリケーションは、通常、3つのユースケースをサポートします。このセクションでは、上記で説明したTravel0 Corporate Bookingアプリケーションのシナリオを例として使用します。Auth0の顧客は、Travel0です。

* **Organizations that either don’t have their own IdP or don’t know how to use it**. These tend to be smaller organizations that don’t have an IT department available to configure <Tooltip tip="Single Sign-On (SSO): Service that, after a user logs into one applicaton, automatically logs that user in to other applications." cta="View Glossary" href="/docs/glossary?term=Single+Sign-On">Single Sign-On</Tooltip> (SSO) with the organization’s Identity Provider (IdP), or else don’t have an organization IdP fit for the task. In our Travel0 Corporate Booking example, Hoekstra & Associates is such an organization.
* **組織が専有のIdPを構成したい**、社員がアプリケーションに新しい資格情報セットを作成しなくてもいいようにしたいと考えている。ほとんどの組織がこれに分類されます。Travel0 Corporate Bookingの例では、MetaHexa Bankがそのような組織になります。
* **複数の認証オプションを必要とする組織**。たとえば、頻繁に新しい会社を買収する組織、教職員と保護者が同じアプリケーションにログインする学校、パートナーや顧客に自社のアプリケーションインスタンスへのログインを許可する組織（B2B2C組織）などです。紹介している例では、Many Student University（MSU）がそれに該当します。

For the first two types of organizations, the solution tends to be fairly straightforward. These organizations are considered Single IdP organizations, and the approach is almost always the same. To learn more, read [Single Identity Provider Organizations](/docs/get-started/architecture-scenarios/multiple-organization-architecture/single-identity-provider-organizations).

Organizations that have more than one IdP for the organization trend toward a higher order of intricacy, but there are a few approaches that can minimize complexity. To learn more, read [Multiple Identity Provider Organizations](/docs/get-started/architecture-scenarios/multiple-organization-architecture/multiple-idp-orgs).

### 組織間で共有するユーザー

複数の組織に所属するユーザーでも、個別のID/アカウントを持たずに組織間を移動できれば便利です。そのような場合でも組織は専有のIdPを使用できます。

<Frame>![Architecture Scenarios - Multitenancy - Diagram - Shared users](/images/cdy7uua7fh8z/3z920KV1sDj6v0xUM1PLy4/fb82e123670dd1f0abd789f5b0d59ca1/shared-users.png)</Frame>

このシナリオでは、ユーザーは、所属する組織、またはアクセス権のある組織に直接結びつけられません。どのようにログインするかについて、ユーザーには以下の2つのオプションがあります：Ａ）組織のAuth0テナントで特別に割り当てられたIDストアではなく、一般にプロビジョニングされたIDストレージで資格情報を作成する（Auth0テナントにある1つのユーザーIDとパスワードのデータベース接続）か、B）ユーザーが自身の組織のIdPでログインする。IDが作成されると、ユーザーに、各団体へのアクセス権限が与えられます。人によって、1組織だけにアクセスする場合もあれば、複数の組織にアクセスする場合もあります。ユーザーは、ログインが要求されたときに同じ資格情報でどの組織のインスタンスにもアクセスできることを理解する必要があります。Travel0 Adventure Managementを例にすると、上の図のようになります。

典型的なユーザーであるJonnnoは、Suzie’s Rafting and Ziplinesの社員です。Jonnoがログインできるのは、アウトドアツアーの作成のためにSuzie’s Rafting and Ziplinesが使用しているTravel0 Adventure Managementインスタンスのみです。Jonnoの資格情報は、Travel0のAuth0テナントか、Suzie’s Zipline and RaftingのIdPに保管されます（同社がユーザーIDを社内で管理したいかどうかによる）。

特殊なユーザーであるSumanaは、AdventureZの社員ですが、AdventureZは小規模のガイド企業が多忙な時期にフリーランスも提供するため、Rocky Mountain High Adventuresにフリーランスとして招待されています。Sumanaは、AdventureZとRocky Mountainの両方のTravel0 Adventure Managementインスタンスへのログインが認可されています。ただし、Suzie’s Rafting and Ziplinesの仕事は受けたことがないため、同社のインスタンスにはアクセスできません。

ガイドには評価システムがあるため、Sumanaは、両方の組織で同じIDを使用しなければなりません。また、Sumanaの評価が、契約主である複数の組織間で引き継がれ、結合される必要があります。Jonnoの場合と同様に、Sumanaの資格情報は、Travel0のAuth0テナントのデータベース接続か、AdventureZのIdPに保管されます（同社がユーザーIDを社内で管理したいかどうかによる）。Sumanaの資格情報がどこに保管されるかは、どの組織のインスタンスにアクセスできるかとは関係がありません。

### 組織への管理者アクセス

There are scenarios where you will need to provide administrative access across your organizations. Typically, this will be for administrative tasks outside of user Profile/Account management (as described in [Profile Management](/docs/get-started/architecture-scenarios/multiple-organization-architecture/single-identity-provider-organizations/profile-management)), and you may need to provide access to your employees as well as to third parties.

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

**Best Practice**

Always enable Multi-factor Authentication (MFA) for Auth0 Tenant administrators who are provided access via the Auth0 Dashboard. Note that you must follow a different process to enable MFA for an Auth0 Tenant administrator than you do to enable MFA for the Auth0 Tenant itself. To learn how to enable MFA for an Auth0 Tenant Administrator, see [Manage Dashboard Access with Multi-factor Authentication](/docs/get-started/manage-dashboard-access/add-change-remove-mfa).

</Callout>

The <Tooltip tip="Auth0 Dashboard: Auth0's main product to configure your services." cta="View Glossary" href="/docs/glossary?term=Auth0+Dashboard">Auth0 Dashboard</Tooltip> can be configured via [role-based access control](/docs/get-started/manage-dashboard-access/feature-access-by-role), which will allow you to define specific roles for your employees across your Auth0 Tenant deployment as a whole. You can even leverage your own corporate IdP to provide Auth0 Tenant Administrator authentication for your employees, as well as extended Tenant Administrator access to trusted third-parties.

For other administrative access, you will typically want to build your own API and/or application, which you will use in conjunction with the Auth0 <Tooltip tip="Management API: A product to allow customers to perform administrative tasks." cta="View Glossary" href="/docs/glossary?term=Management+API">Management API</Tooltip>. Providing administrative access to your Auth0 Tenant via the Auth0 Dashboard for a wide range of users is not recommended. While building such an application/API is beyond the scope of this document, it’s recommended that you seek help from [Auth0 Professional Services](/docs/get-started/professional-services) before embarking on such an endeavor.

## Learn more

* [Single Identity Provider Organizations](/docs/get-started/architecture-scenarios/multiple-organization-architecture/single-identity-provider-organizations)
* [Multiple Identity Provider Organizations](/docs/get-started/architecture-scenarios/multiple-organization-architecture/multiple-idp-orgs)