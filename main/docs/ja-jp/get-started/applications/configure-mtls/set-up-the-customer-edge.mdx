---
og:description: Learn how to set up your customer edge for mTLS authentication.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: カスタマーエッジをセットアップする
og:url: https://auth0.com/docs/
permalink: set-up-the-customer-edge
title: カスタマーエッジをセットアップする
twitter:description: Learn how to set up your customer edge for mTLS authentication.
twitter:title: カスタマーエッジをセットアップする
---

This section explains how to set up the customer edge network. The specifics of configuring different edge networks are out of the scope of this document. For more information, see the [custom domains](/docs/customize/custom-domains) documentation.

The customer’s edge domain must match the registered <Tooltip tip="Custom Domain: Third-party domain with a specialized, or vanity, name." cta="View Glossary" href="/docs/glossary?term=custom+domain">custom domain</Tooltip>. If mTLS endpoint aliases are enabled, the customer edge must also accept requests on the subdomain used by the mTLS aliases. All requests that arrive at the mTLS subdomain should request a client TLS certificate and verify that the certificate is registered for use. For more information, see [Verify the client certificate](#verify-the-client-certificate).

TLSハンドシェイクは、要求されたパスをエッジインフラストラクチャが決定できる前に発生します。TLSセッションが確立されると、顧客はパスを検査して、以下のエンドポイントに対する要求のみを転送することができます。

* `/oauth/token`
* `/oauth/par`
* `/userinfo`

If your installation aims for FAPI compliance, additional requirements related to TLS are placed on your edge network. For more information, see the [FAPI1 Baseline](https://openid.net/specs/openid-financial-api-part-1-1_0.html#tls-and-dnssec-considerations), [FAPI1 Advanced](https://openid.net/specs/openid-financial-api-part-2-1_0.html#tls-considerations), and [FAPI2 Baseline](https://openid.net/specs/fapi-2_0-baseline.html#name-network-layer-protections) specifications.

## クライアント証明書を検証する

カスタマーエッジネットワークは、予期されているタイプの証明書に適切な検証を行います。セキュリティ関連のよくある問題や危険を回避するために、可能であれば、十分に検査されている証明書検証ライブラリーを使用してください。クライアント証明書が検証に失敗した場合の動作はインストールによってさまざまであり、その説明はこのドキュメントの範囲外です。

### CA署名証明書

証明機関が証明書に署名すると、ルート証明書も含めて、信頼チェーンを確認する必要があります。証明書が登録済みで、取り消されていないことを確認するために、証明書を許可リストや拒否リストに照らし合わせて比較することもあります。証明書を署名するのに、公的証明機関（LetsEncryptなど）を使用してはいけません。クライアントになりすまされる危険があります。

### 自己署名証明書

自己署名証明書には信頼チェーンによる裏付けがないため、証明書チェーンを確認できません。その場合には、証明書サムプリントを登録済み証明書のデータベースに照らし合わせて確認するか、直接Auth0に転送して確認します。

## 要求を転送する

Once the certificate is verified, requests are forwarded along with several special headers from the customer to the same endpoint on the custom domain’s forwarding target at [Auth0's edge network](/docs/customize/custom-domains/self-managed-certificates). The forwarded request must include the following headers:

* カスタムドメインのAPIキーを`cname-api-key`ヘッダーとして含めます。
* クライアント証明書を`client-certificate`ヘッダーとして含めます。**注意**：HTTPヘッダーはテキストでなければならないため、証明書をPEMエンコードされたURLコンポーネントに変換する必要があります。ヘッダー値の上限は4096バイトです。そのため、チェーンにある最初の証明書をAuth0に転送する必要があります。
* クライアント証明書のCA検証ステータスを`client-certificate-ca-verified`ヘッダーとして含めます。`client-certificate-ca-verified`ヘッダーには、以下の値を含めることができます。

  + **SUCCESS**：クライアント証明書が有効で、証明機関によって検証済みです。
  + **FAILED:** indicates that the presented client certificate is valid, however the certificate's trust chain has NOT been verified by a certificate authority. In other words, it’s a self-signed certificate. May include an optional failure reason.

構成がCA署名証明書のみに対応している場合には、自己署名証明書をAuth0のエッジネットワークに転送する必要はありません。要求を早期に終了させることができます。自己署名証明書での認証がクライアントに構成されている場合には、Auth0はネットワークエッジから`client-certificate-ca-verified:FAILED`ヘッダーの送信を期待します。このヘッダーの値によって、Auth0はどのクライアント認証方法が使用され、どのクライアント資格情報に検証の必要があるのかを理解します。

## Learn more

* [Authenticate with mTLS](/docs/get-started/authentication-and-authorization-flow/authenticate-with-mtls)
* [Configure mTLS Authentication for a Tenant](/docs/get-started/applications/configure-mtls/configure-mtls-for-a-tenant)
* [Configure mTLS Authentication for a Client](/docs/get-started/applications/configure-mtls/configure-mtls-for-a-client)