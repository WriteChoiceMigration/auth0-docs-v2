---
og:description: Learn how to decouple APIs from applications that consume them and
  define third-party apps that you don't control or may not trust.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: ユーザーの同意とサードパーティアプリケーション
og:url: https://auth0.com/docs/
permalink: user-consent-and-third-party-applications
title: ユーザーの同意とサードパーティアプリケーション
twitter:description: Learn how to decouple APIs from applications that consume them
  and define third-party apps that you don't control or may not trust.
twitter:title: ユーザーの同意とサードパーティアプリケーション
---

[OIDC](/protocols/openid-connect-protocol)準拠の認証パイプラインでは、リソースサーバー（APIなど）をアプリケーションとは別のエンティティとして定義することができます。そうすることで、APIを使用するアプリケーションからAPIを切り離すだけでなく、[サードパーティアプリケーション](/applications/confidential-and-public-applications/first-party-and-third-party-applications)を定義して、外部パーティに対し、APIの内部で保護されているリソースへの安全なアクセスを許可することができます。

## 同意ダイアログ

ユーザーがサードパーティアプリケーションを通じて認証を行い、そのアプリケーションがユーザー情報へのアクセスや、代理としてAPIで何らかのアクションを行うことへの認可を求める場合、ユーザーに対して同意ダイアログが表示されます。

たとえば、このような要求：



は、次のようなユーザー同意ダイアログになります。

ユーザーがアプリケーションの要求を承認すると、ユーザー権限付与が作成されます。付与は、このアプリケーション、このリソースサーバー、このスコープの組み合わせに対するユーザーの同意を表します。アプリケーションは、その後、通常どおりにAuth0から認証成功の応答を受け取ります。

一度同意が与えられると、その同意が明示的に取り消されるまで、ログイン時に同意ダイアログが表示されなくなります。

## スコープの説明

デフォルトでは、同意ページは、スコープの名前を使ってユーザーの同意を求めます。下の図のように、スコープ名を**action:resource_name**形式で定義します。

同意ページは、同じリソースに対するスコープをグループにまとめ、そのリソースに対するアクションを1行に表示します。たとえば上記の構成では、**Posts: read and write your posts（投稿：あなたの投稿の読み取りと書き出し）**と表示されます。

代わりに**［Description（説明）］**フィールドを表示したい場合は、テナントの**use_scope_descriptions_for_consent**を**true**に設定します。これは、そのテナント上のすべてのAPIの同意プロンプトに影響します。

**use_scope_descriptions_for_consent**フラグを設定するには、APIに適切な呼び出しをする必要があります。



## 拒否された許可に対処する

ユーザーがアプリケーションへの同意を拒否した場合は、要求の中で指定された`redirect_uri`に、`access_denied`エラーと共にリダイレクトされます。



## ファーストパーティアプリケーションに対して同意をスキップする

ファーストパーティアプリケーションは、同意ダイアログをスキップできますが、これはユーザーの代わりにアクセスしようとしているAPIの**［Allow Skipping User Consent（ユーザー同意のスキップの許可）］**オプションが有効になっている場合にのみ可能です。



サードパーティアプリケーションは信頼できないものとみなされるため、同意ダイアログをスキップできません。

ユーザーが、一度同意したものの、それを取り消したい場合は：

## 同意を取り消す

[リソース所有者のパスワードフロー](/login/flows/resource-owner-password-flow)を使うときは、同意ダイアログは使用されません。ユーザーが直接アプリケーションにパスワードを入力し、これがアプリケーションに対してユーザーアカウントへのフルアクセスを付与したことと同じになるためです。

1. [［Auth0 Dashboard］>［User Management（ユーザー管理］>［Users（ユーザー）］](%24%7Bmanage_url%7D/#/users)に移動し、同意を取り消すユーザーをクリックします。
2. **［Authorized Application（認可アプリケーション）］**タブをクリックします。
3. 該当するアプリケーションの横にある**［Revoke（取り消し）］**をクリックします。

## パスワードベースのフロー

`/authorize`エンドポイントにリダイレクトするときに`prompt=consent`パラメーターを含めることで、ユーザーに対して同意を強制できます。これは、ユーザーにアプリケーションと要求されたスコープに対するユーザー付与がすでにある場合でも同じです。

## ユーザーに同意を強制する

同意ダイアログのUIは、カスタマイズすることも、カスタムドメインに設定することもできません。