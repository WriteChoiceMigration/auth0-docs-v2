---
og:description: Describes Auth0 features affected by the Node.js v8 to Node.js v12
  migration and provides recommendations for migration.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: Node.js 8からNode.js 12への移行
og:url: https://auth0.com/docs/
permalink: migrate-to-nodejs-12
title: Node.js 8からNode.js 12への移行
twitter:description: Describes Auth0 features affected by the Node.js v8 to Node.js
  v12 migration and provides recommendations for migration.
twitter:title: Node.js 8からNode.js 12への移行
---

As of December 31, 2019, [Node.js v8 went out of long-term support (LTS)](https://github.com/nodejs/Release#release-schedule), which means that the Node.js development team no longer back-ports critical security fixes to this version. This could potentially expose your extensibility code to security vulnerabilities. Therefore, Auth0 migrated from Node 8 to Node 12.

## 次のAuth0機能がノード8を使用します。

ルール

* フック
* カスタムデータベース接続とスクリプト
* カスタムソーシャル接続
* 拡張機能
* Auth0では、まず開発テナントをNode 12ランタイムに切り替え、開発テナントでテストを完了し、開発中に問題が見られない場合にのみ、運用環境のテナントを移行してください。

タスク

## WebtaskランタイムにNode 12を導入するプロセスの一環として、Node 8から12への上位互換性がないモジュールを特定するために、いくつかのテストを実行しました。ほとんどの場合、Node 12にアップグレードできるはずです。

とはいえ、移行前に、以下のすべてをテストすることを強くお勧めします。

ルール

* フック
* カスタムデータベース接続とスクリプト
* カスタムソーシャル接続
* 拡張機能
* Auth0では、まず開発テナントをNode 12ランタイムに切り替え、開発テナントでテストを完了し、開発中に問題が見られない場合にのみ、運用環境のテナントを移行してください。

ルール、フック、カスタムデータベーススクリプト、カスタムソーシャル接続について、[Management API](/api)をクエリできます。これにより、テスト目的で運用テナントから開発テナントにアイテムを移動しやすくなります。

### この移行の結果として追加の動作変更が発生する可能性があるため、移行スイッチを用意して、 Node 12を使用して、環境を新しいWebtaskランタイムに移行します。

Auth0では、まず開発テナントをNode 12ランタイムに切り替え、開発テナントでテストを完了し、開発中に問題が見られない場合にのみ、運用環境のテナントを移行してください。

ルール、フック、カスタムデータベーススクリプト、カスタムソーシャル接続について、[Management API](/api)をクエリできます。これにより、テスト目的で運用テナントから開発テナントにアイテムを移動しやすくなります。

You can query the [Management API](/docs/api) for your rules, hooks, custom database scripts, and custom social connections. This will make it easier for you to move items from your production tenant to development tenant for testing purposes.

When using the Connections endpoints in the <Tooltip tip="Management API: A product to allow customers to perform administrative tasks." cta="View Glossary" href="/docs/glossary?term=Management+API">Management API</Tooltip>, custom database scripts can be retrieved or updated using `options.customScripts`. Similarly, you can find custom social connections in `options.scripts.fetchUserProfile`.

1. Enable Node 12 on your development tenant using the new **Extensibility** panel on the [Advanced Tenant Settings](https://manage.auth0.com/#/tenant/advanced) page of the Dashboard. Choose **Node 12** from the **Runtime** drop-down.
2. Click **Save**.
3. If you use the items listed below, complete the migration steps for each of them.
4. Test your configuration.
5. Once you are sure that nothing has broken, use steps 1 and 2 above to enable Node 12 on your production tenant.

### 委任管理拡張機能とシングル サインオン（SSO）ダッシュボード拡張機能では、拡張機能とカスタムWebタスクへのアクセスに使用するURLを許可リストに登録する必要があります。Node 12にアップグレードすると、拡張機能とカスタムWebタスクへのアクセスに使用するURLが変更されます。これは、これらの拡張機能にとって重大な変更です。

The Delegated Administration Extension and the <Tooltip tip="Single Sign-On (SSO): Service that, after a user logs into one applicaton, automatically logs that user in to other applications." cta="View Glossary" href="/docs/glossary?term=Single+Sign-on">Single Sign-on</Tooltip> (SSO) Dashboard Extension require allowlisting the URLs used to access extensions and custom webtasks. When you upgrade to Node 12, the URLs you use to access extensions and custom webtasks will change. This is a breaking change for these extensions.

URLのリージョン部分は8から12に変更されます。URLを使用して拡張機能にアクセスする際:

Node12にアップグレードする際、URLは:

`https://{yourTenant}.us8.webtask.io/dummy-extension-url`

認可拡張機能ルールの再発行

`https://{yourTenant}.us12.webtask.io/dummy-extension-url`

1. Go to [Dashboard > Applications > Applications > Settings](https://manage.auth0.com/#/applications/{yourClientId}/settings), and add the URL to the fields **Allowed Callback URLs** and **Allowed Logout URLs**.
2. The execution URLs will also change for custom webtasks in your Auth0 container. You must update any external applications that call those webtasks.

### 認可拡張機能を使用すると、`auth0-authorization-extension`ルールが生成されます。認可拡張機能内からこのルールを再発行して、URLを自動的に更新します。

委任管理URLを構成する

1. Ensure you have upgraded to the latest version of the Authorization Extension from the **Installed Extensions** tab. If the **Upgrade** button is present, click to upgrade. If the button is not present, you are already on the latest version of the extension.
2. Open the **Authorization Extension** configuration page.
3. To update the URL in the rule, publish the rule again by clicking the **Publish Rule** button.
4. Test to make sure everything is still working. If you see an Invalid API Key error after updating, click the **Rotate** button to generate a new API key.

### 委任管理拡張機能を使用する場合、次のマトリックスには、Node 12に移行した後に構成する必要がある更新されたURLが含まれています。URLは場所によって異なります。

たとえば、米国にいて委任管理を使用している場合は、アプリケーションの設定で次のフィールドを更新する必要があります。

<table class="table"><thead>
<tr>
<th>Location</th>
<th>Allowed Callback URL for Node 12</th>
<th>Allowed Logout URL for Node 12</th>
</tr>
</thead>
<tbody>
<tr>
<td>US-1</td>
<td>`https://{yourTenant}.us12.webtask.io/auth0-delegated-admin/login`</td>
<td>`https://{yourTenant}.us12.webtask.io/auth0-delegated-admin`</td>
</tr>
<tr>
<td>US-3</td>
<td>`https://{yourTenant}.us.webtask.run/auth0-delegated-admin/login`</td>
<td>`https://{yourTenant}.us.webtask.run/auth0-delegated-admin`</td>
</tr>
<tr>
<td>EU</td>
<td>`https://{yourTenant}.eu12.webtask.io/auth0-delegated-admin/login`</td>
<td>`https://{yourTenant}.eu12.webtask.io/auth0-delegated-admin`</td>
</tr>
<tr>
<td>AU</td>
<td>`https://{yourTenant}.au12.webtask.io/auth0-delegated-admin/login`</td>
<td>`https://{yourTenant}.au12.webtask.io/auth0-delegated-admin`</td>
</tr>
<tr>
<td>JP-1</td>
<td>`https://{yourTenant}.jp.webtask.run/auth0-delegated-admin/login`</td>
<td>`https://{yourTenant}.jp.webtask.run/auth0-delegated-admin`</td>
</tr>
</tbody>
</table>

**Allowed Callback URL（許可されているコールバックURL）**：`

* **Allowed Callback URLs**: `https://{yourTenant}.us12.webtask.io/auth0-delegated-admin/login`
* **Allowed Logout URLs**: `https://{yourTenant}.us12.webtask.io/auth0-delegated-admin`

### 次のマトリックスには、Node 12に移行した後に構成する必要がある更新されたURLが含まれています。URLは場所によって異なります。

管理者のログインURL:

ユーザーのログインURL:

<table class="table"><thead>
<tr>
<th>Location</th>
<th>Allowed Callback URL</th>
</tr>
</thead>
<tbody>
<tr>
<td>US-1</td>
<td>`https://{yourTenant}.us12.webtask.io/auth0-sso-dashboard/admins/login`</td>
</tr>
<tr>
<td>US-3</td>
<td>`https://{yourTenant}.us.webtask.run/auth0-sso-dashboard/admins/login`</td>
</tr>
<tr>
<td>Europe</td>
<td>`https://{yourTenant}.eu12.webtask.io/auth0-sso-dashboard/admins/login`</td>
</tr>
<tr>
<td>Australia</td>
<td>`https://{yourTenant}.au12.webtask.io/auth0-sso-dashboard/admins/login`</td>
</tr>
<tr>
<td>Japan</td>
<td>`https://{yourTenant}.jp.webtask.run/auth0-sso-dashboard/admins/login`</td>
</tr>
</tbody>
</table>

拡張機能の更新

<table class="table"><thead>
<tr>
<th>Location</th>
<th>Allowed Callback URL</th>
</tr>
</thead>
<tbody>
<tr>
<td>US-1</td>
<td>`https://{yourTenant}.us12.webtask.io/auth0-sso-dashboard/login`</td>
</tr>
<tr>
<td>US-3</td>
<td>`https://{yourTenant}.us.webtask.run/auth0-sso-dashboard/login`</td>
</tr>
<tr>
<td>Europe</td>
<td>`https://{yourTenant}.eu12.webtask.io/auth0-sso-dashboard/login`</td>
</tr>
<tr>
<td>Australia</td>
<td>`https://{yourTenant}.au12.webtask.io/auth0-sso-dashboard/login`</td>
</tr>
<tr>
<td>Japan</td>
<td>`https://{yourTenant}.jp.webtask.run/auth0-sso-dashboard/login`</td>
</tr>
</tbody>
</table>

### ほとんどの拡張機能は、認証に`PUBLIC_WT_URL`の非表示シークレットを使用します。このシークレットはランタイムバージョンに依存し、自動的に更新されません。

更新するには、拡張機能の設定を保存する必要があります（変更は必要ありません）。これを行うには、ランタイムを`Node 12`に切り替えた後、拡張機能ダッシュボード（歯車アイコン）で拡張機能の設定を開き、`［Save（保存）］`をクリックする必要があります。その後、拡張機能ギャラリーは、選択したランタイムに基づいて`PUBLIC_WT_URL`シークレットを更新します。

固定モジュールの更新

次の組み込みモジュール（つまり、明示的に要求しなかったモジュール）を使用している場合は、一部のバージョンがNode 12で動作するように更新されていることに注意してください。次の表は、変更内容をまとめたものです。これらの新しいバージョンでは、以前のバージョンとの下位互換性を維持する必要があります。

<Frame>![Misconfiguration or Service Outage Error](/images/cdy7uua7fh8z/4mq5ebCa83XNLlbn28pp9s/beb869df9a11d188f30332030655ac9d/node-hidden-secret-error.png)</Frame>

### モジュールを手動で固定している場合は、コードをNode 12で実行できるように手動で更新する必要がある場合があります。

たとえば、次のように変更する必要があります。

<table class="table"><thead>
<tr>
<th>Module name</th>
<th>Old version</th>
<th>New version</th>
</tr>
</thead>
<tbody>
<tr>
<td>couchbase</td>
<td>~2.5.1</td>
<td>2.6.10</td>
</tr>
<tr>
<td>bcrypt</td>
<td>1.0.3</td>
<td>3.0.8</td>
</tr>
</tbody>
</table>

または、モジュールを特定のバージョンに固定する必要がある場合:

For example, you must change:

`var bcrypt = require(‘bcrypt@1.0.3’);`

to

`var bcrypt = require(‘bcrypt’);`

or, if the module must be pinned to a specific version:

`var bcrypt = require(‘bcrypt@3.0.8’);`