---
og:description: After December 1, 2021, logout behavior will change to always redirect
  users to the URI passed to the Auth0 logout APIs instead of using the returnTo query
  parameter passed by Identity Providers to the  /login/callback during the execution
  of the logout.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: ログアウトリダイレクトの移行ガイド
og:url: https://auth0.com/docs/
permalink: logout-return-to
title: ログアウトリダイレクトの移行ガイド
twitter:description: After December 1, 2021, logout behavior will change to always
  redirect users to the URI passed to the Auth0 logout APIs instead of using the returnTo
  query parameter passed by Identity Providers to the  /login/callback during the
  execution of the logout.
twitter:title: ログアウトリダイレクトの移行ガイド
---

On **01 December 2021**, the logout behavior will change to always redirect users to the URI passed to the Auth0 logout APIs instead of using the `returnTo` query parameter passed by <Tooltip tip="Identity Provider (IdP): Service that stores and manages digital identities." cta="View Glossary" href="/docs/glossary?term=Identity+Providers">Identity Providers</Tooltip> to the `/login/callback` during the execution of the logout. The URI used will depend on the API called to request the session logout:

* `https://{yourDomain}/logout`: Auth0 will use the `returnTo` parameter
* `https://{yourDomain}/v2/logout?federated`: Auth0 will use the `returnTo` parameter
* `https://{yourDomain}/wsfed/{yourClientId}?wa=wsignout1.0`: the `wreply` parameter

これらいずれかのAPIへの以前の呼び出し記録がAuth0にない場合、ログアウトは完了しますが、リダイレクトは起こらず、エンドユーザーにはエラーページが表示されます。

### 影響を受けるエンドポイント

以下のエンドポイントはこの変更の影響を受けます。

* `https://{yourDomain}/v2/logout` when using the `federated` query parameter to l[og users out of Identity Providers](/docs/authenticate/login/logout/log-users-out-of-idps)
* `https://{yourDomain}/wsfed/{yourClientId}?wa=wsignout1.0` when using the `wreply` query to [log out of Auth0 using the WS-Fed Protocol](/docs/authenticate/protocols/ws-fed-protocol)
* `https://{yourDomain}/login/callback` when using the `returnTo` query parameter.

以下の使用パターンに依存しているテナントは、**2021年12月1日**以降、希望のリダイレクトURIにリダイレクトできなくなります。

1. Applications that call `/login/callback?returnTo` without a preceding call to `/v2/logout or /wsfed/{yourClient}?wa=wsignout1.0` to specify the Logout URL.
2. Identity Providers that call `/login/callback?returnTo` with a value in `returnTo` that is different to the value originally provided in a preceding call to `/v2/logout` or `/wsfed/{yourClientId}`.
3. Applications that make concurrent calls to one of the affected APIs while providing different redirection URIs in the different calls.
4. Applications or users that make calls to the `/authorize` API concurrently or interleaved with calls to one of the affected APIs regardless of whether there was a preceding call to `/v2/logout` or `/wsfed/{yourClientId}?wa=wsignout1.0`.

### アクション

1. Go to [Auth0 Dashboard > Monitoring > Logs](https://manage.auth0.com/#/logs), and search for `type:depnote AND description:*unvalidated*redirects*` to find applications that rely on the deprecated behavior.
2. For each affected application, ensure that:

   1. the application or Relying Party initiates the logout using one of Auth0’s public APIs: [Authentication API: Logout](https://auth0.com/docs/api/authentication#logout) or [Authentication API: WS-Federation](https://auth0.com/docs/api/authentication#ws-federation).
   2. the application does not rely on Identity Providers modifying the Logout URL that is passed back to `/login/callback?returnTo` as these modifications will no longer be honored.
   3. the application does not make concurrent calls to logout APIs using different Logout URLs. Auth0 will store only a single Logout URL for a user agent at any one time, which means that concurrent logout processes will fail to redirect.
   4. the application does not make calls to `/authorize` concurrently or interleaved with calls to the logout APIs. Completing a login transaction will clear the stored Logout URL for a user agent, which means that concurrent logout processes will fail to redirect.
   5. the application and users do not interleave calls to `/authorize` with calls to one of the affected APIs.

移行アクションが完了してテストし終わったら、移行を確認する必要があります。

### 移行を確認する

アプリケーションを移行して、廃止された使用パターンに依存していないことを確認したら、**2021年12月1日**までの任意のタイミングで廃止された動作を無効化し、変更を確認します。

1. Go to [Auth0 Dashboard > Tenant Settings > Advanced](https://manage.auth0.com/#/tenant/advanced), and locate the **Migrations** section.
2. Disable the **Unvalidated redirects from /login/callback** switch. Turning off this switch disables the deprecated behavior for your tenant, preventing it from being used.

このスイッチを無効にした後で、ログアウトURLへのリダイレクトが期待どおりに動作しない場合には、アプリケーションが廃止された動作にまだ依存していることを示しています。

移行が運用環境で正常に動作し、確認できた場合には、このスイッチをオフにしたままにできます。これで、廃止された機能は今後使用されなくなります。**2021年12月1日**付で、Auth0は廃止された動作とそれに関連するスイッチを完全に削除します。