---
og:description: Learn how to log user out with the OIDC Logout Endpoint.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: OIDCエンドポイントを使用してユーザーをAuth0からログアウトさせる
og:url: https://auth0.com/docs/
permalink: log-users-out-of-auth0
title: OIDCエンドポイントを使用してユーザーをAuth0からログアウトさせる
twitter:description: Learn how to log user out with the OIDC Logout Endpoint.
twitter:title: OIDCエンドポイントを使用してユーザーをAuth0からログアウトさせる
---

Auth0では、エンドユーザーのログアウトにOpenID Connectの[RP-Initiated Logout 1.0](https://openid.net/specs/openid-connect-rpinitiated-1_0.html)を実装しています。この仕様は、OpenID Connectによる[最終仕様](https://openid.net/developers/specs/)の一部です。

## 仕組み

RP起点のログアウトは、証明書利用者（ユーザー）がOpenIDプロバイダー（Auth0）にログアウトを要求するシナリオです。

1. ユーザーはアプリケーションでログアウト要求を開始します。
2. アプリケーションはユーザーをAuth0のAuthentication APIの[OIDCログアウト](/docs/api/authentication#oidc-logout)エンドポイントに送ります。
3. Auth0は、提供された[OIDCログアウトエンドポイントのパラメーター](#oidc-logout-endpoint-parameters)を基に、ユーザーを適切な場所にリダイレクトします。

## RP起点のログアウトを構成する

RP起点のログアウトを構成するには、アプリケーションがAuth0テナントの[検出メタデータドキュメント](https://openid.net/specs/openid-connect-discovery-1_0.html#ProviderConfig)内で`end_session_endpoint`パラメーターを見つけられること、そして必要なパラメーターを使ってOIDCログアウトエンドポイントを呼び出すことを確認する必要があります。

### エンドポイント検出を有効にする



**RP-Initiated Logout End Session Endpoint Discovery（RP起点のログアウトのセッション終了エンドポイント検出）**は、Auth0 DashboardまたはAuth0 Management APIを使用して有効にすることができます。



### OIDCログアウトエンドポイントを呼び出す



OIDCログアウトエンドポイントを呼び出す際に、Auth0では`id_token_hint`パラメーターの提供を推奨しています。

使用しているアプリケーションがIDトークンを安全に保管できない場合は、代わりに`logout_hint`と`client_id`パラメーターを提供することができます。



#### OIDCログアウトエンドポイントのパラメーター

Authentication APIの[OIDCログアウト](/docs/api/authentication#oidc-logout)エンドポイントは、以下のパラメーターに対応しています。



#### id_token_hintパラメーター



`id_token_hint`パラメーターの値は、ユーザーの認証後にAuth0がユーザーに対して発行したIDトークンでなければなりません。

このIDトークンには、登録クレームの発行者（`iss`）、オーディエンス（`aud`）、Auth0セッションID（`sid`）が検証のために含まれています。IDトークンのクレームについては、「[IDトークンの構造](/security/tokens/id-tokens/id-token-structure)」をお読みください。

##### 例



#### logout_hintパラメーター

`logout_hint`パラメーターの値は、ユーザーの現在のAuth0セッションのセッションID（`sid`）でなければなりません。

このセッションID（`sid`）は登録クレームとして提供され、ユーザーの認証後にAuth0がユーザーに対して発行したIDトークンに含まれています。



##### 例



#### post_logout_redirect_uriパラメーター

`post_logout_redirect_uri`パラメーターの値は、エンコードされた有効なURLとして、以下で**Allowed Logout URLs（許可されているログアウトURL）**リストに登録されていなければなりません。

1. [アプリケーションの設定](/docs/get-started/applications/application-settings#application-uris)：`id_token_hint`パラメーター、または`logout_hint`パラメーターと`client_id`パラメーターを提供した場合
2. [テナントの設定](/docs/get-started/tenant-settings#login-and-logout)：`logout_hint`パラメーターのみを提供した場合。

##### 例



##### アプリケーションのAllowed Logout URLs（許可されているログアウトURL）を更新する

URLをアプリケーションの**Allowed Logout URLs（許可されているログアウトURL）**リストに登録するには、Auth0 DashboardまたはAuth0 Management APIを使用することができます。



##### テナントのAllowed Logout URLs（許可されているログアウトURL）を更新する

URLをテナントの**Allowed Logout URLs（許可されているログアウト）**リストに登録するには、Auth0 DashboardまたはAuth0 Management APIを使用することができます。



##### Allowed Logout URLs（許可されているログアウトURL）のガイドライン

**Allowed Logout URLs（許可されているログアウト）**の更新では、検証エラーを避けるために以下のガイドラインに従ってください。

* 複数のURL値はカンマ（`,`）で区切ります。
* URLのスキーム部分を含めます（例：`https://`）。

サブドメインにはアスタリスク（`*`）をワイルドカードとして使用（例：`https://*.example.com`）できますが、運用環境ではワイルドカードの使用はお勧めしません。詳細については、「[サブドメインURLのプレースホルダー](/docs/get-started/applications/wildcards-for-subdomains#wildcard-url-placeholders)」をお読みください。

##### post_logout_redirect_uriにクエリ文字列パラメーターを追加する

OIDCログアウトエンドポイントは、`post_logout_redirect_uri`パラメーターに提供されたURLのクエリ文字列パラメーターを解析します。

これらのクエリ文字列パラメーターは、**Allowed Logout URLs（許可されているログアウトURL）**に含める必要があります。含まれていない場合には、ログアウト要求が拒否される可能性があります。

たとえば、`https://example.com/logout?myParam=1234`を`post_logout_redirect_uri`パラメーター（`https%3A%2F%2Fexample.com%2Flogout%3FmyParam%3D1234`としてエンコード）に渡す場合は、`https://example.com/logout?myParam`を**Allowed Logout URLs（許可されているログアウトURL）**に含める必要があります。

#### ui_localesパラメーター

`ui_locales`パラメーターの値は、[対応ロケール](/docs/customize/internationalization-and-localization/universal-login-internationalization#new-universal-login-experience-localization)がスペースで区切られてリストされていなければなりません。

リストにある最初の値は、[テナントのデフォルト言語設定](/docs/get-started/tenant-settings#languages)と一致しなければなりません。

#### federatedパラメーター

`federated`パラメーターは値を必要としません。

OIDCログアウトエンドポイントの呼び出しにfederatedパラメーターを含めた場合、Auth0はそれらの[IDプロバイダーからユーザーをログアウト](/logout/log-users-out-of-idps)させようとします。

## ログアウト同意プロンプト

OIDC仕様では、エンドユーザーがログアウト要求を行ったということを、OpenIDプロバイダーが確認できない場合には、ログアウトフローがユーザーの同意を求めるために中断されると定義されています。

Auth0では、以下のいずれかの条件を検出した場合に、ログアウト同意プロンプトを表示することでこの動作を強制します。

* `id_token_hint`パラメーターと`logout_hint`パラメーターがどちらも提供されていない
* IDトークンの`sid`クレームが要求にあるブラウザーセッションに対応していない
* `logout_hint`パラメーターの値が現在のセッションデータと一致していない

ユーザーがログアウト要求を確認すると、Auth0はログアウトフローを続行します。

### ログアウトの同意プロンプトを無効にする

ログアウトの同意プロンプトは無効にすることができます。無効にすると、Auth0は異常な動作を検出しようとしないで、ログアウト要求を自動的に受け入れます。

Dashboardを使ってログアウトの同意プロンプトを無効にするには、以下を行います。

1. [［Dashboard］>［設定］>［Advanced（詳細設定）］](%24%7Bmanage_url%7D/#/tenant/advanced)に移動します。
2. **［Show RP-Initiated Logout End-User Confirmation（RP起点のログアウトにエンドユーザー確認を表示する）］**を無効にします。