---
og:description: Learn how to add native login functionality to your native app with
  Apple.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: AppleでサインインをネイティブiOSアプリに追加する
og:url: https://auth0.com/docs/
permalink: apple-native
title: AppleでサインインをネイティブiOSアプリに追加する
twitter:description: Learn how to add native login functionality to your native app
  with Apple.
twitter:title: AppleでサインインをネイティブiOSアプリに追加する
---

You can add functionality to your native iOS application to allow your users to authenticate using Sign In with Apple. For more implementation details, you can try the Auth0 [iOS Swift - Sign In with Apple Quickstart](/docs/quickstart/native/ios-swift).

## 仕組み

ネイティブアプリの場合、「Appleでサインイン」ログインフローは次のように機能します。

<Frame>![Diagram of the Sign In with Apple Authentication Flow](/images/cdy7uua7fh8z/I7xtPQoqoAFiHQiT2p7p5/8646a5231491dfbe64bd6a825ccc8ce7/apple-siwa-authn-flow.png)</Frame>

* **ステップ1と2**：ユーザーはiOSデバイス上のAppleのSDKを介して認証し、応答で認可コードを受け取ります。ユーザーはアプリを離れてブラウザを使用してログインする必要はありません。

  <Warning>

  Avoid using a nonce. It will cause the request to Apple to fail in step 4 and Auth0 will return a 400 error to the user: "Error from Apple connection."

  </Warning>
* **ステップ3**：アプリケーションはAuth0 の`/oauth/token`エンドポイントを呼び出して、Apple認可コードをAuth0トークンと交換します。
* **Step 4 & 5**: The Auth0 platform exchanges the Authorization code with Apple for tokens. Auth0 validates the tokens, and uses the claims in the tokens to construct the identity of the user.
* **Step 6**: Auth0 saves the user profile, executes rules and authorization, then issues Auth0 <Tooltip tip="Access Token: Authorization credential, in the form of an opaque string or JWT, used to access an API." cta="View Glossary" href="/docs/glossary?term=access+tokens">access tokens</Tooltip> (<Tooltip tip="Refresh Token: Token used to obtain a renewed Access Token without forcing users to log in again." cta="View Glossary" href="/docs/glossary?term=refresh+tokens">refresh tokens</Tooltip> and <Tooltip tip="Refresh Token: Token used to obtain a renewed Access Token without forcing users to log in again." cta="View Glossary" href="/docs/glossary?term=ID+tokens">ID tokens</Tooltip>) as requested. These tokens are used to protect your APIs and users managed by Auth0.

## 前提条件

Auth0でネイティブアプリに「Appleでサインイン」を構成する前に、次の操作を行ってください。

* Have an [Apple Developer](https://developer.apple.com/programs/) account, which is a paid account with Apple. (There is no free trial available unless you are part of their [iOS Developer University Program](https://developer.apple.com/support/compare-memberships/).)
* [Register Your App in the Apple Developer Portal](https://marketplace.auth0.com/integrations/apple-social-connection) if you have not already done so. Make a note of the following IDs and key for the application connection settings in the <Tooltip tip="Auth0 Dashboard: Auth0's main product to configure your services." cta="View Glossary" href="/docs/glossary?term=Auth0+Dashboard">Auth0 Dashboard</Tooltip>:

  + App ID（アプリID）
  + Apple Team ID
  + クライアントシークレット署名鍵
  + キーID
* If you are using the Classic Login flow or embedding `Lock.js` in your application, make sure you are using `Lock.js` version 11.16 or later.

## Auth0で接続を構成して有効にする

Apple Developerアカウントから必要な資格情報を取得したら、Auth0でアプリケーションクライアントと接続設定を構成する必要があります。

1. Navigate to [Auth0 Dashboard > Applications > Applications](https://manage.auth0.com/#/applications), choose your application, and select the gear icon to view the settings page.
2. At the bottom of the page, select **Show Advanced Settings** and then the **Device Settings** view. Under **Native Social Login**, enable the **Enable Sign In with Apple** toggle.

   <Frame>![Application Client Settings: Advanced Device Settings](/images/cdy7uua7fh8z/2xkQ13r9yCb4GBZdeczZjJ/5bc57b22a0bad292bc9ad28b4884b2b6/Native_App_-_Device_Settings_-_English.png)</Frame>
3. Under **iOS**, fill in the **App ID** field with the native app's App ID/Bundle Identifier.
4. Navigate to [Auth0 Dashboard > Authentication > Social](https://manage.auth0.com/#/connections/social), and select **Create Connection**.
5. Select the **Apple** connection and consent.
6. On the **Settings** tab, fill in the following fields:

   * **［Apple Team ID（AppleチームID）］**
   * **クライアントシークレット署名鍵**
   * **キーID**

     <Frame>![Apple Social Connection Settings](/images/cdy7uua7fh8z/3mTTVYnrwbVYnUx5Mzy0V9/0ab8174a812908c9290663d3d9d05286/dashboard-connections-social-create_enter-details_apple.png)</Frame>
7. Select the **Applications** view to enable this connection for your application.
8. Click **Save**.

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

Native apps cannot be tested from the browser. This means that the **Try Connection** button on the Apple connection is used exclusively for testing web-based flows.

</Callout>

## ログアウト

ネイティブiOSログイン実装では標準のブラウザベースのフローが使用されないため、アプリケーション所有者はログアウトを適切に実行するように注意する必要があります。アプリケーションがログアウトを実行する必要がある場合、次のアクションを実行してください。

* [Revoke the Auth0 Refresh Token](https://auth0.com/docs/api/authentication#revoke-refresh-token)
* iCloudキーチェーンに保存されているAuth0リフレッシュトークンを削除する
* iCloudキーチェーンに保存されているAppleユーザー識別子を削除します。
  Also, keep in mind that logout can result from user actions (for example, clicking a "log out" button) or from a user revoking access to the given app. The latter will be indicated through the native [ASAuthorizationAppleIDProvider.getCredentialState](https://developer.apple.com/documentation/authenticationservices/asauthorizationappleidprovider/3175423-getcredentialstate) method.

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

One nuance of Apple's IdP is that it only returns requested scopes (such as email, first name, and last name) in the ID token on the **first** response. More destructive approaches to logout (such as deleting the user) could result in loss of profile information, which would require end users to deauthorize and reauthorize an app.

</Callout>

## Learn more

* [Rate Limit Policy](/docs/troubleshoot/customer-support/operational-policies/rate-limit-policy)