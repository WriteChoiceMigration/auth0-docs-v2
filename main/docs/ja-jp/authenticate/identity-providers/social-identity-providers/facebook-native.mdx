---
og:description: Learn how to add login functionality to your native app with Facebook.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: Facebookログインをネイティブアプリに追加する
og:url: https://auth0.com/docs/
permalink: facebook-native
title: Facebookログインをネイティブアプリに追加する
twitter:description: Learn how to add login functionality to your native app with
  Facebook.
twitter:title: Facebookログインをネイティブアプリに追加する
---

You can add functionality to your native application to allow your users to authenticate using Facebook natively, within the application. This does not require redirection via a web browser and will let mobile applications comply with the [Facebook Developer Policy](https://developers.facebook.com/policy/), which requires that mobile applications use the Facebook SDK for [Android](https://developers.facebook.com/docs/android) or [iOS](https://developers.facebook.com/docs/ios) to authenticate.

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

When integrating with the Facebook SDKs, your applications will be sharing data with Facebook. Make sure you understand the data that is being shared and that you reflect it properly in your application's privacy policy. Auth0 has no control over what data will be shared with Facebook via the SDK.

Check the [Facebook GDPR](https://www.facebook.com/business/m/one-sheeters/gdpr-developer-faqs) page for more information about data collected by the Facebook SDK and Facebook Login.

</Callout>

## 仕組み

ネイティブ Facebook ログインフローは次のように機能します：

* **Step 1**: The application authenticates a user via the Facebook SDK and acquires an <Tooltip tip="Access Token: Authorization credential, in the form of an opaque string or JWT, used to access an API." cta="View Glossary" href="/docs/glossary?term=Access+Token">Access Token</Tooltip>.
* **Step 2**: The application uses that Access Token to request a special [Facebook Session Info Access Token](https://developers.facebook.com/docs/facebook-login/access-tokens/session-info-access-token).
* **ステップ 3**：Facebook SDKを使用してユーザーのプロファイルを取得します。
* **ステップ 4**：その後、アプリケーションはFacebookセッション情報トークンを使用して Auth0で認証できます。

## 前提条件

Auth0経由でネイティブアプリのFacebook ネイティブログインを構成する前に、次の操作を行う必要があります：

1. [Set up Facebook as an Auth0 connection](https://marketplace.auth0.com/integrations/facebook-social-connection)
2. [Use the relevant Facebook SDK in your application](https://developers.facebook.com/docs/apis-and-sdks/)
3. Navigate to [Auth0 Dashboard > Applications > Applications](https://manage.auth0.com/#/applications), and create an application with Auth0 (if you have not already).
4. At the bottom of the settings page, select **Show Advanced Settings** and then the **Device Settings** view. Under **Native Social Login**, enable the **Enable Sign In with Facebook** toggle.

   <Frame>![Native Social Login Settings](/images/cdy7uua7fh8z/5p2RaaeAtZyJzcoCfkF4tW/7326854f031e9c0a70f6b19de9cf9030/Native_Social_Login_-_English.png)</Frame>

## 実装

ネイティブFacebookログインを使用してユーザープロファイルを認証するプロセスは、アプリケーションの観点から見ると4つのステップで構成されます。

### ステップ1

アプリケーションはFacebook SDKを介してユーザーを認証します。Facebookからアクセストークンを取得します。

## ステップ2

The application uses the Access Token to request a [Facebook Session Info Access Token](https://developers.facebook.com/docs/facebook-login/access-tokens/session-info-access-token).

この要求は次のようになります：

```json wrap lines
GET https://graph.facebook.com/v5.0/oauth/access_token?grant_type=fb_attenuate_token&client_id=457704041391802&fb_exchange_token=<facebook_access_token>
```






応答は次のようになります：

```json lines
{
    "access_token": "XAAGgR4b...1lHWNCpqrAhcpoAZDZD",
    "token_type": "bearer",
    "expires_in": 5183924
}
```






### ステップ3

アプリケーションは、Facebook SDK を使用してFacebookからユーザープロファイルを取得する必要があります。これは次のような要求で終わります：

```json wrap lines
GET https://graph.facebook.com/v5.0/<facebook user id>?access_token=<facebook access token>&fields=email,name
```






### ステップ4

その後、アプリケーションは、`facebook-session-access-token`トークンタイプでトークン交換フローを使用して Auth0の`/oauth/token`エンドポイントを呼び出すことにより、セッション情報アクセストークンと Facebookユーザープロファイルを使用してAuth0で認証できます。すべてがうまくいけば、Auth0はユーザープロファイルを追加した通常の応答をExchangeから返します。ユーザープロファイルは、文字列としてエンコードされたJSONオブジェクトである必要があります。

{/* codeblockOld.header.login.logInButton codeblockOld.header.login.configureSnippet */}


```json lines
POST https://{yourDomain}/oauth/token

grant_type: 'urn:ietf:params:oauth:grant-type:token-exchange'
subject_token_type: 'http://auth0.com/oauth/token-type/facebook-info-session-access-token'
audience: 'your-api'
scope: 'read:appointments openid profile email email_verified'
subject_token: 'XAAGgR4b...1lHWNCpqrUHZAEtUuZAhcpoAZDZD'
client_id: '{yourClientId}'
user_profile: '{"email":"john@example.com", "name":"John Doe"}'
```






Auth0からの応答は以下のとおりです：

```json lines
{
    "access_token": "eyJ0eXA..yXQaPLVXg",
    "id_token": "eyJ0.tFE5HPipdOsA",
    "scope": "openid profile email read:appointments",
    "expires_in": 86400,
    "token_type": "Bearer"
}
```






## ユーザープロフィールとメールの検証

In the previous example, you had to retrieve the User Profile from Facebook and include it in the call to `/oauth/token`. This is because the Facebook Session Access Token cannot be used to directly retrieve the profile, and the Facebook Access Token cannot be sent directly to the server, due to [Apple's AppStore Review Guidelines](https://developer.apple.com/app-store/review/guidelines). Therefore, it must be retrieved in the client and sent to Auth0 in this fashion.

Auth0は、ユーザープロファイルがFacebookによって返されたものと同じであることを保証できないため、`email_verified`フィールドを`false`に設定します。

## ログアウト

Since the native login implementation does not make use of standard browser-based flows, application owners must also take care to perform logout appropriately. When an application needs to perform a logout, it should also [Revoke the Auth0 Refresh Token](https://auth0.com/docs/api/authentication#revoke-refresh-token).

## 続きもお読みください

* [Native Facebook Login with iOS Swift](/docs/quickstart/native/ios-swift)
* [Native Facebook Login with Android](/docs/quickstart/native/android-facebook-login)
* [Rate Limits on Native Social Logins](/docs/troubleshoot/customer-support/operational-policies/rate-limit-policy)