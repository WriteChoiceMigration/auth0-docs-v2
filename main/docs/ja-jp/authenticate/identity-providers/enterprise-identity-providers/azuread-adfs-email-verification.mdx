---
og:description: Describes how to control how the `email_verified` field is set for
  Azure AD and ADFS.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: Microsoft Entra IDとADFSのメール検証
og:url: https://auth0.com/docs/
permalink: azuread-adfs-email-verification
title: Microsoft Entra IDとADFSのメール検証
twitter:description: Describes how to control how the `email_verified` field is set
  for Azure AD and ADFS.
twitter:title: Microsoft Entra IDとADFSのメール検証
---

Auth0 user's profile has an `email_verified` field, which can be set in different ways depending on the connection type. For database connections, users must go through an email validation flow to get the email verified. For federated connections, <Tooltip tip="Identity Provider (IdP): Service that stores and manages digital identities." cta="View Glossary" href="/docs/glossary?term=identity+providers">identity providers</Tooltip> can return the `email_verified` field based on their own criteria.

Azure ADとADFSは、返されるメールが検証済みであることを保証できません。

* ADFSでは、ADFS管理者は任意のメールを設定できます。
* Azure ADでは、Azure ADテナントの構成方法に応じて、Azure ADによって返されるメール アドレスがOfficeメールボックスに対応する場合と対応しない場合があります。Auth0は、それが実行されるかどうかを知ることができません。

ただし、Azure ADまたはADFSがどのように構成および管理されているかがわかっている場合は、それらのアカウントからのメールが検証されていると信頼することができます。

両方のニーズに対応するために、Azure ADとADFS接続には、次の2つの値を持つ**メール検証**プロパティがあります。

* `email_verified`を常に`true`に設定する
* `email_verified`を常に`false`に設定する

The Azure AD connection also has a **Use Common Endpoint** property. When it's enabled, the user can authenticate with any Azure AD tenant. Given it's not possible to trust that any Azure AD tenant will return verified emails, the **Email Verification** property will need to be set to **Always set** `email_verified` **to** `false`.

When the property is set to **Always set** `email_verified` **to** `false`, users will get `email_verified` set to `false` the next time they log in, unless [syncing user profile attributes at each login](/docs/manage-users/user-accounts/user-profiles/configure-connection-sync-with-auth0) is disabled.

## Azure AD/ADFSメール検証移行設定

以前のバージョンでは、Auth0では常に、Microsoft Entra IDおよびADFS接続の`email_verified`フィールドを`true`に設定していました。過去にAzure ADおよびADFS接続を使用していた場合は、**メール検証**の接続設定を上書きし、以前の動作を維持するテナント設定があります。

You can find the new tenant setting in the [Auth0 Dashboard > Settings > Advanced](https://manage.auth0.com/#/tenant/advanced). Locate the **Migrations** section, then find **Default to** `Email Verification` **setting for Azure AD/ADFS connections**.

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

This setting is only available if:

* the tenant is older than the date the migration was introduced
* the tenant has one or more active ADFS or Azure AD connection

</Callout>

<Frame>![Dashboard - Advanced Tenant Settings - Migrations](/images/cdy7uua7fh8z/4K1rQIv6p96KPCYOrhjXz4/be0f7b104d743fd0d3d42d18df97e144/dashboard-tenant-edit_view-advanced_migrations_azure-adfs.png)</Frame>

この設定が無効である場合、`email_verified`は常にAzure AD/ADFS接続に対して`true`になります。有効である場合、接続レベルで`メール検証`設定を使用します。

## Azure AD/ADFS接続のメール検証フロー

アプリケーションで、Azure AD/ADF 接続のユーザーからのメールを常に検証する必要がある場合は、テナントの**［Advanced Settings（高度な設定）］**セクションで**［Enable email verification flow during login for Azure AD and ADFS connections（Azure ADおよびADFS接続のログイン中にメール検証フローを有効にする）］**オプションを有効にできます。

ユーザーが未検証のメールで初めて認証すると、Auth0はユーザーにメールアカウントに送信される1回限りのコードを入力してメールを検証するよう求めます。

<Frame>![Auth0 - Email Verification Prompt - One-Time Code](/images/cdy7uua7fh8z/i92GJgntVuU5QK37adugH/b767d4db92de5bafd23113042eca2600/Verify_Email_-_English.png)</Frame>

ユーザーがこの手順を完了すると、`email_verified`フィールドが`true`に設定され、Azure ADまたはADFSがユーザーに別のメールを返さない限り、ユーザーは再度メール検証を求められることはなくなります。

This new screen is rendered using the <Tooltip tip="Universal Login: Your application redirects to Universal Login, hosted on Auth0's Authorization Server, to verify a user's identity." cta="View Glossary" href="/docs/glossary?term=Universal+Login">Universal Login</Tooltip> experience, even if you are using Classic Login. To learn how to customize it, read [Customize Universal Login Pages](/docs/customize/login-pages/universal-login/customize-templates).

To learn how to customize the email that is sent to users, read [Verify Emails using Auth0](/docs/manage-users/user-accounts/verify-emails).

<Warning>

When Azure AD does not return an `email` claim, Auth0 maps the [Azure UserPrincipalName](https://docs.microsoft.com/en-us/azure/active-directory/hybrid/plan-connect-userprincipalname) as the email. There is no guarantee that the `UserPrincipalName` value is a mailbox, so Auth0 will **not** display the email verification prompt and the user will have the field `email_verified` set to `false`.

</Warning>