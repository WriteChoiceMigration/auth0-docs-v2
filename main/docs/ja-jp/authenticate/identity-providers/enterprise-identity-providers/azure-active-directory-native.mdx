---
og:description: Learn how to connect your app to Microsoft Azure Active Directory
  using an enterprise connection with the Resource Owner flow.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: リソース所有者フローを使ってMicrosoft Entra IDにネイティブアプリを接続する
og:url: https://auth0.com/docs/
permalink: azure-active-directory-native
title: リソース所有者フローを使ってMicrosoft Entra IDにネイティブアプリを接続する
twitter:description: Learn how to connect your app to Microsoft Azure Active Directory
  using an enterprise connection with the Resource Owner flow.
twitter:title: リソース所有者フローを使ってMicrosoft Entra IDにネイティブアプリを接続する
---

WSフェデレーションとOpenID Connectフローに加えて、Microsoft Entra IDで[リソース所有者](/login/flows/resource-owner-password-flow)フローを使用することもできます。このフローでは、Microsoft Entra IDのログインページを表示するのでなく、ユーザーの資格情報（メールとパスワード）をキャプチャして検証することができます。セキュリティ上およびシングルサインオン（SSO）上の理由から、このアプローチは推奨されません。ただし、リソース所有者フローは、ネイティブモバイルシナリオ、またはMicrosoft Entra IDとの一括処理認証に役立つことがあります。

この構成には、WebアプリケーションとWeb API、ネイティブアプリケーションという2つのアプリケーションが必要です。Microsoft Entra IDの観点からすれば、ユーザーはネイティブアプリケーションによる認証を通じて、WebアプリケーションとWeb APIにアクセスします。



## 前提条件

[Auth0にアプリケーションを登録する](/get-started/create-apps)：

1. **アプリケーションタイプ**として**［Native（ネイティブ）］**を選択します。
2. **［Allowed Callback URL（許可されているコールバックURL）］**を追加します。コールバックURLの形式は、使用しているプラットフォームによって異なります。使用しているプラットフォームの形式の詳細については、「[ネイティブクイックスタート](/quickstart/native)」を参照してください。
3. アプリケーションの[［Grant Types（付与タイプ）］](/applications/update-grant-types)に適切なフローが必ず含まれていることを確認してください。

## ステップ

リソース所有者フローを使ってアプリケーションを接続するには、以下を行う必要があります。

1. [Microsoft Azureポータルでアプリケーションをセットアップする](#set-up-your-applications-in-the-microsoft-azure-portal)。
2. [Auth0でエンタープライズ接続を作成する](#create-an-enterprise-connection-in-auth0)。
3. [Auth0アプリケーションでエンタープライズ接続を有効にする](#enable-the-enterprise-connection-for-your-auth0-application)。
4. [接続をテストする](#test-the-connection)。



## Microsoft Azureポータルでアプリケーションをセットアップする



### 新規Webアプリケーションを登録する

Microsoft Entra IDでアプリケーションを登録する方法については、Microsoft Docsの「[クイックスタート：Microsoft IDプラットフォームにアプリケーションを登録する](https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app)」を参照してください。



アプリケーションのセットアップ中に、以下の設定を必ず使用してください。

* 外部組織（他のEntra IDディレクトリなど）からユーザーを許可したい場合は、**［Supported account types（サポートされているアカウントの種類）］**の設定時に、**［Accounts in any organizational directory (Any Azure AD directory - Multitenant)（任意の組織ディレクトリ内のアカウント（任意のMicrosoft Entra ID - マルチテナント））］**を選択します。
* **［Redirect URI（リダイレクトURI）］**を設定するよう求められたら、**［Web］**を選択し、フィールドにコールバックURL：`https://${account.namespace}/login/callback`を入力します。



このプロセス中に、後のチュートリアルで必要になるため、アプリケーション用に生成される**［Application (client) ID（アプリケーション（クライアント）ID）］**を記録しておきます（このIDは、アプリケーションの**［Overview（概要）］**画面に表示されます）。

### APIを公開するためにWebアプリケーションを構成する

Entra IDでAPIを公開するためにWebアプリケーションを構成する方法については、Microsoft Docsの「[クイックスタート：APIを公開するためにWebアプリケーションを構成する](https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-configure-app-expose-web-apis)」を参照してください。

アプリの構成中に、以下の設定を必ず使用してください。

* **［Scope name（スコープ名）］**を設定するよう求められたら、`API.Access`と入力します。

このプロセス中に、後のチュートリアルで必要になるため、アプリケーション用に生成される**［Application ID URI（アプリケーションID URI）］**を記録しておきます。

### 新規ネイティブアプリケーションを登録する

Azureでネイティブアプリケーションを登録する方法については、Microsoft Docsの「[クイックスタート：Microsoft IDプラットフォームにアプリケーションを登録する](https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app)」を参照してください。



アプリのセットアップ中は、以下の設定を必ず使用してください。

* 外部組織（他のEntra IDディレクトリなど）からユーザーを許可したい場合は、**［Supported account types（サポートされているアカウントの種類）］**の設定時に、**［Accounts in any organizational directory (Any Azure AD directory - Multitenant)（任意の組織ディレクトリ内のアカウント（任意のMicrosoft Entra ID - マルチテナント））］**を選択します。
* **［Redirect URI（リダイレクトURI）］**を設定するよう求められたら、`［Public client/native (mobile & desktop)（パブリッククライアント/ネイティブ（モバイルとデスクトップ））］`を選択し、コールバックURLを入力します。コールバックURLの形式は、使用しているプラットフォームによって異なります。使用しているプラットフォームの形式の詳細については、「[ネイティブクイックスタート](/quickstart/native)」をお読みください。

このプロセス中に、後のチュートリアルで必要になるため、アプリケーション用に生成される**［Application (client) ID（アプリケーション（クライアント）ID）］**を記録しておきます（このIDは、アプリケーションの**［Overview（概要）］**画面に表示されます）。

### ネイティブアプリケーション用にクライアントシークレットを作成する

クライアントシークレットを作成する方法については、Microsoft Docsの「[クイックスタート：Web APIにアクセスするようにクライアントアプリケーションを構成する」の「資格情報をWebアプリケーションに追加する」](https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-configure-app-access-web-apis#add-credentials-to-your-web-application)を参照してください。

**［Client secret（クライアントシークレット）］**を生成し、その値を記録します。この値は、後のチュートリアルで必要になります。



### ネイティブアプリケーションに権限を追加する

**ネイティブ**アプリケーションの権限を追加する方法については、Microsoft Docsの「[クイックスタート：Web APIにアクセスするようにクライアントアプリケーションを構成する」の「Web APIにアクセスするための権限を追加する」](https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-configure-app-access-web-apis#add-permissions-to-access-web-apis)を参照してください。

Auth0では、この構成が正常に機能するために（Microsoft Graph APIとAPIを公開するように構成したWebアプリケーションに）必要な最小特権アクセス許可を有効にする必要があります。Microsoft Graph APIのアクセス許可の詳細については、Microsoft Docsの「[Microsoft Graphのアクセス許可のリファレンス](https://learn.microsoft.com/en-us/graph/permissions-reference)」をお読みください。

アクセス許可のセットアップ中は、Microsoft Graph APIに以下の設定を必ず使用してください。

* アクセス許可の種類を求められたら、**［Delegated permissions（委任されたアクセス許可）］**を選択します。

* **［User（ユーザー）］**で**［User.Read］**を選択し、ユーザーをアプリにサインインさせ、サインインしたユーザーのプロファイルを読み取れるようにします。
* **［Directory（ディレクトリ）］**で**［Directory.Read.All］**を選択し、アプリがサインインしたユーザーの代理としてディレクトリデータを読み取れるようにします。

APIを公開するように構成したWebアプリに対しては、以下の設定を必ず使用してください。

* アクセス許可の種類を求められたら、**［Delegated permissions（委任されたアクセス許可）］**を選択します。

* **［API］**で**［API.Access］**を選択し、アプリがユーザーの代理としてAPIにアクセスできるようにします。

## Auth0で接続を構成する

Microsoft Entra IDで両方のアプリケーションを作成したら、Auth0の接続を構成することができます。

1. [［Auth0 Dashboard］>［Authentication（認証）］>［Enterprise（エンタープライズ）］](%24%7Bmanage_url%7D/#/connections/enterprise)に移動し、**［Microsoft Entra ID］**を見つけ、追加（**+**）ボタンを選択します。
2. 接続の詳細を入力し、 **［Create（作成）］**をクリックします。

## Auth0アプリケーションでエンタープライズ接続を有効化する

新たなMicrosoft Entra IDエンタープライズ接続を使用するには、Auth0アプリケーションの[接続を有効](/connections/enable-enterprise-connections)にする必要があります。

## 接続をテストする

これで[接続をテスト](/connections/test-enterprise-connections)する準備が整いました。

## グループメンバーシップと詳細なプロファイル情報

このネイティブフローでは、Auth0は、Microsoft Entra IDからアクセストークンを受け取ります。このトークンは、Microsoft Entra IDのWebアプリケーション用に発行されたものです。この結果、グループメンバーシップや詳細なプロファイル情報の読み込みなどの機能は機能しなくなります。これは、Microsoft Entra IDから受け取ったアクセストークンを使って、Microsoft Entra ID Graph APIからこの追加情報を照会できなくなるためです。

ただし、グループメンバーシップと詳細なプロファイル情報を使用している場合は、ニーズに合わせて構成を変更することができます。

1. Azureでは、Microsoft Graph APIの追加アクセス許可を使ってネイティブアプリケーションを構成します。

* アクセス許可の種類を求められたら、**［Delegated permissions（委任されたアクセス許可）］**を選択します。

* **［Directory（ディレクトリ）］**で**［Directory.AccessAsUser.All］**を選択し、アプリがサインインしたユーザーとしてディレクトリにアクセスできるようにします。
2. Auth0で、Microsoft Entra IDエンタープライズ接続を変更します。

* **［Identity API］**で`［Microsoft Entra ID (v1)］`を選択します。**［App ID URI（アプリIDのURI）］**には、Microsoft Entra ID Graph APIのURIを入力します。

## 次の手順

* [Auth0のライブラリーを使ってAuth0を統合する](/libraries)
* [Authentication APIを使ってAuth0を統合する](/api/authentication)
* [認証フローについての詳細を読む](/login/flows)
* [追加のパラメーターをIDプロバイダーに渡す](/pass-parameters-to-idps)
* [アクセス許可のためにユーザーを再度プロンプトする](/reprompt-permissions)