---
og:description: Describes how to setup authentication using client certificates.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: クライアント証明書を使ってAD/LDAPコネクターの認証を構成する
og:url: https://auth0.com/docs/
permalink: configure-ad-ldap-connector-client-certificates
title: クライアント証明書を使ってAD/LDAPコネクターの認証を構成する
twitter:description: Describes how to setup authentication using client certificates.
twitter:title: クライアント証明書を使ってAD/LDAPコネクターの認証を構成する
---

ユーザーの認証について、AD/LDAPコネクターもユーザーが自分のコンピューターやデバイスにインストールした証明書を使用できるようにします。

## クライアント証明書を有効にする

1. Go to [Auth0 Dashboard > Authentication > Enterprise > Active Directory/LDAP](https://manage.auth0.com/#/connections/enterprise/ad), and select the connection you want to configure.
2. Toggle the **Use client SSL certificate authentication** option in the settings.
3. Provide IP address ranges in the **IP Ranges** field. Only users coming from the given IP ranges are prompted to authenticate using client certificates. Users from different IP ranges are prompted to login with the username and password login form.

## 証明書を構成する

Auth0でAD/LDAP接続が構成されると、AD/LDAPコネクターで証明書を構成する必要があります。クライアント証明書に対応するには、以下が必要です。

* フロントエンドのURLのSSL証明書。エンドユーザーとコネクター間のやり取りにはHTTPSを使う必要があるためです。
* 1つ以上のCA証明書
* クライアント証明書を使った認証を必要とするユーザーのそれぞれについて、CAが署名したクライアント証明書

1. Before uploading certificates to the AD/LDAP connector, convert X.509 certificates to Base64. Use Base64 or Certutil on Windows Server. To learn more, see [Base64 Decode](https://www.base64decode.org/) at Base64decode or [Certutil.exe](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/certutil#BKMK_encode) in Microsoft documentation.
2. Upload the SSL and CA certificates to the AD/LDAP Connector:

   <Frame>![Configure AD/LDAP Connector Authentication with Client Certificates Setup Screen](/images/cdy7uua7fh8z/2zRux90ZHATIBFWyHlodue/c426e5a475ff528a467db6409980de12/connector-client-cert-config.png)</Frame>
3. To test, generate a self-signed CA and Client Certificates using **makecert.exe** on Windows, which is part of the Windows SDK:

   ```bash lines
   SET ClientCertificateName=jon
       SET RootCertificateName=FabrikamRootCA
       "C:\Program Files (x86)\Microsoft SDKs\Windows\v7.1A\Bin\makecert.exe" -sky exchange -r -n "CN=%RootCertificateName%" -pe -a sha1 -len 2048 -ss My "%RootCertificateName%.cer"
       "C:\Program Files (x86)\Microsoft SDKs\Windows\v7.1A\Bin\makecert.exe" -n "CN=%ClientCertificateName%" -pe -sky exchange -m 96 -ss My -in "%RootCertificateName%" -is my -a sha1
   ```


   

   

   クライアント証明書のサブジェクトは必ず`CN=AD_USERNAME`の形式（例：`CN=jon`）にします。

アプリケーションでユーザーがAD/LDAP接続を使ってサインインフローを始めると、以下が実行されます。

```js lines
auth.signin({
       popup: true,
       connection: 'FabrikamAD',
       scope: 'openid name email'
     }, onLoginSuccess, onLoginFailed);
```






ユーザーのIPアドレスが指定のIPアドレス範囲にある場合は、クライアント証明書を使った認証が求められます。

<Frame>![Configure AD/LDAP Connector Authentication with Client Certificates Choose Client Certificate](/images/cdy7uua7fh8z/1loz5lrd2NkHs2gKgbIJKF/11a373d520eaae08c20055cb68613972/connector-client-cert-choose.png)</Frame>

証明書を選択すると、以下のようにAD/LDAPコネクターが検証して、ユーザーがログインされます。

<Frame>![Configure AD/LDAP Connector Authentication with Client Certificates Logged In User](/images/cdy7uua7fh8z/2Lr78NWYfzD3Hw3JIDPQmb/3790acd68fa283ca79c1263f97fa29c4/connector-client-cert-loggedin.png)</Frame>