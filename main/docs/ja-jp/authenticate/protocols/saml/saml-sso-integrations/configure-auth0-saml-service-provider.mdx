---
og:description: Describes how to configure Auth0 to serve as a service provider in
  a SAML federation.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: SAMLサービスプロバイダーとしてのAuth0の構成
og:url: https://auth0.com/docs/
permalink: configure-auth0-saml-service-provider
sidebarTitle: SAMLサービスプロバイダーとしてのAuth0の構成
title: SAMLサービスプロバイダーとしてのAuth0の構成
twitter:description: Describes how to configure Auth0 to serve as a service provider
  in a SAML federation.
twitter:title: SAMLサービスプロバイダーとしてのAuth0の構成
---

Auth0をSAMLフェデレーションのサービスプロバイダー(SP)として構成するために、Auth0でエンタープライズ接続を作成し、接続するメタデータでSAML IDプロバイダー(IdP)を更新する必要があります。

Auth0は、SAML 1.1またはSAML 2.0プロトコルに準拠する構成でAuth0をSPとして使用することをサポートしています。

## IdPからメタデータと署名証明書を入手

Auth0で接続を作成するには、IdPから複数の構成メタデータを収集する必要があります。



## Auth0でSAMLエンタープライズ接続を作成する

Auth0 DashboardまたはAuth0 Management APIを使用してSAMLエンタープライズ接続を作成できます。



### プロキシゲートウェイのSAML接続を構成する

プロキシゲートウェイの背後にAuth0がある場合は、それに応じてSAML接続の`destinationUrl`フィールドと`recipientUrl`フィールドを構成する必要があります。

1. Management API[接続を取得](https://auth0.com/docs/api/management/v2/connections/get-connections-by-id)エンドポイントを使用してSAML接続の現在の構成を取得します。
2. 返された応答から`options`オブジェクトの値をコピーします。
3. `options`オブジェクトに次のフィールドを追加します。
4. 要求本文内の更新された`options`ブジェクト全体を使用してManagement API[接続の更新](https://auth0.com/docs/api/management/v2/connections/patch-connections-by-id)エンドポイントを呼び出します。

### 要求テンプレートのカスタマイズ

Auth0がIdPに認証要求を送信すると、要求本文に`AuthnRequest`オブジェクトが含まれます。このオブジェクトに使用されるテンプレートをカスタマイズできます。

1. [［Dashboard］>［Authentication（認証）］>［Enterprise（エンタープライズ）］>［SAML］](%24%7Bmanage_url%7D/#/connections/enterprise/samlp)に移動し、接続を選択します。
2. **［Settings（設定）］**ビューに切り替えて、**［Request Template（テンプレート要求）］**フィールドを見つけます。
3. テンプレートを修正します。
4. **［Save Changes（変更の保存）］**を選択します。

#### テンプレート変数

変数は、`@@VariableName@@`構文を使用して`AuthnRequest`テンプレートに配置できます。次の変数を使用できます。



## IdPを構成する

[SAML IDプロバイダーの構成設定](/saml-configuration/saml-identity-provider-configuration-settings)に移動して、IdPに提供する必要のあるメタデータを見つけます。

Auth0は、SAML 1.1またはSAML 2.0プロトコルに準拠する構成ですべてのSAML IdPをサポートしています。特定のプロバイダーを設定するための詳細な手順は次のとおりです。

* [ADFS](/saml-configuration/configure-auth0-saml-service-provider/configure-adfs-saml-connections)
* [Okta](/saml-configuration/configure-auth0-saml-service-provider/configure-okta-as-saml-identity-provider)
* [OneLogin](/saml-configuration/configure-auth0-saml-service-provider/configure-onelogin-as-saml-identity-provider)
* [Ping](/saml-configuration/configure-auth0-saml-service-provider/configure-pingfederate-as-saml-identity-provider)
* [Salesforce](/saml-configuration/configure-auth0-saml-service-provider/configure-salesforce-as-saml-identity-provider)
* [SiteMinder](/saml-configuration/configure-auth0-saml-service-provider/configure-siteminder-as-saml-identity-provider)
* [SSOCircle](/saml-configuration/configure-auth0-saml-service-provider/configure-ssocircle-as-saml-identity-provider)

## 接続をテストする

Dashboardで接続をテストするには：

1. ［[Dashboard］>［Authentication（認証）］>［Enterprise（エンタープライズ）］>［SAML](https://manage.auth0.com/#/connections/enterprise/samlp)］に移動します。
2. 作成した接続を見つけて、**...**（3つのドット）メニュー アイコンを選択し、**［Try（試す）］**を選択します。
3. ユニバーサルログインページが表示され、資格情報の入力を求められます。
4. IdPに存在するユーザーのメール アドレスを入力します。[ホーム領域検出](https://auth0.com/docs/authenticate/login/auth0-universal-login/identifier-first#define-home-realm-discovery-identity-providers)を構成した場合は、指定されたドメインのいずれかを使用するメールアドレスを入力してください。
5. IdPのログイン画面にリダイレクトされたら、通常どおりログインします。
6. IdPからAuth0に送信された認証アサーションの内容を表示するAuth0のページにリダイレクトされます。

## 接続のトラブルシューティング

接続が期待どおりに機能しない場合は、次の手順を試してください。

* 各テストの前にブラウザの履歴、クッキー、キャッシュをクリアしてください。そうしないと、ブラウザが最新の構成情報を取得できなかったり、実行に影響する古いクッキーが残る可能性があります。
* ブラウザでクッキーが許可され、JavaScriptが有効になっていることを確認してください。
* トランザクションの[HARファイルをキャプチャ](https://auth0.com/docs/troubleshoot/troubleshooting-tools/generate-and-analyze-har-files)し、[Auth0 SAMLツール](http://samltool.io/)を使用してSAMLアサーションをデコードし、そのコンテンツを確認します。