---
og:description: Describes how to configure SAML Identity Provider-initiated Single
  Sign-on (SSO).
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: SAML IDプロバイダー起点のシングルサインオンを構成する
og:url: https://auth0.com/docs/
permalink: identity-provider-initiated-single-sign-on
title: SAML IDプロバイダー起点のシングルサインオンを構成する
twitter:description: Describes how to configure SAML Identity Provider-initiated Single
  Sign-on (SSO).
twitter:title: SAML IDプロバイダー起点のシングルサインオンを構成する
---

Many instructions for setting up a <Tooltip tip="Security Assertion Markup Language (SAML): Standardized protocol allowing two parties to exchange authentication information without a password." cta="View Glossary" href="/docs/glossary?term=SAML">SAML</Tooltip> federation begin with <Tooltip tip="Security Assertion Markup Language (SAML): Standardized protocol allowing two parties to exchange authentication information without a password." cta="View Glossary" href="/docs/glossary?term=Single+Sign-on">Single Sign-on</Tooltip> (SSO) initiated by the service provider. The service provider redirects the user to the <Tooltip tip="Single Sign-On (SSO): Service that, after a user logs into one applicaton, automatically logs that user in to other applications." cta="View Glossary" href="/docs/glossary?term=identity+provider">identity provider</Tooltip> (IdP) for the purposes of authentication. This process is commonly used for consumer-facing scenarios.

ただし、エンタープライズのシナリオでは、サービスプロバイダーではなくIdPによってSSOが開始されることが一般的です。たとえば、エンタープライズは、ユーザーがポータルにサインオンした後に正しいアプリケーションに移動できるようにポータルをセットアップする場合があります。

## リスクと検討事項

IdP起点フローにはセキュリティリスクがあるため、お勧めできません。可能な限り、SP起点フローの使用をお勧めします。

Make sure you understand the risks before enabling IdP-Initiated SSO. In this scenario, Auth0 receives the unsolicited response from the IdP and the application receives the unsolicited response from Auth0. Neither entity can verify that the user started the flow. Because of this, enabling this flow opens the possibility of an [Login CSRF attack](https://support.detectify.com/support/solutions/articles/48001048951-login-csrf), where an attacker can trick a legitimate user into unknowingly logging into the application with the identity of the attacker.

### OpenID ConnectのIdP起点フロー

<Tooltip tip="OpenID: Open standard for authentication that allows applications to verify users' identities without collecting and storing login information." cta="View Glossary" href="/docs/glossary?term=OpenID">OpenID</Tooltip> Connect (OIDC) does not support the concept of an IdP-Initiated flow. So while Auth0 offers the possibility of translating a SAML IdP-Initiated flow (from a SAML connection) into an OIDC response for an application, any application that properly implements the OIDC/OAuth2 protocol will reject an unrequested response.

OIDCアプリケーションを使用する場合、最良のオプションは、アプリケーションにログインエンドポイントを作成させることです。このエンドポイントの唯一の目的は、IdP（Auth0テナント）へのリダイレクトを開始することです。

複数のIdPを使用する場合は、ログインエンドポイントがIDプロバイダーに固有であるか、ワークフローを開始するIdPを識別するパラメーターを受け入れられることを確認してください。

別のアプローチとして、ユーザーがアプリケーションでログインフローを開始することもできます。

### ポストバックURL

IdP起点SSOを使用する場合は、必ずポストバックURLに接続パラメーターを含めてください。

```http wrap lines
https://{yourDomain}/login/callback?connection={yourConnectionName}
```






If you are using the [Organizations](/docs/manage-users/organizations) feature, you can optionally include an organization parameter containing the organization ID of the desired organization:

```http wrap lines
https://{yourDomain}/login/callback?connection={yourConnectionName}&organization={yourCustomersOrganizationId}
```






<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

In order for users to successfully log-in using this method, the connection must be enabled for the Organization. Additionally, you must either configure [auto-membership](/docs/manage-users/organizations/configure-organizations/grant-just-in-time-membership) for the enabled connection or ensure users have membership for the Organization.

</Callout>

### アプリケーションが、Lock またはAuth0.jsを使用して認証結果を処理するシングルページアプリケーションの場合は、IdP起点フローを許可することを明示的に示す必要があり、その結果、アプリケーションがログインCSRF攻撃にさらされる可能性があります。

Auth0.jsを使用している場合は、ライブラリーの`webAuth.parseHash`を更新し、フラグ` __enableIdPInitiatedLogin`を`true`に設定する必要があります。

If you are using Auth0.js, you must update the `webAuth.parseHash` of the library and set the flag `__enableIdPInitiatedLogin` to `true`.

```javascript lines
var data = webAuth.parseHash(
      {
        ...
        __enableIdPInitiatedLogin: true
        ...
      }
```

フラグ自体は次のとおりです：

`const lock = new Auth0Lock(clientID, domain, options)`

IDP起点SSOをセットアップする

`var options = { _enableIdPInitiatedLogin: true };`

**IdP-initiated SSO Behavior（IdP起点SSOの動作）**：このオプションを使用すると、SAML接続に対してIdP起点のログインを有効にすることができます。**［Accept Requests（要求を受け入れる）］**を選択し、すべての必須フィールドに値を入力します。

## **Default Application（デフォルトのアプリケーション）**：IdP起点のログインが成功すると、これがユーザーをルーティングするアプリケーションとなります。この設定には、この接続で有効になっている利用可能なアプリケーションが表示されます。IdP起点でユーザーにログインさせるアプリケーションをドロップダウンから選択します。1つのSAML接続につき、IdP起点のログインに対して選択できるアプリケーションは1つだけです。

1. Go to the [Dashboard > Authentication > Enterprise](https://manage.auth0.com/#/connections/enterprise) and choose **SAMLP Identity Provider**.
2. Under **Settings** you can see the configuration for IdP-Initiated SSO.

   <Frame>![Protocols IdP-initiated SSO Configuration Screen](/images/cdy7uua7fh8z/1HORCAp4fZQg0BOoIopvoS/0009d4b5f405c2436af5729d52a3867d/2025-01-28_13-47-26.png)</Frame>

* **Response Protocol（応答プロトコル）**：これは、選択した**デフォルトのアプリケーション**の接続に使用するプロトコルです。通常、アプリケーションはOpenID Connectプロトコルを使って構成されます（上記を参照）。ただし、アプリケーションにSAML2 Webアプリアドオンを構成しており、SAMLアサーションをルーティングしたい場合は、SAMLを選択する必要があります。有効なSAMLアサーションがポストバックURLに渡されると、Auth0は、選択された応答プロトコルを使用して、構成されたデフォルトのアプリケーションの最初に許可されたコールバックURLにログイン応答を送信します。OIDCを使用する場合、クエリ文字列フィールドを使用してこのプロトコルを変更し、`redirect_uri`を指定することができます。
* **Query String（クエリ文字列）**：クエリ文字列のオプションは、OpenID Connectプロトコルが使用されるときの動作をカスタマイズするのに役立ちます。[クエリ文字列]()を使用して、パラメーターの設定に類似した複数のオプションを設定することができます。以下のように設定できます。
* 100に制限されているアプリケーションドロップダウンリスト
* **Query String:** Query string options help to customize the behavior when the OpenID Connect protocol is used. You can set multiple options similar to setting parameters with a [query string](https://en.wikipedia.org/wiki/Query_string). You can set:

<table class="table"><thead>
<tr>
<th>Setting</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>redirect_uri</code></td>
<td>When the IdP-initiated login has completed the request is then redirected to the first URL listed in the <strong>Allowed Callback URLs</strong> for the application. However, if you set a <code>redirect_uri</code>, the IdP will redirect to this URL. This adds flexibility for cases such as when you have a set subdomain scheme with a wildcard and you only want to redirect to one specific subdomain.</td>
</tr>
<tr>
<td><code>scope</code></td>
<td>Define scopes for the ID token sent. You can set multiple scopes.</td>
</tr>
<tr>
<td><code>response_type</code></td>
<td>Set the token for the Implicit Grant Flow for SPAs. You can set code for the Authorization Code Grant Flow for regular web apps.</td>
</tr>
</tbody>
</table>

  <Warning>

  In an IdP initiated flow, Auth0 servers strip scopes inside a token if the callback URL is an unverified domain. Auth0 defines only `localhost` and [127.0.0.1](http://127.0.0.1/) as unverified domains. If you use either as your callback URL, tokens from the `/userinfo` endpoint will return an empty response. To get a token response with requested scopes, use a verified domain.

  </Warning>

  Example Query String:
  `redirect_uri=https://jwt.io&scope=openid email&response_type=token`

## Application drop-down list limited to 100

If you want to select an application as the **Default Application** in IdP-initiated SSO, and the application isn't in the first 100 applications listed in the drop-down list for your tenant, you must use the <Tooltip tip="Management API: A product to allow customers to perform administrative tasks." cta="View Glossary" href="/docs/glossary?term=Management+API">Management API</Tooltip> to select that application. You must run a patch:

```json lines
{
"options": {
"signInEndpoint": "yourIdpSignInUrl",
"idpinitiated": {
"client_id": "yourClientId",
"client_protocol": "saml",
"client_authorizequery": ""
},
"signingCert": "[copied-from-GET]"
}
}
```


## Learn more

* [Work with Certificates and Keys as Strings](/docs/authenticate/protocols/saml/saml-sso-integrations/work-with-certificates-and-keys-as-strings)