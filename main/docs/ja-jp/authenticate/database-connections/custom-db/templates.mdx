---
og:description: Learn about custom database action script templates.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: カスタムデータベースのアクションスクリプト用テンプレート
og:url: https://auth0.com/docs/
permalink: templates
title: カスタムデータベースのアクションスクリプト用テンプレート
twitter:description: Learn about custom database action script templates.
twitter:title: カスタムデータベースのアクションスクリプト用テンプレート
---

<Card title="Availability varies by Auth0 plan">

Your Auth0 plan or custom agreement affects whether this feature is available. To learn more, read [Pricing](https://auth0.com/pricing).

</Card>

If you have your own database (known as a legacy data store in Auth0) containing user identity data, you can use it as an <Tooltip tip="Identity Provider (IdP): Service that stores and manages digital identities." cta="View Glossary" href="/docs/glossary?term=identity+provider">identity provider</Tooltip> to authenticate users.
カスタムデータベーススクリプトには、以下の2種類があります。

**自動移行**：Auth0へのログイン時に、ユーザーがまだAuth0に存在していない場合、スクリプトはレガシーデータベースでユーザーの有無を確認します。ユーザーが見つかり、**Auth0にユーザーをインポート**フラグがある場合には、ユーザーデータによってユーザーがAuth0データストアに移行されます。この機能は、**トリクルダウン移行**や**レイジー移行**と呼ばれることがあります。

* **レガシーデータベース**：ユーザーのログイン試行、作成、パスワード変更、メール検証や削除では、Auth0は必ず基盤となるデータベースにクエリを行います。ユーザーが見つかって、**Auth0にユーザーをインポート**フラグが**ない**場合には、ユーザーデータはレガシーデータベースに留まり、Auth0には移行**されません**。
* Auth0には、以下のカスタムデータベースのアクションスクリプトがあります。

[パスワード変更](/change-password)

* [Change Password](/docs/authenticate/database-connections/custom-db/templates/change-password)
* [Create User](/docs/authenticate/database-connections/custom-db/templates/create)
* [Delete User](/docs/authenticate/database-connections/custom-db/templates/delete)
* [Get User](/docs/authenticate/database-connections/custom-db/templates/get-user)
* [Login](/docs/authenticate/database-connections/custom-db/templates/login)
* [Verify User](/docs/authenticate/database-connections/custom-db/templates/verify)
* [Change Email](/docs/authenticate/database-connections/custom-db/templates/change-email)

<Card title="Network firewall">

If you are behind a firewall, this feature may require that you add the appropriate Auth0 IP addresses to the Allow List to work properly.

</Card>

## 「[カスタムデータベース接続](/connections/database/custom-db)」で説明されているように、カスタムデータベース接続タイプでは、アクションスクリプトを構成することができます。アクションスクリプトとは、レガシーIDストアとのやり取りに使用されるカスタムコードのことです。原則的に、各アクションスクリプトは名前が付けられたJavaScript関数で、多数のパラメータが渡されます。関数の名前と渡されるパラメーターは、スクリプトによって異なります。

As described in [Custom Database Connections](/docs/authenticate/database-connections/custom-db), a custom database connection type allows you to configure action scripts: custom code that is used when interfacing with your legacy identity store. Each action script is essentially a named JavaScript function that is passed a number of parameters, with the name of the function and the parameters passed depending on the script.

### アクションスクリプトの実行は、JavaScriptの非同期な性質に対応し、[Promise]()オブジェクトなどのコンストラクトを使用することができます。非同期処理を行うと、操作の完了が保留され、事実上一時停止となります。Auth0のサーバーレスWebtaskコンテナーには通常、20秒の実行制限が設けられており、それを超えると、コンテナーはリサイクルされます。この制限によってコンテナーがリサイクルされると、操作は途中で終了され、最終的にはエラー状態が返されます（`global`オブジェクトもリセットされる可能性があります）。

Action script execution supports the asynchronous nature of JavaScript, and constructs such as [Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise) objects can be used. Asynchronous processing effectively results in suspension pending completion of an operation, and an Auth0 serverless Webtask container typically has a 20-second execution limit, after which the container may be recycled. Recycling a container due to this limit will prematurely terminate operation, ultimately resulting in an error condition being returned (as well as resulting in a potential reset of the `global` object).

### Completion and the callback function

アクションスクリプトが非同期処理を使用する場合、`callback`関数への呼び出しは、非同期処理が完了する時点まで延期され、一番最後に呼び出される必要があります。非同期実行では、非同期操作が完了した後でJavaScript `callback`が実行されます。このコールバックは通常、JavaScript関数のメイン（同期）のボディーが完了した後、ある時点で呼び出されます。

<Warning>

The Auth0 supplied `callback` function must be called exactly **once**; calling the function more than once within an action script will lead to unpredictable results and/or errors.

</Warning>

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

Where `callback` is executed with no parameters, as in `callback()`, the implication is that function has been called as though `callback(null)` had been executed.

</Callout>

If an action script uses asynchronous processing, then a call to the `callback` function must be deferred to the point where asynchronous processing completes, and must be the final thing called. Asynchronous execution will result in a JavaScript `callback` being executed after the asynchronous operation is complete; this callback is typically fired at some point after the main (synchronous) body of a JavaScript function completes.

<Warning>

Failure to execute the `callback` function will result in a stall of execution, and ultimately in an error condition being returned. The action script must call the `callback` function exactly once: the `callback` function must be called at least once in order to prevent stall of execution, however it must not be called more than once otherwise unpredictable results and/or errors will occur.

</Warning>

## Learn more

* [Custom Database Action Script Execution Best Practices](/docs/authenticate/database-connections/custom-db/custom-database-connections-scripts/execution)
* [Troubleshoot Custom Databases](/docs/authenticate/database-connections/custom-db/error-handling)