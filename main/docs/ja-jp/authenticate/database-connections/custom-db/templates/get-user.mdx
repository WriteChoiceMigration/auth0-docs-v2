---
og:description: Describes custom database action script templates for user search.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: ユーザー取得スクリプトのテンプレート
og:url: https://auth0.com/docs/
permalink: get-user
title: ユーザー取得スクリプトのテンプレート
twitter:description: Describes custom database action script templates for user search.
twitter:title: ユーザー取得スクリプトのテンプレート
---

ユーザー取得スクリプトは、ユーザーの現在の存在状態を特定するための関数を実装します。この関数の名前は`getUser`にすることをお勧めします。

このスクリプトは[自動移行](/users/import-and-export-users/configure-automatic-migration-from-your-database)には必須で、接続に構成された操作によっては、レガシー認証に条件付きで必須になります。

接続に自動移行を構成していて、ユーザープロファイルが作成されていない場合には、以下の操作が起きると必ずこのスクリプトが実行されます。

* メール変更
* サインアップ
* パスワードリセット

接続にレガシー認証が構成されている場合には、以下の操作が起きると必ずこのスクリプトが実行されます。

* ユーザーの作成
* メール変更
* パスワード変更
* パスワードリセット

## ユーザー取得関数

`getUser`は以下を行う必要があります。

* ユーザーの識別子を外部データベースのAPIに送信する。
* ユーザーが見つかったら、ユーザーのプロファイルデータを返す。
* ユーザーの存在を特定するのに問題がある場合には、エラーを返す。

### 定義

`getUser`関数は2つのパラメーターを受け取り、`callback`関数を返します。





### 例

これは疑似JavaScriptを使った例で、どのようにすれば`getUser`関数を実装できるかがわかります。言語固有の例については、「[言語固有のスクリプトの例](#language-specific-script-examples)」をお読みください。



## コールバック関数

`callback`関数は、パイプラインを通してユーザープロファイルデータやエラーデータを渡すのに使用されます。

### 定義

`callback`関数は2つまでのパラメーターを受け取り、1つの関数を返します。





### ユーザープロファイルを返す（ユーザーが見つかった場合）



ユーザーが見つかった場合には、`null`値を`error`パラメーターに渡し、ユーザーのプロファイルデータを[正規化された形式](/users/user-profiles/normalized-user-profile-schema)で`profile`パラメーターに渡します。標準フィールドのほかにも、`user_metadata`、`app_metadata`、および`mfa_factors`フィールドを含めることができます。

#### 例



### ユーザープロファイルを返さない（ユーザーが見つからなかった場合）

ユーザーが見つからなかった場合には、`null`値を`error`パラメーターに返し、`profile`パラメーターを省略します。

#### 例



### エラーの場合

エラーが発生した場合には、何が起きたかについての関連情報のあるエラーデータを`error`パラメーターに渡します。詳細については、「[カスタムデータベースのトラブルシューティング](/connections/database/custom-db/error-handling)」をお読みください。

#### 例



## 言語固有のスクリプトの例

Auth0は、以下の言語や技術で使用できるサンプルスクリプトを提供しています。

* [JavaScript](#javascript)
* [ASP.NET Membership Provider（MVC3 - Universal Providers）](#asp-net-membership-provider-mvc3-universal-providers-)
* [ASP.NET Membership Provider（MVC4 - Simple Membership）](#asp-net-membership-provider-mvc4-simple-membership-)
* [MongoDB](#mongodb)
* [MySQL](#mysql)
* [PostgreSQL](#postgresql)
* [SQL Server](#sql-server)
* [Windows Azure SQL Database](#windows-azure-sql-database)
* [Axios](#axios)
* [Stormpath](#stormpath)

### JavaScript



### ASP.NET Membership Provider（MVC3 - Universal Providers）



### ASP.NET Membership Provider（MVC4 - Simple Membership）



### MongoDB



### MySQL



### PostgreSQL



### SQL Server



### Windows Azure SQL Database



### Axios



### Stormpath