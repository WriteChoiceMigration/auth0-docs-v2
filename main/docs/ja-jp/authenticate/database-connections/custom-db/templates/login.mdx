---
og:description: Describes custom database action script templates for user login.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: ログインスクリプトのテンプレート
og:url: https://auth0.com/docs/
permalink: login
title: ログインスクリプトのテンプレート
twitter:description: Describes custom database action script templates for user login.
twitter:title: ログインスクリプトのテンプレート
---

ログインスクリプトは、ユーザーの認証が必要になるたびに実行される関数を実装します。この関数の名前は`login`にすることをお勧めします。

このスクリプトは、レガシー認証と[自動移行](/users/import-and-export-users/configure-automatic-migration-from-your-database)の両方で必要です。自動移行が接続に対して構成されている場合、移行プロセスはユーザーが初めて正常にログインするときにトリガーされます。

## Login関数

`login`関数は以下を行います。

* ユーザー資格情報を外部データベースのAPIに送信する。
* 認証が成功したらユーザーのプロファイルデータを返す。
* 認証に失敗したらエラーを返す。

### 定義

`login`関数は3つのパラメーターを受け取り、`callback`関数を返します。





### 例

これは疑似JavaScriptを使った例で、どのようにすれば`login`関数を実装できるかがわかります。言語固有の例については、「[言語固有のスクリプトの例](#language-specific-script-examples)」をお読みください。



### Encryption（暗号化）



`bcrypt`のような暗号学的ハッシュの暗号化ライブラリを使って`パスワード`値を暗号化し、潜在的なデータ漏洩を防ぎます。

#### 例



## コールバック関数

`callback`関数は、パイプラインを通してユーザープロファイルデータやエラーデータを渡すのに使用されます。

### 定義

`callback`関数は2つまでのパラメーターを受け取り、1つの関数を返します。





### ユーザープロファイルを返す



ユーザーが認証に成功した場合、プロファイルデータは[正規化フォーム](/users/user-profiles/normalized-user-profile-schema)の`profile`オブジェクトに返される必要があります。標準フィールドのほかにも、`user_metadata`、`app_metadata`、および`mfa_factors`フィールドを含めることができます。

#### 例



### エラーの場合

エラーが発生した場合には、何が起きたかについての関連情報が`error`パラメーターに含まれるようにします。

#### WrongUsernameOrPasswordErrorタイプのオブジェクト

`WrongUsernameOrPasswordError`のカスタムエラータイプのオブジェクトを使うと、[テナントログ](/logs)で表示されるデータを渡すことができます。

##### コンストラクター

`WrongUsernameOrPasswordError`コンストラクターは、最大2つのパラメーターを受け取ります。





#### ユーザー名またはメールでエラーを返す

`userNameOrEmail`フィールドの値でエラーを返すと、Auth0は`fp`のテナントログイベントを記録します。

##### 例





#### ユーザー名またはメールなしでエラーを返す

`userNameOrEmail`フィールドの`null`値でエラーを返すと、Auth0は`fu`のテナントログイベントを記録します。

##### 例





## ［Sync user profile attributes at each login（ログインの度にユーザープロファイル属性を同期する）］

Auth0でログインのたびに外部データベースから返された値で`name`、`nickname`、`given_name`、`family_name`、および`picture`フィールドを更新したい場合は、**［Sync user profile attributes at each login（ログインのたびにユーザープロファイル属性を同期する）］**設定を有効にします。

この設定を有効にしないと、ログインのたびに外部データベースから返された値は、外部データベースで変更したとしても、以降のログインでも保持されます。

## 言語固有のスクリプトの例

Auth0は、以下の言語や技術で使用できるサンプルスクリプトを提供しています。

* [JavaScript](#javascript)
* [ASP.NET Membership Provider（MVC3 - Universal Providers）](#asp-net-membership-provider-mvc3-universal-providers-)
* [ASP.NET Membership Provider（MVC4 - Universal Providers）](#asp-net-membership-provider-mvc4-simple-membership-)
* [MongoDB](#mongodb)
* [MySQL](#mysql)
* [PostgreSQL](#postgresql)
* [SQL Server](#sql-server)
* [Windows Azure SQL Database](#windows-azure-sql-database)
* [Axios](#axios)
* [Stormpath](#stormpath)

### JavaScript



### ASP.NET Membership Provider（MVC3 - Universal Providers）



### ASP.NET Membership Provider (MVC4 - Simple Membership)



### MongoDB



### MySQL



### PostgreSQL



### SQL Server



### Windows Azure SQL Database



### Axios



### Stormpath