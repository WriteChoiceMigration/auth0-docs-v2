---
og:description: Describes custom database action script templates for user creation.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: 作成スクリプトのテンプレート
og:url: https://auth0.com/docs/
permalink: create
title: 作成スクリプトのテンプレート
twitter:description: Describes custom database action script templates for user creation.
twitter:title: 作成スクリプトのテンプレート
---

作成スクリプトは、ユーザーが作成されるときに定義された関数を実装します。この関数の名前は`create`にすることをお勧めします。

これは任意のスクリプトです。これが有効になっている場合は、ユーザーがユニバーサルログイン経由でサインアップするとき、またはユーザーがAuth0 DashboardまたはAuth0 Management APIで作成されるときに、Auth0がこのスクリプトを実行し、対応するユーザーレコードを外部データベースに作成します。

ユーザーがAuth0で作成されるときは、Auth0が一連のスクリプトを呼び出します。

1. [ユーザー取得](/get-user)：ユーザーがまだAuth0や外部データベースに存在しないことを確認する。
2. 作成：ユーザーを外部データベースに作成する。
3. [ログイン](/login)：ユーザーが正常に作成されたことを確認する。

## 作成関数

`create`関数は以下を行います。

* ユーザーのプロファイルデータを外部データベースのAPIに送信する。
* ユーザー作成の操作に失敗した場合には、エラーを返す。

### 定義

`create`関数は2つのパラメーターを受け取り、`callback`関数を返します。





### 例

これは疑似JavaScriptを使った例で、どのようにすれば`create`関数を実装できるかがわかります。言語固有の例については、「[言語固有のスクリプトの例](#language-specific-script-examples)」をお読みください。



### Encryption（暗号化）



`bcrypt`のような暗号学的ハッシュの暗号化ライブラリを使ってパスワード値を暗号化し、潜在的なデータ漏洩を防ぎます。

#### 例



## コールバック関数

`callback`関数は1つのパラメーターを受け取り、1つの関数を返します。

### 定義





### 成功の場合

ユーザー作成操作が成功した場合、`callback`関数を返し、`error`パラメーターには`null`値を渡します。

#### 例



### エラーの場合

エラーが発生した場合は、コールバック関数を返し、`error`パラメーターに関連するエラー情報を渡します。

#### ValidationErrorタイプのオブジェクト

`ValidationError`のカスタムエラータイプのオブジェクトを使うと、[テナントログ](/logs)で表示されるデータを渡すことができます。

##### コンストラクター

`ValidationError`コンストラクターは、最大2つのパラメーターを受け取ります。





#### ユーザーがすでに存在するというエラーを返す

`errorCode`パラメーターの値に`user_exists`を指定してエラーを返すと、Auth0は`fs`のテナントログイベントを記録します。

##### 例





## ユーザーオブジェクトパラメーター

`user`オブジェクトパラメーターには、ユーザー作成プロセスから取得した事前定義された一連のプロパティが含まれます。



### ユーザー名プロパティ

カスタムデータベース接続の[［Requires Username（ユーザー名を要求する）］](/require-username)設定が有効になっている場合は、[ログイン](/login)および[ユーザー取得](/get-user)スクリプトが`username`プロパティをサポートする必要があるため、ユーザー名プロパティを外部データベースに保存しなければなりません。

### ユーザーメタデータとアプリメタデータ

`user_metadata`と`app_metadata`のプロパティは、外部データベースに保存する必要はありません。これらの値は、内部で作成される[ユーザープロファイル](/not-found/3MdCE7aOAk34wCaR7Do709)レコードの一部として自動保存されます。

### カスタムサインアップフィールド

サインアップのプロセス中に[カスタムフィールドを作成して使用](/libraries/custom-signup#using-the-api)する場合、これらは`user`オブジェクトに含まれます。

### 例



## 言語固有のスクリプトの例

Auth0は、以下の言語や技術で使用できるサンプルスクリプトを提供しています。

* [JavaScript](#javascript)
* [ASP.NET Membership Provider（MVC3 - Universal Providers）](#asp-net-membership-provider-mvc3-universal-providers-)
* [ASP.NET Membership Provider（MVC4 - Universal Providers）](#asp-net-membership-provider-mvc4-simple-membership-)
* [MongoDB](#mongodb)
* [MySQL](#mysql)
* [PostgreSQL](#postgresql)
* [SQL Server](#sql-server)
* [Windows Azure SQL Database](#windows-azure-sql-database)
* [Basic認証での要求](#request-with-basic-auth)

### JavaScript



### ASP.NET Membership Provider（MVC3 - Universal Providers）



### ASP.NET Membership Provider（MVC4 - Simple Membership）



### MongoDB



### MySQL



### PostgreSQL



### SQL Server



### Windows Azure SQL Database



### Basic認証での要求



## トラブルシューティング

レガシーデータベースかAuth0のいずれかでユーザーを作成できない場合は、以下を行います。

1. Auth0の[Real-time Webtask Logs拡張機能](/extensions/real-time-webtask-logs)で`console.log()`のステートメントを確認します。
2. レガシーデータベースでユーザーを探し、適宜削除します。ユーザーの状態の一部がAuth0にある場合は、Management APIの[ユーザー削除](https://auth0.com/docs/api/management/v2#!/Users/delete_users_by_id)エンドポイントまたは[接続ユーザー削除](/api/management/v2#!/Connections/delete_users_by_email)エンドポイントを使用します。
3. **［Import Mode（インポートモード）］**が無効になっていることを確認してから、作成スクリプトを構成します。