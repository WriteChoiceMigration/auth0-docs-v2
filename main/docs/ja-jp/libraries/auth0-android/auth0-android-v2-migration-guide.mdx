---
description: ''
og:description: Learn how to migrate your Aut0 Android v1 apps to version 2 of the
  SDK
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: Auth0 Android v2の移行ガイド
og:url: https://auth0.com/docs/
permalink: auth0-android-v2-migration-guide
title: Auth0 Android v2の移行ガイド
twitter:description: Learn how to migrate your Aut0 Android v1 apps to version 2 of
  the SDK
twitter:title: Auth0 Android v2の移行ガイド
---

Auth0 Android SDKバージョン2には、Auth0をAndroidアプリに統合するための改善が数多く含まれています。**このアップグレードには互換性のない変更が含まれています。**v2に移行する際には、このガイドを読んで、変更内容を理解してください。

## Requirements changes

v2にはAndroid APIバージョン21以降とJava 8以降が必要です。

AndroidとKotlinの各プラグインでJava 8のバイトコードをターゲットにするために、`build.gradle`には以下が必要です。

```kotlin lines
android {
  compileOptions {
      sourceCompatibility JavaVersion.VERSION_1_8
      targetCompatibility JavaVersion.VERSION_1_8
  }

  kotlinOptions {
      jvmTarget = '1.8'
  }
}
```

## Open ID Connect only

v2はOIDC準拠のアプリケーションにのみ対応しています。このSDKでユーザーを認証する際には、Auth0が現在提供している認証パイプラインとエンドポイントだけが使用されます。`setOIDCConformant(boolean value)`メソッドは`Auth0`クラスから削除されました。

Learn more about the [OpenID Connect Protocol](/docs/authenticate/protocols/openid-connect-protocol).

## Authorization Code with PKCE

v2 only supports the [Authorization Code with Proof Key for Code Exchange (PKCE)](/docs/get-started/authentication-and-authorization-flow/authorization-code-flow-with-pkce) flow. We removed the `withResponseType(@ResponseType int type)` method on `WebAuthProvider.Builder`.

## Removal of WebView support

[]()レガシー認証API対応の削除

## Removal of legacy authentication API support

We removed methods and classes specific to calling any [authentication APIs](https://auth0.com/docs/api/authentication) categorized as Legacy. []()ロギング構成

## Request interfaces changes

`ParameterizableRequest`や`TokenRequest`、`DatabaseConnectionRequest`を返すメソッドはすべて、`Request`を返すように変更されました。

`public fun addParameter(name: String, value: String): Request<T, U>`

* `ParameterizableRequest`や`TokenRequest`、`DatabaseConnectionRequest`を返すメソッドはすべて、`Request`を返すように変更されました。
* 以下のインターフェイスは削除されました。
* `ParameterizableRequest`や`TokenRequest`、`DatabaseConnectionRequest`を返すメソッドはすべて、`Request`を返すように変更されました。

`AuthRequest`を返すメソッドはすべて、`AuthenticationRequest`を返すように変更されました。

* `ParameterizableRequest`や`TokenRequest`、`DatabaseConnectionRequest`を返すメソッドはすべて、`Request`を返すように変更されました。
* `AuthRequest`を返すメソッドはすべて、`AuthenticationRequest`を返すように変更されました。

`AuthenticationAPIClient` contains many changes to the return type of methods as a result. These are some examples:

* これらのメソッドの戻り値のタイプを直接使用している場合には、上記のタイプが予期されるようにコードを変更する必要があります。要求を行うのに`start`や`execute`を連鎖的に呼び出している場合には、変更する必要はありません。

* 完全なリストについては、以下の「**削除されたクラスおよびインターフェイス**」セクションを参照してください。

[]()ネットワーククライアントのカスタマイズ

The `AuthenticationRequest` interface no longer has a `setAccessToken("{ACCESS-TOKEN}")` method. This method was for setting the token to the request made to the [/oauth/access\_token](https://auth0.com/docs/api/authentication#social-with-provider-s-access-token) Authentication API legacy endpoint, disabled as of June 2017. If you need to send a parameter with this name, please use `addParameter("access_token", "{ACCESS-TOKEN}")`.

[]()タイムアウト構成

[]()ロギング構成

## Networking client customization

[]()パッケージを変更したファイル

### Timeout configuration

```kotlin lines
// Before
val account = Auth0("{YOUR_CLIENT_ID}", "{YOUR_DOMAIN}")

account.connectTimeoutInSeconds = 30
account.readTimeoutInSeconds = 30

val authAPI = AuthenticationAPIClient(account)

// After
val netClient = DefaultClient(
    connectTimeout = 30,
    readTimeout = 30
)

val account = Auth0("{YOUR_CLIENT_ID}", "{YOUR_DOMAIN}")
account.networkingClient = netClient
```

### Logging configuration

```kotlin lines
// Before
val account = Auth0("{YOUR_CLIENT_ID}", "{YOUR_DOMAIN}")
account.isLoggingEnabled = true

val authAPI = AuthenticationAPIClent(account)

// After
val netClient = DefaultClient(
    enableLogging = true
)

val account = Auth0("{YOUR_CLIENT_ID}", "{YOUR_DOMAIN}")
account.networkingClient = netClient
```

## Detailed change listing

### Files that changed their package

* We moved the `com.auth0.android.authentication.request.ProfileRequest` class to `com.auth0.android.request.ProfileRequest`.
* We moved the `com.auth0.android.authentication.request.SignUpRequest` class to `com.auth0.android.request.SignUpRequest`.

### Internal package

`com.auth0.android.request.ParameterizableRequest`インターフェイスは削除されました。要求のヘッダーとパラメーターを追加する機能は`com.auth0.android.request.Request`インターフェイスに移動されました。

`com.auth0.android.request.AuthRequest`インターフェイスは削除されました。`com.auth0.android.request.AuthenticationRequest`インターフェイスを使用してください。

### Classes and interfaces removed

* `com.auth0.android.result.Delegation`クラスは削除されました。これは、Authentication APIのレガシーエンドポイントに対する要求の結果として使用されていましたが、2017年6月に無効化されています。
* `com.auth0.android.authentication.request.DelegationRequest`クラスは削除されました。これは、レガシーのAuthentication APIエンドポイントに対する要求を表すのに使用されていましたが、2017年6月に無効化されています。
* `com.auth0.android.util.Telemetry`クラスは名前が`com.auth0.android.util.Auth0UserAgent`に変更されました。
* `com.auth0.android.request.AuthorizableRequest`クラスは削除されました。同じ結果は`addHeader("Authorization", "Bearer {TOKEN_VALUE}")`を使用して得ることができます。
* `com.auth0.android.authentication.request.TokenRequest`クラスは削除されました。コード検証と、要求のあらゆるヘッダーとパラメーターを設定する機能は、`com.auth0.android.request.Request`インターフェイスに移動されました。
* `com.auth0.android.authentication.request.DatabaseConnectionRequest`クラスは削除されました。要求のあらゆるヘッダーとパラメーターを設定する機能は、`com.auth0.android.request.Request`インターフェイスに移動されました。
* `com.auth0.android.provider.VoidCallback`クラスは削除されました。引数を受け付けないコールバックを使用する機能は、`Callback<Void, AuthenticationException>`に置き換えられました。
* `com.auth0.android.request.ErrorBuilder`インターフェイスは削除されました。
* `com.auth0.android.RequestBodyBuildException`クラスは削除されました。
* `com.auth0.android.util.CheckHelper`クラスは削除されました。
* `com.auth0.android.util.JsonRequired`インターフェイスは削除されました。
* `com.auth0.android.util.JsonRequiredTypeAdapterFactory`クラスは削除されました。
* []()削除された定数
* `ParameterBuilder.GRANT_TYPE_JWT`は削除されました。
* `ParameterBuilder.ID_TOKEN_KEY`は削除されました。
* `ParameterBuilder.DEVICE_KEY`は削除されました。

### Constants removed

* `ResponseType.CODE`、`ResponseType.ID_TOKEN`、および`ResponseType.ACCESS_TOKEN`は削除されました。
* []()変更されたクラスおよびインターフェイス
* 今後は`SignupRequest`が`AuthenticationRequest`を実装します。`AuthRequest`は削除されました。
* 今後は`AuthorizableRequest`が`Request`を拡張します。`ParameterizableRequest`は削除されました。
* `ResponseType.CODE`, `ResponseType.ID_TOKEN`, and `ResponseType.ACCESS_TOKEN` have been removed.

### Classes and Interfaces changed

* `AuthenticationAPIClient`は`Context`から構築できなくなりました。`AuthenticationAPIClient(auth0:Auth0)`を使用してください。`Auth0`のインスタンスは`Context`を使って作成できます。
* `UsersAPIClient`は`Context`から構築できなくなりました。`UsersAPIClient(auth0:Auth0, token:String)`を使用してください。`Auth0`のインスタンスは`Context`を使って作成できます。
* 今後、`SignupRequest`には第二パラメーターに`AuthenticationRequest`が必要になります。

### Constructors changed

* `Credentials`が「expires in」値で構築できなくなりました。使用期限日または「expires at」値を指定してください。通常、`Credentials`を独自に構築することはありません。
* []()削除または変更されたメソッド
* []()削除された`Auth0`のメソッド
* `setOIDCConformant(boolean enabled)`と`isOIDCConformant()`は削除されました。SDKは現在OIDC準拠のアプリケーションにのみ対応しています。
* `doNotSendTelemetry()`は削除されました。取って代わるものはありません。

### Methods removed or changed

#### Auth0 methods removed

* `setConnectTimeoutInSeconds(seconds)`と`getConnectTimeoutInSeconds(seconds)`は削除されました。接続タイムアウトは`DefaultClient`クラスで直接カスタマイズできます。`DefaultClient(connectTimeout = 123)`を使用してください。
* `setLoggingEnabled(boolean enabled)`と`isLoggingEnabled()`は削除されました。ネットワークトラフィックロガーは`DefaultClient`クラスで直接有効化できます。`DefaultClient(enableLogging = true)`を使用してください。デバッグのために使用し、決して運用環境で有効化してはいけません。
* `setTLS12Enforced()`と`isTLS12Enforced()`は削除されました。現在、SDKはデフォルトでmodern TLSに対応します。
* []()削除または変更された`AuthenticationAPIClient`のメソッド
* `setUserAgent(String)`は削除されました。ヘッダーは、`addHeader("{NAME}", "{VALUE}")`メソッドを使ってそれぞれの要求インスタンスで直接送信するか、`DefaultClient(defaultHeaders = mapOf())`コンストラクターパラメーターを通して、ネットワーククライアントのインスタンスにグローバルに送信するように設定できます。
* レガシーとして分類された[Authentication API]()を呼び出すためのメソッドとクラスは、v2で削除されました。以下のメソッドが削除されています。
* `delegation()`、`delegationWithIdToken("{ID-TOKEN}")`、`delegationWithRefreshToken("{REFRESH-TOKEN}")`、および`delegationWithIdToken("{ID-TOKEN}", "{API-TYPE}}")`。レガシーのAuthentication APIエンドポイントへの対応は削除されました。

#### AuthenticationAPIClient methods removed or changed

* すべての要求メソッドが小文字になりました（`POST()` -> `post()`など）。

Methods and classes specific to calling any [Authentication APIs](https://auth0.com/docs/api/authentication) categorized as Legacy have been removed in v2. We removed these methods:

* `login("{USERNAME-OR-EMAIL}", "{PASSWORD}", "{REALM-OR-CONNECTION}")`
* `login("{USERNAME-OR-EMAIL}", "{PASSWORD}")`
* `token("{AUTHORIZATION-CODE}", "{CODE-VERIFIER}", "{REDIRECT-URI}")`

`authenticationPOST`メソッドは代替を提供することなく削除されました。これは、すべての`Request`インスタンスが必要に応じて、ヘッダーを使ってパラメーター化できるためです。

* `loginWithPhoneNumber("{PHONE-NUMBER}", "{VERIFICATION-CODE}", "{REALM-OR-CONNECTION}")`
* `login("{USERNAME-OR-EMAIL}", "{PASSWORD}", "{REALM-OR-CONNECTION}")`
* `login("{USERNAME-OR-EMAIL}", "{PASSWORD}")`
* `token("{AUTHORIZATION-CODE}", "{CODE-VERIFIER}", "{REDIRECT-URI}")`
* []()削除された`AuthenticationRequest`のメソッド
* `loginWithPhoneNumber("{PHONE-NUMBER}", "{VERIFICATION-CODE}", "{REALM-OR-CONNECTION}")`

`setDevice("{DEVICE}")`。`addParameter("device", "{VALUE}")`を使用してください。

* `useCodeGrant(boolean useCodeGrant)`。取って代わるものはありません。v2はPKCEを使用したコードフローにのみ対応します。
* `useBrowser(boolean useBrowser)`。取って代わるものはありません。このライブラリーはWebView認証に非対応になりました。
* `token("{AUTHORIZATION-CODE}", "{CODE-VERIFIER}", "{REDIRECT-URI}")`
* []()削除された`AuthenticationRequest`のメソッド
* `addAuthenticationParameters(parameters)`は削除されました。`addParameters(parameters)`を使用してください。
* `setDevice("{DEVICE}")`。`addParameter("device", "{VALUE}")`を使用してください。

[]()削除された`WebAuthProvider.Builder`のメソッド

* `useCodeGrant(boolean useCodeGrant)`。取って代わるものはありません。v2はPKCEを使用したコードフローにのみ対応します。
* `useBrowser(boolean useBrowser)`。取って代わるものはありません。このライブラリーはWebView認証に非対応になりました。

`useFullscreen(boolean useFullscreen)`。取って代わるものはありません。このライブラリーはWebView認証に非対応になりました。

* `withResponseType(@ResponseType int type)`。取って代わるものはありません。v2はPKCEを使用したコードフローにのみ対応します。

#### AuthenticationRequest methods removed

* []()削除された`WebAuthProvider.LogoutBuilder`のメソッド
* `start(context: Context, callback: VoidCallback)`。`start(context: Context, callback: Callback<Void, AuthenticationException>)`を使用してください。

#### WebAuthProvider.Builder methods removed

* `init(account: Auth0)`は削除されました。`login(account: Auth0)`を使用してください。
* `init(context: Context)`は削除されました。`login(account: Auth0)`を使用してください。
* `resume(requestCode: Int, resultCode: Int, intent: Intent)`は削除されました。`resume(intent: Intent)`を使用してください。
* `init(account: Auth0)`は削除されました。`login(account: Auth0)`を使用してください。
* []()削除された`ParameterBuilder`のメソッド

#### WebAuthProvider.LogoutBuilder methods removed

* []()変更された`UsersAPIClient`のメソッド

#### WebAuthProvider methods removed

* 今後、パラメーターを設定するメソッドには値として、文字列からオブジェクトへのマッピングではなく、文字列から文字列へのマッピングが必要です。
* 今後、`addParameters`メソッドには値として、文字列からオブジェクトへのマッピングではなく、文字列から文字列へのマッピング（`addParameters(mapOf("key" to "val"))`）が必要です。
* []()変更された`SignUpRequest`のメソッド
* 今後、パラメーターを設定するメソッドには値として、文字列からオブジェクトへのマッピングではなく、文字列から文字列へのマッピングが必要です。

#### ParameterBuilder methods removed

* すべての要求メソッドは、特定のHTTP要求ライブラリー（`OkHttp`など）から分離されるようにリファクタリングされています。

#### UsersAPIClient methods changed

* すべての要求メソッドが小文字になりました（`POST()` -> `post()`など）。

`authenticationPOST`メソッドは代替を提供することなく削除されました。これは、すべての`Request`インスタンスが必要に応じて、ヘッダーを使ってパラメーター化できるためです。

* []()変更された`ProfileRequest`のメソッド
* 今後、`addParameters`メソッドには値として、文字列からオブジェクトへのマッピングではなく、文字列から文字列へのマッピング（`addParameters(mapOf("key" to "val"))`）が必要です。
* []()変更された`SignUpRequest`のメソッド
* 今後、パラメーターを設定するメソッドには値として、文字列からオブジェクトへのマッピングではなく、文字列から文字列へのマッピングが必要です。

#### RequestFactory methods removed or changed

`addSignupParameters(mapOf("key" to "val"))`

* `addParameters(mapOf("key" to "val"))`
* また、`setDevice("device")`も削除されました。`addParameter("device", "{VALUE}")`を使用してください。
* All request methods are now lowercase (for example, `POST()` -> `post()`).
* The `authenticationPOST` method was removed without a replacement, as all `Request` instances can be parameterized with any headers as needed.

#### ProfileRequest methods changed

* The `addParameters` method now requires the value to be Map of String to String, instead of String to Object (`addParameters(mapOf("key" to "val"))`)

#### SignUpRequest methods changed

Methods that set parameters now require the value to be a Map of String to String, instead of String to Object:

* `addAuthenticationParameters(mapOf("key" to "val"))`
* `addSignupParameters(mapOf("key" to "val"))`
* `addParameters(mapOf("key" to "val"))`

Additionally, `setDevice("device")` was removed. Use `addParameter("device", "{VALUE}")` instead.