---
description: ''
og:description: Describes the Auth0 SDK for React Single Page Apps
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: シングルページアプリ用Auth0 React SDK
og:url: https://auth0.com/docs/
permalink: auth0-react
title: シングルページアプリ用Auth0 React SDK
twitter:description: Describes the Auth0 SDK for React Single Page Apps
twitter:title: シングルページアプリ用Auth0 React SDK
---

Auth0 React SDK（auth0-react.js）は、Auth0を使用してReactアプリケーションで認証と認可を実装するためのJavaScriptライブラリです。カスタムReactフックとその他の高階コンポーネントを提供し、ベストプラクティスに従ってReactアプリをセキュリティ保護しながら、同時にコードの量を減らすことができます。

The Auth0 React SDK handles grant and protocol details, token expiration and renewal, as well as token storage and caching. Under the hood, it implements [Universal Login](/docs/authenticate/login/auth0-universal-login) and the [Authorization Code Grant Flow with PKCE](/docs/get-started/authentication-and-authorization-flow/authorization-code-flow-with-pkce).

The library is [hosted on GitHub](https://github.com/auth0/auth0-react) where you can [read more about the API](https://auth0.github.io/auth0-react/).

## インストール

プロジェクトでauth0-react.jsを使用するには、いくつかのオプションがあります。

* From [npm](https://npmjs.org/):

  `npm install @auth0/auth0-react`
* From [yarn](https://yarnpkg.com/):
  `yarn add @auth0/auth0-react`

## 開始

まず、アプリケーションを1つの`Auth0Provider`コンポーネントでラップする必要があります。これにより、アプリケーションの内部に配置されたコンポーネントにReactのコンテキストが提供されます。

```js lines
import React from 'react';
    import ReactDOM from 'react-dom';
    import { Auth0Provider } from '@auth0/auth0-react';
    import App from './App';
    ReactDOM.render(
      <Auth0Provider
        domain="{yourDomain}"
        clientId="{yourClientId}"
        authorizationParams={{
          redirect_uri: window.location.origin
        }}
    >
      <App />
    </Auth0Provider>,
    document.getElementById('app')
 );
```

## isLoadingとerror

SDKが初期化するのを待ってから、`isLoading`状態と`error`状態ですべてのエラーを処理します。

```js lines
import React from 'react';
import { useAuth0 } from '@auth0/auth0-react';
function Wrapper({ children }) {
  const {
    isLoading,
    error,
  } = useAuth0();
  if (isLoading) {
    return <div>Loading...</div>;
  }
  if (error) {
    return <div>Oops... {error.message}</div>;
  }
  return <>{children}</>;
}
export default Wrapper;
```

## ログイン

ログアウト

```js lines
import React from 'react';
import { useAuth0 } from '@auth0/auth0-react';

function LoginButton() {
  const {
    isAuthenticated,
    loginWithRedirect,
  } = useAuth0();

  return !isAuthenticated && (
    <button onClick={loginWithRedirect}>Log in</button>
  );
}

export default LoginButton;
```

## ［User（ユーザー）］

Use `logout` to log your users out. Make sure `returnTo` is specified in "Allowed ［User（ユーザー）］ URLs" in your <Tooltip tip="Auth0 Dashboard: Auth0's main product to configure your services." cta="View Glossary" href="/docs/glossary?term=Auth0+Dashboard">Auth0 Dashboard</Tooltip>.

```js lines
import React from 'react';
import { useAuth0 } from '@auth0/auth0-react';

function LogoutButton() {
  const {
    isAuthenticated,
    logout,
  } = useAuth0();

  return isAuthenticated && (
    <button onClick={() => {
      logout({ 
        logoutParams: {
          returnTo: window.location.origin
        }
      });
    }}>Log out</button>
  );
}

export default LogoutButton;
```

## フックの代わりに`withAuth0`高階コンポーネントを使用して、`auth0`プロパティをクラスコンポーネントに追加します。

ルートを保護する

```js lines
import React from 'react';
import { useAuth0 } from '@auth0/auth0-react';

function Profile() {
  const { user } = useAuth0();

  return <div>Hello {user.name}</div>;
}

export default Profile;
```

## **注** カスタムルーターを使用している場合、`Auth0Provider`にカスタムの`onRedirectCallback`メソッドを提供して、ユーザーを保護されたページに戻すアクションを実行する必要があります。[react-router]()、[Gatsby]()、および[Next.js]()の例を参照してください。

APIを呼び出す

```jsx lines
import React, { Component } from 'react';
import { withAuth0 } from '@auth0/auth0-react';

class Profile extends Component {
  render() {
    const { user } = this.props.auth0;
    return <div>Hello {user.name}</div>;
  }
}

export default withAuth0(Profile);
```

## アクセストークンを使用して保護されたAPIを呼び出すには、`Auth0Provider`または`getAccessTokenSilently`のいずれかで、必ず[アクセストークン](/security/tokens/access-tokens/get-access-tokens)の`audience`および`scope`を指定してください。その後、これを要求の`Authorization`ヘッダーに渡して、保護されたAPIを呼び出します。

アクセストークンを使用して保護されたAPIを呼び出すには、`Auth0Provider`または`getAccessTokenSilently`のいずれかで、必ず[アクセストークン](/security/tokens/access-tokens/get-access-tokens)の`audience`および`scope`を指定してください。その後、これを要求の`Authorization`ヘッダーに渡して、保護されたAPIを呼び出します。 component using the `withAuthenticationRequired` higher order component. Visits to this route when unauthenticated will redirect the user to the login page and back to this page after login.

```js lines
import React from 'react';
import { withAuthenticationRequired } from '@auth0/auth0-react';

const PrivateRoute = () => (<div>Private</div>);

export default withAuthenticationRequired(PrivateRoute, {
  // Show a message while the user waits to be redirected to the login page.
  onRedirecting: () => (<div>Redirecting you to the login page...</div>)
});
```

**Note** If you are using a custom router, you will need to supply the `Auth0Provider` with a custom `onRedirectCallback` method to perform the action that returns the user to the protected page. See examples for [react-router](https://github.com/auth0/auth0-react/blob/master/EXAMPLES.md#1-protecting-a-route-in-a-react-router-dom-app), [Gatsby](https://github.com/auth0/auth0-react/blob/master/EXAMPLES.md#2-protecting-a-route-in-a-gatsby-app) and [Next.js](https://github.com/auth0/auth0-react/blob/master/EXAMPLES.md#3-protecting-a-route-in-a-nextjs-app-in-spa-mode).

## Call an API

To call a protected API with an <Tooltip tip="Access Token: Authorization credential, in the form of an opaque string or JWT, used to access an API." cta="View Glossary" href="/docs/glossary?term=Access+Token">Access Token</Tooltip>, be sure to specify the `audience` and `scope` of your [access token](/docs/secure/tokens/access-tokens/get-access-tokens), either in `Auth0Provider` or `getAccessTokenSilently`. Then use it to call a protected API by passing it in the `Authorization` header of your request.

```jsx lines expandable
import React, { useEffect, useState } from 'react';
import { useAuth0 } from '@auth0/auth0-react';

const Posts = () => {
  const { getAccessTokenSilently } = useAuth0();
  const [posts, setPosts] = useState(null);

  useEffect(() => {
    (async () => {
      try {
        const token = await getAccessTokenSilently({
          authorizationParams: {
            audience: 'https://api.example.com/', // Value in Identifier field for the API being called.
            scope: 'read:posts', // Scope that exists for the API being called. You can create these through the Auth0 Management API or through the Auth0 Dashboard in the Permissions view of your API.
          }
        });
        const response = await fetch('https://api.example.com/posts', {
          headers: {
            Authorization: `Bearer ${token}`,
          },
        });
        setPosts(await response.json());
      } catch (e) {
        console.error(e);
      }
    })();
  }, [getAccessTokenSilently]);

  if (!posts) {
    return <div>Loading...</div>;
  }

  return (
    <ul>
      {posts.map((post, index) => {
        return <li key={index}>{post}</li>;
      })}
    </ul>
  );
};

export default Posts;
```