---
description: ''
og:description: Lock.Android - Native Social Authentication
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: Lock.Android:ネイティブのソーシャル認証
og:url: https://auth0.com/docs/
permalink: lock-android-native-social-authentication
title: Lock.Android:ネイティブのソーシャル認証
twitter:description: Lock.Android - Native Social Authentication
twitter:title: Lock.Android:ネイティブのソーシャル認証
---

## ネイティブプロバイダー - Google

**Lock**を使用してもしなくても、Google AuthProviderを利用してログインできます。[セットアップ](#setup)セクションの指示に従ってください。

[Lock-Google.Android](https://github.com/auth0/Lock-Google.Android)
requires Android API 15 or later & Google Play Services 10.+

### Android API 15以降とGoogle Play開発者サービス10以降が必要です。

The Lock-Google is available through [Maven Central](http://search.maven.org) and [JCenter](https://bintray.com/bintray/jcenter). To install it, simply add the following line to your `build.gradle`:

`compile 'com.auth0.android:lock-google:1.+'`

You can check for the latest version on the repository [Readme](https://github.com/auth0/Lock-Google.Android#install), in [Maven](http://search.maven.org/#search%7Cga%7C1%7Ca%3A%22lock-google%22%20g%3A%22com.auth0.android%22), or in [JCenter](https://bintray.com/auth0/android/lock-google).

### Lock-Googleの設定

#### Google開発者コンソール

1. Go to the [Google Developers Console](https://console.developers.google.com/) and create a new Project.
2. Complete the [OAuth Consent Screen](https://console.developers.google.com/apis/credentials/consent) by at least providing a valid Email Address and Name.
3. On the left side you have the navigation drawer, click [Credentials](https://console.developers.google.com/apis/credentials).
4. Create a new credential by clicking the [Create Credentials](https://console.developers.google.com/apis/credentials/oauthclient) button and choosing **OAuth client ID**. Next, choose **Web Application** and give it a name like "Auth0 Server Google-OAuth". Complete the **Authorized redirect URIs** by filling the field with your callback URL, which should look like `https://{yourDomain}/login/callback`. Make sure to press ENTER before leaving the field and then click the Create button. Take note of the `CLIENT ID` and `CLIENT SECRET` values as we're going to use them later.
5. Create a new credential by clicking the [Create Credentials](https://console.developers.google.com/apis/credentials/oauthclient) button and choosing **OAuth client ID**. Next, choose **Android** and give it a name like "Auth0 Android Google-OAuth". Obtain the **SHA-1** of the certificate you're using to sign your application and complete the first field with it. If you need help obtaining the SHA-1 check [this](#certificate-fingerprints) section. Finally, complete the last field with your android application **Package Name** and then click the Create button. Take note of the `CLIENT ID` value as we're going to use it later.

#### Auth0 Dashboard

1. Go to the Auth0 Dashboard and click [Social Connections](https://manage.auth0.com/#/connections/social).
2. Click **Google** and a dialog will prompt.
3. Complete the "Client ID" field with the `CLIENT ID` value obtained in the step 4 of the **Google Developers Console** section above.
4. Complete the "Client Secret" field with the `CLIENT SECRET` value obtained in the step 4 of the **Google Developers Console** section above.
5. Complete the "Allowed Mobile Client IDs" field with the `CLIENT ID` obtained in the step 5 of the **Google Developers Console** section above.
6. Click the Save button.
7. Go to the Auth0 Dashboard and click [Applications](https://manage.auth0.com/#/applications). If you haven't created yet one, do that first and get into your application configuration page.
8. At the bottom of the page, click the "Show Advanced Settings" link and go to the "Device Settings" tab.
9. In the Android section, complete the **Package Name** with your application's package name. Finally, complete the **Key Hashes** field with the SHA-256 of the certificate you're using to sign your application. If you need help obtaining the SHA-256 check [this](#certificate-fingerprints) section. Click the "Save Changes" button.

#### Lockを使用しない場合

1. In your android application, create a new String resource in the `res/strings.xml` file. Name it `google_server_client_id` and set as value the `CLIENT_ID` obtained in the step 5 of the **Google Developers Console** setup section above.
2. Add the Google Play Services version MetaData to the `AndroidManifest.xml` file, inside the Application tag.

   ```xml lines
   <meta-data
       android:name="com.google.android.gms.version"
       android:value="@integer/google_play_services_version" />
   ```
3. Add the Internet Android permission to your `AndroidManifest.xml` file.

   ```xml lines
   <uses-permission android:name="android.permission.INTERNET" />
   ```
4. When creating a new instance of the `GoogleAuthProvider` pass the `google_server_client_id` value obtained previously as the first parameter:

   ```kotlin lines
   public class MainActivity extends AppCompatActivity {
     private GoogleAuthProvider provider;
     // ...

     @Override
     protected void onCreate(Bundle savedInstanceState) {
       Auth0 auth0 = new Auth0(getString(R.string.com_auth0_client_id), getString(R.string.com_auth0_domain));
       auth0.setOIDCConformant(true);
       AuthenticationAPIClient client = new AuthenticationAPIClient(auth0);
       provider = new GoogleAuthProvider(getString(R.string.google_server_client_id), client);
     }

     // ...
   }
   ```

If you need further help with the Google SDK setup, please check Google's [Sign-In for Android Guide](https://developers.google.com/identity/sign-in/android).

### これでアプリケーションを実行し、Facebookネイティブプロバイダーを使ってログインする準備ができました。

このプロバイダーを**Lock**なしで使用するつもりであれば、必ず`onActivityResult()`メソッドを上書きして、呼び出しをプロバイダーインスタンスにリダイレクトするようにしてください。最後に、「start」を呼び出して認証プロセスを開始します。

```kotlin lines
// Define your own request codes
private static final int RC_PERMISSIONS = 101;
private static final int RC_AUTHENTICATION = 102;

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    if (provider.authorize(requestCode, resultCode, data)) {
        return;
    }
    super.onActivityResult(requestCode, resultCode, data);
}

private void beginAuthentication(){
  provider.start(this, callback, RC_PERMISSIONS, RC_AUTHENTICATION);
}
```

これでアプリケーションを実行し、Googleネイティブプロバイダーを使ってログインする準備ができました。

### 追加オプション

#### 追加の認証パラメーターを送信する

Auth0に対してカスタムソーシャル接続名を使って認可するには、2番目のコンストラクターを使ってGoogleAuthProviderインスタンスを作成します。

```kotlin wrap lines
GoogleAuthProvider provider = new GoogleAuthProvider("my-connection", "google-server-client-id", client);
```

#### カスタムFacebook権限を要求する

デフォルトでは、`public_profile`権限が要求されます。カスタマイズするには、 `setPermissions`とFacebook権限のリストを呼び出します。

```kotlin lines
Map<String, Object> parameters = new HashMap<>();
//Add entries
provider.setParameters(parameters);
```

#### Googleカスタムスコープを要求する

デフォルトでは、`Scopes.PLUS_LOGIN`スコープが要求されます。スコープをカスタマイズするには、`setScopes`とスコープのリストを呼び出します。各Google API（Auth、Drive、Plus..）がそれぞれのGoogleスコープのリストを指定します。

```kotlin wrap lines
provider.setScopes(Arrays.asList(new Scope(Scopes.PLUS_ME), new Scope(Scopes.PLUS_LOGIN)));
```

#### Lockを使わない場合は、権限要求結果を自分で処理する必要があります。そのためには、アクティビティに`ActivityCompat.OnRequestPermissionsResultCallback`インターフェイスを実装させます。`onRequestPermissionsResult`メソッドが呼び出されたら、`provider.onRequestPermissionsResult`を呼び出して結果をプロバイダーに渡します。.

このプロバイダーは、ユーザーの認証に特別なAndroid Manifest権限を必要としません。しかし、ユースケースによってそれが必要な場合は、 AuthProviderにこれを処理させることができます。`setRequiredPermissions`メソッドを使います。

```kotlin wrap lines
provider.setRequiredPermissions(new String[]{"android.permission.GET_ACCOUNTS"});
```

ユーザーをログアウトさせて、次回資格情報の入力を求めるようにするには、`clearSession`を呼び出します。その後、プロバイダーの状態が無効になるため、結果を`認可`する前にもう一度`start`を呼び出す必要があります。`stop`を呼び出しても同じ効果があります。

#### 前回のログインを記憶する

デフォルトでは、このプロバイダーは前回のログインで使われたアカウントを記憶します。その動作を変更するには、以下の方法を使います。

`provider.clearSession();`

#### 前回のログインを記憶

Facebook開発者コンソールでOAuth資格情報を新たに作成する場合は、アプリケーションにサインする際に使う証明書のSHA-1を提供する必要があります。Auth0 Dashboardでアプリケーションの構成を完了する際は、SHA-256値も提供する必要があります。以下に、値を取得するためのターミナルコマンド例とその結果例を示します。

`provider.rememberLastLogin(false);`

#### SHA1：BB:0D:AC:74:D3:21:E1:43:07:71:9B:62:90:AF:A1:66:6E:44:5D:75

When creating a new <Tooltip tip="OAuth 2.0: Authorization framework that defines authorization protocols and workflows." cta="View Glossary" href="/docs/glossary?term=OAuth">OAuth</Tooltip> Credential in the Google開発者コンソール you will need to provide the SHA-1 of the certificate you're using to sign your application. When completing your Application's Configuration in the <Tooltip tip="Auth0 Dashboard: Auth0's main product to configure your services." cta="View Glossary" href="/docs/glossary?term=Auth0+Dashboard">Auth0 Dashboard</Tooltip> you will also need to provide the SHA-256 value. Here is an example of the terminal command to acquire the value, and a sample result.

Command:

`keytool -exportcert -alias androiddebugkey -keystore <PATH_TO_YOUR_KEYSTORE> -storepass android | openssl sha1 -binary | openssl base64`

ヘルプが必要な場合は、この[Keystores ガイド](/libraries/auth0-android/android-development-keystores-hashes)に従って、これらの値を取得してください。

`no71633JAC3qgzQYCbskprUr55k=`

If you need assistance, you can follow this [Keystores Guide](/docs/android-development-keystores-hashes) to acquire those values.

## FacebookAuthProviderを使って、**Lock**のあるなしにかかわらずログインすることができます。[セットアップ](#setup)セクションの指示に従ってください。

最新バージョン

[Lock-Facebook](https://github.com/auth0/Lock-Facebook.Android) requires Android API 15 or later & Facebook Android SDK 4.+

## Lock-Facebookは、[Maven Central]()および[JCenter]()から入手可能です。`build.gradle`に以下の行を追加するだけでインストールできます：

The Lock-Facebook is available through [Maven Central](http://search.maven.org) and [JCenter](https://bintray.com/bintray/jcenter). To install it, simply add the following line to your `build.gradle`:

`compile 'com.auth0.android:lock-facebook:3.+'`

You can check for the latest version on the repository [Readme](https://github.com/auth0/Lock-Facebook.Android#install), in [Maven](http://search.maven.org/#search%7Cga%7C1%7Ca%3A%22lock-facebook%22%20g%3A%22com.auth0.android%22), or in [JCenter](https://bintray.com/auth0/android/lock-facebook).

### Facebook SDKセットアップに関してヘルプが必要な場合は、Facebookの[Getting Started Guide（入門ガイド）]()を参照してください。

#### Androidアプリケーション

1. Go to the [Facebook Developers Console](https://developers.facebook.com/) and create a new App: Choose "Android" and give it a valid name. Click "Create new Facebook App ID".
2. Add your application's **Package Name** and the name of the **Activity class** where you're using the provider and click the Next button.
3. Add the **SHA-1** Base64 encoded Key Hashes of the certificates you're using to sign your application and click the Next button. If you need help obtaining the SHA-1 check [this](#certificate-fingerprints) section.
4. Finally, scroll to the top of the page and click the Skip Quickstart button to go to your Facebook app's page.
5. On the top of the page, you will find the `APP ID` and `APP SECRET` values. Save them as you're going to need them later.
6. On the left side you have the navigation drawer. Click Settings and then Basic. Turn ON the **Single Sign-On** switch and click the Save button.
7. Click Settings and then Advanced. Turn ON the **Native or desktop app?** switch.

#### Facebook SDKセットアップに関してヘルプが必要な場合は、Facebookの[Getting Started Guide（入門ガイド）]()を参照してください。

1. Go to the Auth0 Dashboard and click [Social Connections](https://manage.auth0.com/#/connections/social).
2. Click **Facebook** and a dialog will prompt.
3. Complete the "App ID" field with the `APP ID` value obtained in the step 5 of the **Facebook Developers Console** section above.
4. Complete the "App Secret" field with the `APP SECRET` value obtained in the step 5 of the **Facebook Developers Console** section above.
5. Click the Save button.
6. Go to the Auth0 Dashboard and click [Applications](https://manage.auth0.com/#/applications). If you haven't created yet one, do that first and get into your application configuration page.
7. At the bottom of the page, click the "Show Advanced Settings" link and go to the "Device Settings" tab.
8. In the Android section, complete the **Package Name** with your application's package name. Finally, complete the **Key Hashes** field with the SHA-256 of the certificate you're using to sign your application. If you need help obtaining the SHA-256 check [this](#certificate-fingerprints) section. Click the "Save Changes" button.

#### Lockを使用しない場合

1. In your android application, create a new String resource in the `res/strings.xml` file. Name it `facebook_app_id` and set as value the `APP ID` obtained in the step 5 of the **Facebook Developers Console** setup section above.
2. Add the `FacebookActivity` and `facebook_app_id` MetaData to the `AndroidManifest.xml` file, inside the Application tag.

   ```xml lines
   <activity
       android:name="com.facebook.FacebookActivity"
       android:configChanges="keyboard|keyboardHidden|screenLayout|screenSize|orientation"
       android:label="@string/app_name"/>
   <meta-data
       android:name="com.facebook.sdk.ApplicationId"
       android:value="@string/facebook_app_id" />
   ```
3. Add the Internet Android permission to your `AndroidManifest.xml` file.

   ```xml lines
   <uses-permission android:name="android.permission.INTERNET" />
   ```
4. Create a new instance of the `FacebookAuthProvider`.

   ```kotlin lines
   public class MainActivity extends AppCompatActivity {
     private FacebookAuthProvider provider;
     // ...

     @Override
     protected void onCreate(Bundle savedInstanceState) {
       super.onCreate(savedInstanceState);
       Auth0 auth0 = new Auth0(getString(R.string.com_auth0_client_id), getString(R.string.com_auth0_domain));
       auth0.setOIDCConformant(true);
       AuthenticationAPIClient client = new AuthenticationAPIClient(auth0);
       provider = new FacebookAuthProvider(client);
     }

     // ...
   }
   ```

If you need further help with the Facebook SDK setup, please check Facebook's [Getting Started Guide](https://developers.facebook.com/docs/android/getting-started).

### これでアプリケーションを実行し、Facebookネイティブプロバイダーを使ってログインする準備ができました。

追加オプション

```kotlin lines
// Define your own request codes
private static final int RC_PERMISSIONS = 101;
private static final int RC_AUTHENTICATION = 102;

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    if (provider.authorize(requestCode, resultCode, data)) {
        return;
    }
    super.onActivityResult(requestCode, resultCode, data);
}

private void beginAuthentication(){
  provider.start(this, callback, RC_PERMISSIONS, RC_AUTHENTICATION);
}
```

カスタム接続名を使う

### Auth0に対してカスタムソーシャル接続名を使って認可するには、新たな接続名を使って`setConnection`を呼び出します。

#### 追加の認証パラメーターを送信する

認証で追加のパラメーターを送信するには、`setParameters`を呼び出します。

```kotlin wrap lines
FacebookAuthProvider provider = new FacebookAuthProvider("my_connection_name", client);
```

#### カスタムFacebook権限を要求する

デフォルトでは、`public_profile`権限が要求されます。カスタマイズするには、 `setPermissions`とFacebook権限のリストを呼び出します。

```kotlin lines
Map<String, Object> parameters = new HashMap<>();
//Add entries
provider.setParameters(parameters);
```

#### Androidカスタムランタイム権限を要求する

このプロバイダーは、ユーザーの認証に特別なAndroid Manifest権限を必要としません。しかし、ユースケースによってそれが必要な場合は、 AuthProviderが処理できます。`setRequiredPermissions`メソッドを使ってそれらを指定します。

```kotlin wrap lines
provider.setPermissions(Arrays.asList("public_profile", "user_photos"));
```

#### Lockを使わない場合は、権限要求結果を自分で処理する必要があります。そのためには、アクティビティに`ActivityCompat.OnRequestPermissionsResultCallback`インターフェイスを実装させます。`onRequestPermissionsResult`メソッドが呼び出されたら、`provider.onRequestPermissionsResult`を呼び出して結果をプロバイダーに渡します。.

アカウントからログアウト/クリアします。

```kotlin wrap lines
provider.setRequiredPermissions(new String[]{"android.permission.GET_ACCOUNTS"});
```

ユーザーをログアウトさせて、次回資格情報の入力を求めるようにするには、`clearSession`を呼び出します。その後、プロバイダーの状態が無効になるため、結果を`認可`する前にもう一度`start`を呼び出す必要があります。`stop`を呼び出しても同じ効果があります。

#### 前回のログインを記憶する

デフォルトでは、このプロバイダーは前回のログインで使われたアカウントを記憶します。その動作を変更するには、以下の方法を使います。

`provider.clearSession();`

#### 証明書のフィンガープリント

Facebook開発者コンソールでOAuth資格情報を新たに作成する場合は、アプリケーションにサインする際に使う証明書のSHA-1を提供する必要があります。Auth0 Dashboardでアプリケーションの構成を完了する際は、SHA-256値も提供する必要があります。以下に、値を取得するためのターミナルコマンド例とその結果例を示します。

`provider.rememberLastLogin(false);`

### SHA1：BB:0D:AC:74:D3:21:E1:43:07:71:9B:62:90:AF:A1:66:6E:44:5D:75

SHA256:15:B9:F9:33:9F:E4:E3:68:C2:10:49:17:5D:A8:77:12:7C:8E:57:E9:FF:B7:23:EA:CC:DD:56:08:06:C9:5E:33

Command:

`keytool -exportcert -alias androiddebugkey -keystore <PATH_TO_YOUR_KEYSTORE> -storepass android | openssl sha1 -binary | openssl base64`

ヘルプが必要な場合は、この[Keystores ガイド](/libraries/auth0-android/android-development-keystores-hashes)に従って、これらの値を取得してください。

SHA1: BB:0D:AC:74:D3:21:E1:43:07:71:9B:62:90:AF:A1:66:6E:44:5D:75
SHA256: 15:B9:F9:33:9F:E4:E3:68:C2:10:49:17:5D:A8:77:12:7C:8E:57:E9:FF:B7:23:EA:CC:DD:56:08:06:C9:5E:33

If you need assistance, you can follow this [Keystores Guide](/docs/android-development-keystores-hashes) to acquire those values.