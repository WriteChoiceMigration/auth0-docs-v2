---
description: ''
og:description: Describes the Auth0 SDK for Angular Single Page Apps
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: シングルページアプリ用Auth0 Angular SDK
og:url: https://auth0.com/docs/
permalink: auth0-angular-spa
title: シングルページアプリ用Auth0 Angular SDK
twitter:description: Describes the Auth0 SDK for Angular Single Page Apps
twitter:title: シングルページアプリ用Auth0 Angular SDK
---

Auth0 Angular SDKは、Auth0を使用してAngularアプリケーションで認証と認可を実装するためのJavaScriptライブラリです。サービス、認証ガードとHTTPインターセプターを提供して、Angularアプリ内で一般的な認証タスクを処理できるようにします。

Auth0 Angular SDKは、付与とプロトコルの詳細、トークンの失効と更新、そして、トークンの保管とキャッシュをも処理します。内部では、[ユニバーサルログイン](/login/universal-login)と[PKCEを用いた認可コード付与フロー](/login/flows/authorization-code-flow-with-proof-key-for-code-exchange-pkce)を実装しています。

ライブラリは[GitHubで提供しており](https://github.com/auth0/auth0-angular)、[APIに関するさらなる詳細を読むことができます](https://auth0.github.io/auth0-angular/)。

## インストール



[Angular CLI](https://cli.angular.io/)を使用して、プロジェクトにSDKをインストールします：

`ng add @auth0/auth0-angular`

## 使用を開始する

SDKの統合を始めるには、プロジェクトに`AuthModule`をインポートし、Auth0クライアントアプリに構成します。



## ログイン

SDKはAngularの依存性注入システムに完全に対応しています。始めるには、`AuthService`タイプをコンポーネントにインポートして、コンストラクターに注入します。

そして、ユーザーログインを始めるために、サービスで`loginWithRedirect`または`loginWithPopup`メソッドを呼び出します。



## ログアウト

`logout`を使用して、ユーザーをログアウトさせます。Auth0 Dashboardの**［Allowed Logout URLs（許可されているログアウトURL）］**に`returnTo`が指定されていることを確認してください。



## 認証状態

認証状態は`isAuthenticated$`オブザーバブルを通して公開されます。



## ユーザープロファイル

認証されたユーザーのユーザープロファイルは`user$`オブザーバブルを通して公開されます。



このオブザーバブルは内部的に`isAuthenticated$`オブザーバブルと連鎖しているため、ユーザーがログインしたかを手動で確認する必要はありません。認証されたユーザーが使用可能になると、値を流し始めます。

## ルートの保護

経路コンポーネントは組み込みの`AuthGuard`を使用して保護します。認証されていない状態でこのルートにアクセスすると、ユーザーはログインページにリダイレクトされ、ログイン後にこのページに戻ってきます。

認証ガードは、`canActivate`フック（子経路を使用している場合には`canActivateChild`）を使って経路に追加する必要があります。



また、認証ガードは`canLoad`フックにも対応し、ユーザーの認証時にモジュールの遅延読み込みを防げるようになっています。

## APIを呼び出す

SDKには組み込みの`HttpInterceptor`が含まれています。これは、Angularの`HttpClient`サービスを使って要求が行われた際に`Authorization`ヘッダーを注入し、自動的にアクセストークンをアタッチします。

SDKを構成して、どのAPIへの経路に自動でこのヘッダーを追加するのかを指定し、予期されない受信者にアクセストークンが漏洩することを防がなければなりません。

### HTTPインターセプターをインポートする

まず、Auth0 HTTPインターセプターをアプリに統合するために必要なタイプをインポートします。



**注意：**インターセプターは他のインターセプターと連鎖するように設計されているため、アプリケーションモジュールに（自動で登録するのではなく）手動で登録する必要があります。自動で正しい場所に挿入される保証はありません。

### HTTPインターセプターを構成する

必要に応じて、各種の構成方法があります。経路の指定では、文字列を使用したり、送信されるトークンに影響するオプションをオブジェクトに含めて使用したりできます。また、使用するHTTP動詞によっては一致させることもできます。経路のURIにはワイルドカードを使用して、経路のグループを指定することもできます。

**注意：**HTTP呼び出しが行われ、構成に指定されている経路と一致しない場合には、インターセプターが迂回され、`Authorization`ヘッダーは含まれません。

下の例は、どの経路に`Authorization`ヘッダーを含めるべきかをSDKに指示する一般的な方法です。



**注意：**`tokenOptions`は、基礎となるSPA SDKで`getTokenSilently`メソッドに直接渡されます。受け付けられるプロパティの詳細については、[こちらのドキュメント](https://auth0.github.io/auth0-spa-js/interfaces/gettokensilentlyoptions.html)を参照してください。

### APIを呼び出す

Angularの`HttpClient`サービスを使用して、APIを呼び出します。構成と一致する経路については、アクセストークンが`Authorization`ヘッダーに自動的に含められます。



呼び出しサイトでトークンや他の認可待ち行列を提供するために、追加で必要なものは一切ありません。インターセプターとモジュール構成によって処理されます。