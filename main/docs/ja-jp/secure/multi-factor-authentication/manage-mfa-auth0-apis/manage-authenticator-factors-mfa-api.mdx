---
og:description: Describes how to manage MFA authenticator factor enrollments for applications
  using the Auth0 MFA API.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: 認証APIを使って認証要素を管理する
og:url: https://auth0.com/docs/
permalink: manage-authenticator-factors-mfa-api
title: 認証APIを使って認証要素を管理する
twitter:description: Describes how to manage MFA authenticator factor enrollments
  for applications using the Auth0 MFA API.
twitter:title: 認証APIを使って認証要素を管理する
---

Auth0は、アプリケーションでの多要素認証（MFA）に使用しているAuthenticatorの管理に役立つ、いくつかの[APIエンドポイント](/api/authentication#multi-factor-authentication)を提供しています。これらのエンドポイントを使うと、認証要素を管理するためのユーザーインターフェイスをビルドすることができます。

## MFA APIアクセストークンを取得する

MFA APIを呼び出して登録を管理するためには、まずMFA API用のアクセストークンを取得する必要があります。

MFA APIを認証フローの一環として使用するには、「[リソース所有者のパスワード付与とMFAで認証する](/mfa/ropg-mfa)」で説明されている手順に従ってください。認証要素を管理するためのユーザーインターフェイスをビルドする場合は、認証中だけでなく、いつでもMFA APIで使用できるトークンを取得する必要があります。

[ユニバーサルログインを](/login/universal-login)使用している場合は、MFA APIを呼び出す前に、`https://${account.namespace}/mfa/`オーディエンスを指定して認可エンドポイントへリダイレクトします。

### ユニバーサルログイン



リソース所有者のパスワード付与（ROPG）を使用している場合には、以下の3つのオプションがあります。

### リソース所有者のパスワード付与

MFAオーディエンスのトークンを要求する際、以下のスコープを要求できます。

* ログイン時に`https://${account.namespace}/mfa/`オーディエンスを要求し、[リフレッシュトークン](/security/tokens/refresh-tokens)を使用して後でリフレッシュします。
* Authenticatorをリストおよび削除する必要がある場合は、`https://${account.namespace}/mfa/`オーディエンスを指定して、`/oauth/token`で[再び認証](/mfa/ropg-mfa)することをユーザーに求めます。ユーザーは、MFAを完了しないと認証要素をリスト・削除できません。
* Authenticatorのリストのみを必要とする場合は、ユーザー名/パスワードで`/oauth/token`を使用して[再び認証](/mfa/ropg-mfa)することをユーザーに求めます。エンドポイントは、`mfa_required`エラー、およびAuthenticatorのリストに使用できる`mfa_token`を返します。ユーザーがAuthenticatorを確認するには、パスワードを提供する必要があります。

### スコープ



ユーザーのAuthenticatorのリストを取得するには、MFA Authenticatorエンドポイントを呼び出します。

## Authenticatorのリスト



応答にAuthenticatorの種類に関する情報が含まれています。



要素を管理するためのユーザーインターフェイスをエンドユーザー向けにビルドするときは、`active`が`false`のAuthenticatorを無視する必要があります。これらのAuthenticatorは、ユーザーによって確認されないため、MFAチャレンジには使用できません。

MFA APIは、Authenticatorの種類に応じて以下の登録をリストします。



Authenticatorを異なる要素で登録する方法については、以下のリンクを参照してください。

## Authenticatorを登録する

また、ユーザーを登録するためにいつでも[ユニバーサルログインフロー](/mfa/auth0-guardian/create-custom-enrollment-tickets)を使用できます。

* [SMSまたは音声](/mfa/ropg-mfa/enroll-challenge-sms-voice-authenticators)
* [ワンタイムパスワード（OTP）](/mfa/ropg-mfa/enroll-and-challenge-otp-authenticators)
* [プッシュ](/mfa/ropg-mfa/enroll-and-challenge-push-authenticators)
* [メールアドレス](/mfa/ropg-mfa/enroll-and-challenge-email-authenticators)

関連するAuthenticatorを削除するには、`AUTHENTICATOR_ID`を適切なAuthenticator IDに置き換えるMFA Authenticatorエンドポイントに`DELETE`要求を送信します。IDは、Authenticatorをリストした際に取得できます。

## Authenticatorを削除する

Authenticatorのリストのために`mfa_token`を使用した場合、Authenticatorを削除するために、[ユーザーは、MFAを完了させて](https://auth0.com/docs/ja-jp/api/authentication/muti-factor-authentication/verify-mfa-with-otp)、`https://${account.namespace}/mfa/`のオーディエンスのアクセストークンを取得する必要があります。



Authenticatorが削除されると、204応答が返されます。

Authenticatorを削除する際、Authenticatorの種類に応じて以下のアクションが実行されます。



復旧コードを削除して新たに生成するには、Auth0の[Management APIのアクセストークン](https://auth0.com/docs/api/management/v2/tokens)を取得し、Management APIの[復旧コード再生成エンドポイント](https://auth0.com/docs/api/management/v2/#!/Users/post_recovery_code_regeneration)を使用します。

## 復旧コードを再生成する



新しい復旧コードが生成され、エンドユーザーはそれをキャプチャする必要があります。例：