---
og:description: Describes how to build your own MFA flows using SMS or voice as an
  authentication factor.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: メールAuthenticatorの登録とチャレンジ
og:url: https://auth0.com/docs/
permalink: enroll-and-challenge-email-authenticators
title: メールAuthenticatorの登録とチャレンジ
twitter:description: Describes how to build your own MFA flows using SMS or voice
  as an authentication factor.
twitter:title: メールAuthenticatorの登録とチャレンジ
---



要素としてメールを有効にする場合、メールアドレスが検証されているユーザーは誰でもメールを使ってMFAを完了できます。





* Dashboardで、または[Management API](https://auth0.com/docs/api/management/v2#!/Guardian/put_factors_by_name)を使って要素として[メールを構成](/mfa/mfa-factors/configure-email-notifications-for-mfa)します。

## メールで登録する

ユーザーがプライマリIDで検証済みのメールアドレス以外にアドレスを追加登録できるようにするには、以下の手順を完了する必要があります。 

### Authenticatorを登録する



次のパラメーターを使用します：





成功すると、次のような応答を受け取ります：



「`User is already enrolled（ユーザーは登録済みです）`」というエラーメッセージを受け取った場合、そのユーザーはすでにMFA要素を登録済みです。このユーザーに対して別の要素を関連付ける前に、既存の要素を使ってユーザーにチャレンジする必要があります。



### メールアドレスの登録を確定する

ユーザーは、アプリケーションに提供するための6桁のコードが記載されたメールを受信します。

登録を完了するには、[**`/oath/token`**](https://auth0.com/docs/api/authentication#get-token)エンドポイントに`POST`要求を行います。メールに記載された値とともに、前の応答で返された`oob_code`と`binding_code`を入れます。



呼び出しが成功すると、アクセストークンを含む応答が以下のフォーマットで返されます。



この時点でAuthenticatorは完全に関連付けられ、利用可能な状態で、ユーザー用の認証トークンを取得します。

MFA Authenticatorエンドポイントを呼び出すことで、Authenticatorが確認されているかどうかをいつでも検証できます。Authenticatorが確認されている場合、`active`に返される値は`true`です。

ユーザーが受信するメールをカスタマイズするオプションもあります。詳細は、[「メールテンプレートをカスタマイズする」](/brand-and-customize/email/customize-email-templates)をお読みください。

## メールアドレスを使ってチャレンジする

### MFAトークンを取得する

[「リソース所有者のパスワード付与とMFAで認証する」](/mfa/ropg-mfa)で説明されている手順に従ってMFAトークンを取得します。

### 登録されているオーセンティケーターを取得する

ユーザーにチャレンジするには、チャレンジしたい要素の`authenticator_id`が必要です。登録された全Authenticatorの一覧は、MFA Authenticatorエンドポイントを使って表示できます：



### OTPを使ってユーザーにチャレンジする

メールチャレンジをトリガーするには、対応する`authenticator_id`と`mfa_token`を使ってMFAチャレンジエンドポイントへ`POST`を送ります。



### 受信したコードを使って認証を完了します。

成功すると以下の応答が届きます：



アプリケーションがユーザーに対してコード入力画面を表示し、`oauth``/token`エンドポイントへの以下の呼び出しの中で`binding_code`パラメーターの要求の一部として送信します。



呼び出しが成功すると、アクセストークンを含む応答が以下のフォーマットで返されます：