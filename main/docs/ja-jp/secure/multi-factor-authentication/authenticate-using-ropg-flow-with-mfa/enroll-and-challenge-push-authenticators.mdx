---
og:description: Describes how to build your own MFA flows using push as an authentication
  factor.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: プッシュAuthenticatorの登録とチャレンジ
og:url: https://auth0.com/docs/
permalink: enroll-and-challenge-push-authenticators
title: プッシュAuthenticatorの登録とチャレンジ
twitter:description: Describes how to build your own MFA flows using push as an authentication
  factor.
twitter:title: プッシュAuthenticatorの登録とチャレンジ
---



GuardianアプリケーションまたはMFA APIを用いたSDKを使用して、プッシュ通知でユーザーの登録とチャレンジを行うことができます。



* Dashboardまたは[Management API](https://auth0.com/docs/api/management/v2#!/Guardian/put_factors_by_name)を使って、要素として[プッシュを構成](/mfa/mfa-factors/configure-push-notifications-for-mfa)します。

## プッシュで登録する

### Authenticatorを登録する



プッシュで登録するには、`authenticator_types`パラメーターを`[oob]`、`oob_channels`パラメーターを`[auth0]`に設定します。



成功すると、次のような応答を受け取ります：



「`User is already enrolled（ユーザーは登録済みです）`」というエラーメッセージを受け取った場合、そのユーザーはすでにMFA要素を登録済みです。このユーザーに対して別の要素を関連付ける前に、既存の要素を使ってユーザーにチャレンジする必要があります。



### プッシュの登録を確定する

プッシュの登録を確定するには、エンドユーザーが5分以内にGuardianアプリケーションの`barcode_uri`でQRコードをスキャンする必要があります。

完了すると、ユーザーが正常に登録されたことをGuardianアプリケーションがAuth0に通知します。スキャンされたかを知るためには、MFA Associateエンドポイントの呼び出しで返された`oob_code`を使用して、Auth0トークンエンドポイントをポーリングします。



ユーザーがコードをスキャンしなかった場合には、`authorization_pending`応答が返され、数秒以内に`oauth_token`をもう一度呼び出す必要があることが分かります。



呼び出しが成功すると、アクセストークンを含む応答が以下のフォーマットで返されます。



この時点でAuthenticatorは完全に関連付けられ、利用可能な状態で、ユーザー用の認証トークンを取得します。

MFA Authenticatorエンドポイントを呼び出すことで、Authenticatorが確認されているかどうかをいつでも検証できます。Authenticatorが確認されている場合、`active`に返される値は`true`です。

## プッシュでチャレンジする

### MFAトークンを取得する

[「リソース所有者のパスワード付与とMFAで認証する」](/mfa/ropg-mfa)で説明されている手順に従ってMFAトークンを取得します。

### 登録されているオーセンティケーターを取得する

ユーザーにチャレンジするには、チャレンジしたい要素の`authenticator_id`が必要です。登録された全Authenticatorの一覧は、MFA Authenticatorエンドポイントを使って表示できます：



Authenticatorのリストは以下の形式で取得されます。



ユーザーがプッシュで登録すると、OTPでも登録されます。これは、ユーザーに接続がないシナリオについて、Guardianが[OTPでのチャレンジ](/mfa/ropg-mfa/enroll-and-challenge-otp-authenticators)に対応しているためです。

### プッシュを使用してユーザーにチャレンジする

プッシュチャレンジをトリガーするには、対応する`authenticator_id`と`mfa_token`を使ってMFAチャレンジエンドポイントに`POST`を行います。



### 受信したコードを使って認証を完了します。

成功すると、以下の応答を受け取ります。



アプリケーションは、ユーザーがプッシュ通知を受領するまで、OAuth0トークンエンドポイントをポーリングしなければなりません。



呼び出しでは、以下の結果のうち1つが返されます。