---
og:description: Describes how to install, configure, and use options for the Auth0
  Guardian for Android SDK.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: Guardian for Android SDK
og:url: https://auth0.com/docs/
permalink: guardian-for-android-sdk
title: Guardian for Android SDK
twitter:description: Describes how to install, configure, and use options for the
  Auth0 Guardian for Android SDK.
twitter:title: Guardian for Android SDK
---

[Guardian for Android SDK](https://github.com/auth0/Guardian.Android)は、Guardian機能があるAndroidアプリの作成を支援し、プッシュ通知による多要素認証（MFA）へのセキュアなアクセスを提供します。このツールキットによって、組織のルックアンドフィールに合ったGuardianアプリケーションの独自にカスタマイズしたバージョンを構築できます。詳細については、「[MFAにプッシュ通知を構成する](https://auth0.com/docs/secure/multi-factor-authentication/multi-factor-authentication-factors/configure-push-notifications-for-mfa#configure-push-notifications-for-apple-using-apn-)」を参照してください。

Guardian for Android SDKを使用するには、Android APIレベル15以上が必要です。

## Guardian Android SDKをインストールする

Guardianは[Maven Central](http://search.maven.org/)と[JCenter](https://bintray.com/auth0/android/guardian)の両方で利用可能です。

1. Guardianを使用するには、以下の行を`build.gradle`依存関係ファイルに追加します： 
`implementation 'com.auth0.android:guardian:0.4.0'`
最新バージョンはリポジトリの[Releases](https://github.com/auth0/GuardianSDK.Android/releases)タブ、[Maven](http://search.maven.org/#search%7Cgav%7C1%7Cg%3A%22com.auth0.android%22%20AND%20a%3A%22guardian%22)、または[JCenter](https://bintray.com/auth0/android/guardian)で確認できます。
2. Gradleの依存関係を追加したら、プロジェクトをGradleファイルと忘れずに同期させます。

### Guardianプッシュ通知を有効にする

1. [［Dashboard］ > ［Security（セキュリティ）］ > ［Multifactor Auth（多要素認証）］ > ［Push via Auth0 Guardian（Auth0 Guardianを介してプッシュ）］](%24%7Bmanage_url%7D/#/security/mfa/guardian)に進みます。
2. 上部のスイッチを切り替えて有効にします。

3.[プッシュ通知を構成します](https://auth0.com/docs/secure/multi-factor-authentication/multi-factor-authentication-factors/configure-push-notifications-for-mfa#configure-push-notifications-for-android-using-fcm)。

## SDKを使用する

GuardianはSDKの中核です。特定のテナントURL向けにこのクラスのインスタンスを作成する必要があります。



または



### 登録

第二要素（デバイス上のアプリのインスタンス）とAuth0アカウントの間のリンクは、**登録**と呼ばれます。

`Guardian.enroll`関数を使用して登録を作成できますが、まず、そのための新しいRSA鍵ペアを作成する必要があります。秘密鍵は、ログインを許可または拒否する要求に署名するために使用されます。公開鍵は、サーバーが要求の署名を後で検証できるように登録プロセス中に送信されます。



次に、Guardian QRコードをスキャンして登録情報を取得し、それを使用してアカウントを登録します。



また、バックグラウンドスレッドで要求を実行することもできます。



以下のデータを提供する必要があります。



### 登録解除する

MFAを無効にするには、登録を削除できます。



### ログイン要求を許可する

登録が完了すると、多要素認証が必要になるたびにFCMプッシュ通知が届きます。

Guardianは、FCMから受信した[RemoteMessage](https://firebase.google.com/docs/reference/android/com/google/firebase/messaging/RemoteMessage)内の`Map<String, String>`データを解析し、使用可能な`Notification`インスタンスを返すメソッドを提供します。



通知インスタンスを取得したら、`allow`メソッドを使用して認証要求を承認できます。以前に取得した登録も必要です。複数の登録がある場合、必ず通知と同じ`ID`（`enrollmentId`プロパティ）のものを使用してください。



### ログイン要求を拒否する

認証要求を拒否するには、代わりに`reject`を使用します。また、任意で、Guardianログで確認できる拒否の理由を追加することもできます。



### モバイル専用OTP登録をセットアップする

Auth0 DashboardまたはManagement APIを使用して、MFA要素としてワンタイムパスワード（OTP）を有効にすることができます。このオプションにはQRコードは必要なく、ユーザーが手動で登録できます。

ユーザーを登録に招待するには、[Auth0 Dashboard > ［User Management（ユーザー管理）］ > ［Users（ユーザー）］](https://manage.auth0.com/#/users)に進み、ユーザーを選択します。その後、［Details（詳細）］タブにアクセスし、［Multi-Factor Authentication（多要素認証）］セクションを使用して登録招待を送信します。

#### **リソースを接続する**

リソースは、Auth0 DashboardまたはGuardian SDKを使って接続できます。

##### Auth0 Dashboardの使用

1. Auth0ログインプロンプトにアクセスし、提供されたコード、または別のソースから取得した同様のbase32エンコードキーをコピーします。
2. コードを取得し、Guardian SDKに追加します。

**Java**

`public String copiedCode = "{copiedCode}";`

**Kotlin**

`val copiedCode:String = "{copiedCode}"`

##### Guardian SDKを使用する

まず、`LoginCodeGenerator`クラスをプロジェクトに追加します。次に、`getCode (String copiedCode)`を使用して、アプリ内にワンタイムコードを生成します。

**Java**



**Kotlin**

****

#### **ワンタイムコードを入力する**

`getCode()`から生成されたワンタイムパスワードをAuth0ログインプロンプトに入力します。` `

［Continue（続ける）］を選択すると、アプリケーションがユーザーの認証要素として追加されたことを示すメッセージが表示されます。

#### **アプリでログインする**

要素が登録されると、ユーザーはアプリを使用してログインできるようになります。まず、認証方法としてGuardianアプリを選択します。

ワンタイムコードを生成するには、Auth0ログインプロンプトからコピーしたコードを使用して`getCode(copedCode:String)`を呼び出します。

次に、ワンタイムコードをログインプロンプトに入力し、本人確認を行います。