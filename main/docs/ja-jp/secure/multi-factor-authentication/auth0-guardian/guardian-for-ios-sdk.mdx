---
og:description: Describes how to install, use and configure options for the Guardian.swift
  iOS SDK.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: Guardian.swift iOS SDK
og:url: https://auth0.com/docs/
permalink: guardian-for-ios-sdk
title: Guardian.swift iOS SDK
twitter:description: Describes how to install, use and configure options for the Guardian.swift
  iOS SDK.
twitter:title: Guardian.swift iOS SDK
---



## 要件

* Guardianを使用するにはiOS 10+とSwift 4.1が必要です。
* このSDKを使用するには、テナントのGuardianサービスに独自のプッシュ通知資格情報を構成する必要があります。そうしないと、プッシュ通知が届きません。詳細については、「[MFAにプッシュ通知を構成する](/mfa/mfa-factors/configure-push-notifications-for-mfa)」を参照してください。

## Guardian iOS SDKをインストールする

### CocoaPods

Guardian.swiftは[CocoaPods](http://cocoapods.org)から入手可能です。インストールするには、以下の行をPodfileに追加します。

``

### Carthage

以下の行をCartfileに追加します。

````

## Guardianプッシュ通知を有効にする

1. [［Dashboard］ > ［Security（セキュリティ）］ > ［Multi-factor Auth（多要素認証）］](%24%7Bmanage_url%7D/#/guardian)に進みます。
2. **［Push Notification（プッシュ通知）］**を切り替えて有効にします。
3. [プッシュ通知を構成します](https://auth0.com/docs/secure/multi-factor-authentication/multi-factor-authentication-factors/configure-push-notifications-for-mfa#configure-push-notifications-for-apple-using-apn-)。

## Usage（使用）

`Guardian`はSDKの中核です。SDKを使用するには、ライブラリをインポートします。



テナントのドメインを設定します。または、テナントにカスタムドメインを構成している場合、それを使用します。



### 登録

登録は、第二要素とAuth0アカウント間のリンクです。アカウントが登録されると、本人確認に必要な第二要素を提供するためにアカウントが必要になります。アプリがまだプッシュ通知を使用していない場合、またはプッシュ通知に慣れていない場合、「[Appleプッシュ通知サービスの概要](https://developer.apple.com/go/?id=push-notifications)」を参照してください。

登録には、テナントのドメイン以外に以下の情報が必要です。



情報を入手した後、デバイスを登録できます。



成功すると、登録情報を取得できます。その登録情報は、アプリケーションにセキュアに保存する必要があります。この情報には、登録識別子と、登録を更新または削除するためにデバイスに関連付けられたGuardian APIのトークンが含まれます。

#### 署名キーと検証キー

Guardian.swiftは、署名鍵を生成するための便利なクラスを提供しています。



このキーはメモリ内にしか存在しません、`データ`表現を取得し、暗号化されたSQLiteDBなどにセキュアに保存できます。



しかし、iOSキーチェーンに保存したいだけなら、以下の手順で可能です。



上記の例では、キーを作成し、与えられたタグの下に自動的に保存します。それを取得したい場合、タグを使用できます。



検証キーは、`SigningKey`から取得できます。以下の例を挙げます。



### ログイン要求を許可する

登録を行うと、MFAで本人確認が必要になるたびにプッシュ通知が届きます。Guardianは、APNから受信したデータを解析し、使用可能な`Notification`インスタンスを返すメソッドを提供します。



通知インスタンスを取得すると、`allow`メソッドを使用して簡単に認証要求を許可できます。以前に取得した登録済みデバイスからの情報も必要です。複数の登録がある場合、必ず通知と同じ`id`（`enrollmentId`プロパティ）のものを見つける必要があります。

情報があれば、`device`パラメーターはプロトコル`AuthenticatedDevice`を実装しているものとなります。



ローカル識別子はデバイスのローカルIDであり、デフォルトでは登録`UIDevice.current.identifierForVendor`にあります。次に、以下を呼び出します。



### ログイン要求を拒否する

認証要求を拒否するには、代わりに`reject`を呼び出します。オプションで拒否の理由を送ることもできます。拒否の理由はGuardianログに表示されます。



### 登録解除する

登録を削除したい場合、たとえばMFAを無効にしたい場合は、以下の要求を行います。



### モバイル専用OTP登録をセットアップする

Auth0 DashboardまたはManagement APIを使用して、MFA要素としてワンタイムパスワード（OTP）を有効にすることができます。このオプションにはQRコードは必要なく、ユーザーが手動で登録できます。

ユーザーを登録に招待するには、[Auth0 Dashboard > ［User Management（ユーザー管理）］ > ［Users（ユーザー）］](https://manage.auth0.com/#/users)に進み、ユーザーを選択します。その後、［Details（詳細）］タブにアクセスし、［Multi-Factor Authentication（多要素認証）］セクションを使用して登録招待を送信します。

#### **リソースを接続する**

リソースは、Auth0 DashboardまたはGuardian SDKを使って接続できます。

##### Auth0 Dashboardの使用

1. Auth0ログインプロンプトにアクセスし、提供されたコード、または別のソースから取得した同様のbase32エンコードキーをコピーします。次のステップでは、このコードを認証アプリケーションに入力します。
2. コピーしたコードをGuardianなどの認証アプリケーションに追加します。

##### SDKを使用する

1. Guardianライブラリをインポートします。
2. コードジェネレーターを作成します。
3. 生成されたコードを取得します。

#### **ワンタイムコードを入力する**

Auth0ログインプロンプトで、前のステップで生成したコードを入力します。

［Continue（続ける）］を選択すると、アプリケーションがユーザーの認証要素として追加されたことを示すメッセージが表示されます。

#### **アプリでログインする**

要素が登録されると、ユーザーはアプリを使用してログインできるようになります。まず、認証方法としてGuardianアプリを選択します。

次に、ワンタイムコードをログインプロンプトに入力し、本人確認を行います。