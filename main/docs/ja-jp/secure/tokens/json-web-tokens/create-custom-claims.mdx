---
og:description: Learn how to create collision-resistant names for custom claims.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: カスタムクレームを作成する
og:url: https://auth0.com/docs/
permalink: create-custom-claims
title: カスタムクレームを作成する
twitter:description: Learn how to create collision-resistant names for custom claims.
twitter:title: カスタムクレームを作成する
---

To read custom claims on access and <Tooltip tip="ID Token: Credential meant for the client itself, rather than for accessing a resource." cta="View Glossary" href="/docs/glossary?term=ID+tokens">ID tokens</Tooltip>, you must use <Tooltip tip="ID Token: Credential meant for the client itself, rather than for accessing a resource." cta="View Glossary" href="/docs/glossary?term=JSON+Web+Tokens">JSON Web Tokens</Tooltip> (JWT) and pass an <Tooltip tip="JSON Web Token (JWT): Standard ID Token format (and often Access Token format) used to represent claims securely between two parties." cta="View Glossary" href="/docs/glossary?term=audience">audience</Tooltip> (`aud`) in an OIDC login flow. To learn more, read [Access Tokens](/docs/secure/tokens/access-tokens).

JWTでカスタムクレームを設定するときは、衝突を回避する必要があります。カスタムクレームが予約されたクレームや他のリソースのクレームと衝突しないようにするには、カスタムクレームに衝突耐性のある名前を付けます。Auth0では、名前空間形式の使用を推奨しています。

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

Auth0 allows namespaced and non-namespaced claims, but certain restrictions apply (see [General restrictions](/docs/secure/tokens/json-web-tokens/create-custom-claims#general-restrictions)). To avoid name collisions, we recommend using namespaced claims. In case of collisions, the transaction won't fail, but your custom claim won't be added to your tokens.

</Callout>

## 一般的な制限

Auth0は、カスタムクレームに以下の制限を適用します。

* カスタムクレームのペイロードは最大100 KBに設定される
* [OPENID standard claims](https://openid.net/specs/openid-connect-core-1_0.html#IDToken) and claims used internally by Auth0 cannot be customized or modified
* <Tooltip tip="Access Token: Authorization credential, in the form of an opaque string or JWT, used to access an API." cta="View Glossary" href="/docs/glossary?term=Access+tokens">Access tokens</Tooltip> with an Auth0 API audience, excluding the `/userinfo` endpoint, cannot have private, non-namespaced custom claims
* 指定されたOIDCユーザープロファイルクレームしかアクセストークンに追加できない

次のクレームがAuth0の制限の対象となります。

* `acr`
* `act`
* `active`
* `amr`
* `at_hash`
* `ath`
* `attest`
* `aud`
* `auth_time`
* `authorization_details`
* `azp`
* `c_hash`
* `client_id`
* `cnf`
* `cty`
* `dest`
* `entitlements`
* `events`
* `exp`
* `groups`
* `gty`
* `htm`
* `htu`
* `iat`
* `internalService`
* `iss`
* `jcard`
* `jku`
* `jti`
* `jwe`
* `jwk`
* `kid`
* `may_act`
* `mky`
* `nbf`
* `nonce`
* `object_id`
* `org_id`
* `org_name`
* `orig`
* `origid`
* `permissions`
* `roles`
* `rph`
* `s_hash`
* `sid`
* `sip_callid`
* `sip_cseq_num`
* `sip_date`
* `sip_from_tag`
* `sip_via_branch`
* `sub`
* `sub_jwk`
* `toe`
* `txn`
* `typ`
* `uuid`
* `vot`
* `vtm`
* `x5t#S256`

### 制限のないクレーム

You can create claims for sensitive user information to enhance the user profile and add to the user experience. These claims are consumed by your application from ID tokens. To learn more about using non-restricted claims, read [ID Tokens](/docs/secure/tokens/id-tokens), and keep in mind [Token Best Practices](/docs/secure/tokens/token-best-practices) if you use them.

以下のクレームには一般的な制限のみが適用されます。

* `address`
* `birthdate`
* `email`
* `email_verified`
* `family_name`
* `gender`
* `given_name`
* `locale`
* `middle_name`
* `name`
* `nickname`
* `phone_number`
* `phone_number_verified`
* `picture`
* `preferred_username`
* `profile`
* `updated_at`
* `website`
* `zoneinfo`

## 名前空間のガイドライン

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

The Auth0 URN `urn:auth0` cannot be used as a namespace identifier.

</Callout>

名前空間識別子については、以下のガイドラインを使用してください。

* Auth0以外のHTTPまたはHTTPS URLを名前空間識別子として使用します。Auth0のドメインは名前空間識別子として使用できません。これには以下のものが含まれます。

  + auth0.com
  + webtask.io
  + webtask.run
* 自分が管理しているURLを名前空間識別子として使用します。これにより、他の誰かが同じ名前空間を使用するリスクを回避できます。この名前空間URLが実際のリソースを指す必要はありません。これは呼び出されることがなく、識別子としてのみ使用されます。
* Begin the URL with `http://` or `https://`.
* 必要に応じて、複数の名前空間を作成します。
* 必要に応じて、複数の名前空間を作成します。

名前空間を選択したら、それにクレームを追加して、トークンに追加できる名前空間クレームを作成します。例：

`http://www.example.com/favorite_color`

## 非名前空間のガイドライン

非名前空間のカスタムクレームについては、次のガイドラインを使用してください。

* アプリケーションに絶対に必要な場合を除き、衝突耐性のあるパブリックの名前空間カスタムクレームを使用してください。
* 衝突耐性のある、分かりやすい名前のクレームを作成します。たとえば、`employee_id`を使用します。`e_id`にはしません。
* クレームの名前と値をできるだけ軽くし、アプリケーションに絶対に必要なデータのみを渡すようにします。
* 重いペイロードをカスタムクレームに割り当てないようにします。

For more examples of custom claims added to a token, see [Sample Use Cases: Scopes and Claims](/docs/get-started/apis/scopes/sample-use-cases-scopes-and-claims).

## カスタムクレームを作成する

カスタムクレームを作成するには、Auth0 Actionsを使用します。`api`オブジェクトを使用すると、アクセストークンやIDトークンに`setCustomClaim`メソッドが使えるようになります。

### 例

```js lines
exports.onExecuteCredentialsExchange = async (event, api) => {
  api.accessToken.setCustomClaim('myClaim', 'this is a private, non namespaced claim');
};
```






## Learn more

* [JSON Web Token Claims](/docs/secure/tokens/json-web-tokens/json-web-token-claims)
* [OpenID Connect Scopes](/docs/get-started/apis/scopes/openid-connect-scopes)