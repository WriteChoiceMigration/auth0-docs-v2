---
og:description: Describes how to configure refresh token rotation.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: リフレッシュトークンのローテーションを構成する
og:url: https://auth0.com/docs/
permalink: configure-refresh-token-rotation
title: リフレッシュトークンのローテーションを構成する
twitter:description: Describes how to configure refresh token rotation.
twitter:title: リフレッシュトークンのローテーションを構成する
---

Dashboardまたは[Auth0 SPA SDK](/libraries/auth0-single-page-app-sdk)を使用して、アプリケーションごとにリフレッシュトークンのローテーションを構成します。リフレッシュトークンのローテーションが有効な場合、ユーザーはシームレスな遷移が可能となります。アプリケーションは、前の、有効期限がなくローテーションしないリフレッシュトークンを使用し、ローテーションするリフレッシュトークンに切り替えます。

ローテーションしないリフレッシュトークンからローテーションするリフレッシュトークンに移行する（またはその逆の）場合、トークンは自動的に失効します。

* **リフレッシュトークンのローテーションが有効な場合**： 
ローテーションしないリフレッシュトークンを交換すると新しいリフレッシュトークンが発行され、同じ`client_id`、リソースサーバー、ユーザー、およびテナントに対して発行されたローテーションしないトークンがすべて削除されます。
* **リフレッシュトークンのローテーションが無効な場合**： 
ローテーションするリフレッシュトークンを交換するとローテーションしないリフレッシュトークンが発行され、同じ`client_id`、リソースサーバー、ユーザー、およびテナントに対して発行されたローテーションするリフレッシュトークンファミリーが失効します。

## Dashboardで構成する

1. [［Dashboard］>［Applications（アプリケーション）］](%24%7Bmanage_url%7D/#/applications)に移動します。
2. 構成したいアプリケーションを選択します。
3. **［Settings（設定）］**タブに移動します。
4. **［Refresh Token Rotation（リフレッシュトークンのローテーション）］**で、**［Allow Refresh Token Rotation（リフレッシュトークンのローテーションを許可する）］**を有効にします。.
5. 自動再利用検出をトリガーする前に、要求と応答の間に時間の余裕を持たせるために、リフレッシュトークンに対して、**［Rotation Overlap Period（ローテーションのオーバーラップ期間）］**を秒単位で入力します。このオーバーラップ期間は、指定された時間枠内でローテーションするリフレッシュトークンを複数回にわたって交換するときに、同時実行の問題を回避するのに役立ちます。この期間中、侵害検出機能は適用されず、ローテーションする新しいリフレッシュトークンが発行されます。再利用できるのは直前のトークンのみです。最後から2番目のトークンが交換されると、侵害検出がトリガーされます。
6. **［Save Changes（変更の保存）］**を選択します。



## Auth0 SPA SDKで構成する

Auth0 SPA SDKを使用して、リフレッシュトークンのローテーションを有効にすることができます。オフラインアクセスを有効にして、クライアントSDKでオフラインアクセスのスコープを要求しなければなりません。

1. 最新バージョンの`auth0-spa-js` SDKをインストールします：
`npm install @auth0/auth0-spa-js `
2. SDKで機能を有効にするには、`offline_access`スコープの送信を開始するように`useRefreshTokens: true`を設定します。
3. リフレッシュトークンのローテーション設定を構成します。例：



## 再利用の自動検出

前に無効になったトークンが使用されている場合は、その無効になったトークンが発行された以降に発行されたリフレッシュトークンの全セットが付与と同様に直ちに失効され、ユーザーの再認証が必要になります。