---
og:description: Describes how to configure refresh token rotation.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: リフレッシュトークンのローテーションを構成する
og:url: https://auth0.com/docs/
permalink: configure-refresh-token-rotation
title: リフレッシュトークンのローテーションを構成する
twitter:description: Describes how to configure refresh token rotation.
twitter:title: リフレッシュトークンのローテーションを構成する
---

Configure <Tooltip tip="Refresh Token: Token used to obtain a renewed Access Token without forcing users to log in again." cta="View Glossary" href="/docs/glossary?term=refresh+token">refresh token</Tooltip> rotation for each application using the Dashboard or the [Auth0 SPA SDK](/docs/libraries/auth0-single-page-app-sdk). When <Tooltip tip="Refresh Token: Token used to obtain a renewed Access Token without forcing users to log in again." cta="View Glossary" href="/docs/glossary?term=refresh+token+rotation">refresh token rotation</Tooltip> is enabled, the transition for the user is seamless. The application uses the previous, unexpired non-rotating refresh token and swaps it for a rotating refresh token.

ローテーションしないリフレッシュトークンからローテーションするリフレッシュトークンに移行する（またはその逆の）場合、トークンは自動的に失効します。

* **リフレッシュトークンのローテーションが有効な場合**：
  Exchanging a non-rotating refresh token issues a new rotation refresh token and deletes all the non-rotating tokens issued for the same `client_id`, <Tooltip tip="Resource Server: Server hosting protected resources. Resource servers accept and respond to protected resource requests." cta="View Glossary" href="/docs/glossary?term=resource+server">resource server</Tooltip>, user and tenant.
* **リフレッシュトークンのローテーションが無効な場合**：
  ローテーションするリフレッシュトークンを交換するとローテーションしないリフレッシュトークンが発行され、同じ`client_id`、リソースサーバー、ユーザー、およびテナントに対して発行されたローテーションするリフレッシュトークンファミリーが失効します。

## Dashboardで構成する

1. Go to [Dashboard > Applications](https://manage.auth0.com/#/applications).
2. Select the application you want to configure.
3. Go to the **Settings** tab.
4. Under **Refresh Token Rotation**, enable **Allow Refresh Token Rotation**.

   <Frame>![Dashboard Applications Applications Settings Tab Refresh Token Rotation](/images/cdy7uua7fh8z/Rk6i8MUVWZG34P7K6aurb/9457a6ea7ca5942522778c7ed7925023/Screenshot_2024-11-05_at_18.14.22.png)</Frame>
5. Enter **Rotation Overlap Period** (in seconds) for the refresh token to account for leeway time between request and response before triggering automatic reuse detection.
   Auth0 SPA SDKで構成する
6. Select **Save Changes**.

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

Refresh Token Rotation is only supported for OIDC-conformant applications with the Refresh Token grant type enabled.

</Callout>

## Auth0 SPA SDKを使用して、リフレッシュトークンのローテーションを有効にすることができます。オフラインアクセスを有効にして、クライアントSDKでオフラインアクセスのスコープを要求しなければなりません。

再利用の自動検出

1. Install the latest version of the `auth0-spa-js` SDK:
   `npm install @auth0/auth0-spa-js`
2. Enable the feature on the SDK by setting `useRefreshTokens: true` to start sending the `offline_access` scope.

   {/* codeblockOld.header.login.logInButton codeblockOld.header.login.configureSnippet */}


   ```javascript lines
   const auth0 = await createAuth0Client({
         domain: '{yourDomain}',
         client_id: '{yourClientId}',
         audience: '{yourApiIdentifier}',
         useRefreshTokens: true
       });
   ```

   
3. Configure the Refresh Token rotation settings. For example:

   ```text lines
   PATCH /api/v2/clients/{client_id}
       {
         "refresh_token": {
           "rotation_type": "rotating",
           "expiration_type": "expiring",
           "token_lifetime": "2592000",
           "leeway": 3
         }
       }
   ```

   <table class="table"><thead>
   <tr>
   <th><strong>Attribute</strong></th>
   <th><strong>Description</strong></th>
   </tr>
   </thead>
   <tbody>
   <tr>
   <td><code>rotation_type</code></td>
   <td>Text string: "rotating" or "non-rotating"</td>
   </tr>
   <tr>
   <td><code>expiration_type</code></td>
   <td>Text string: "expiring" or "non-expiring"</td>
   </tr>
   <tr>
   <td><code>token_lifetime</code></td>
   <td>The default refresh token expiration period, when <strong>Refresh Token Rotation</strong> is enabled, is 30 days (2,592,000 seconds). You can configure up to 1 year (31,557,600 seconds). <strong>The lifetime does not extend when tokens are rotated.</strong></td>
   </tr>
   <tr>
   <td><code>leeway</code></td>
   <td>Allow the same refresh token to be used within the time period to account for potential network concurrency issues that would otherwise invalidate the token should the client attempt to retry using the same refresh token. By default leeway is disabled. Configurable in seconds.</td>
   </tr>
   </tbody>
   </table>

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

Refresh Token Rotation is only supported for OIDC-conformant applications with the Refresh Token grant type enabled.

## 

</Callout>

## 前に無効になったトークンが使用されている場合は、その無効になったトークンが発行された以降に発行されたリフレッシュトークンの全セットが付与と同様に直ちに失効され、ユーザーの再認証が必要になります。

If a previously invalidated token is used, the entire set of refresh tokens issued since that invalidated token was issued will immediately be revoked along with the grant, requiring the user to re-authenticate.

## Learn more

* [Refresh Token Rotation](/docs/secure/tokens/refresh-tokens/refresh-token-rotation)
* [Use Refresh Token Rotation](/docs/secure/tokens/refresh-tokens/use-refresh-token-rotation)
* [Disable Refresh Token Rotation](/docs/secure/tokens/refresh-tokens/disable-refresh-token-rotation)