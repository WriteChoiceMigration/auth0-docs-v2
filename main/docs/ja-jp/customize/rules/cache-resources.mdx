---
og:description: How to cache expensive resources in your Rules code.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: ルールで高コストなリソースをキャッシュする
og:url: https://auth0.com/docs/
permalink: cache-resources
title: ルールで高コストなリソースをキャッシュする
twitter:description: How to cache expensive resources in your Rules code.
twitter:title: ルールで高コストなリソースをキャッシュする
---

<Warning>

The End of Life (EOL) date of Rules and Hooks will be **November 18, 2026**, and they are no longer available to new tenants created as of **October 16, 2023**. Existing tenants with active Hooks will retain Hooks product access through end of life.

We highly recommend that you use Actions to extend Auth0. With Actions, you have access to rich type information, inline documentation, and public `npm` packages, and can connect external integrations that enhance your overall extensibility experience. To learn more about what Actions offer, read [Understand How Auth0 Actions Work](/docs/customize/actions/actions-overview).

To help with your migration, we offer guides that will help you [migrate from Rules to Actions](/docs/customize/actions/migrate/migrate-from-rules-to-actions) and [migrate from Hooks to Actions](/docs/customize/actions/migrate/migrate-from-hooks-to-actions). We also have a dedicated [Move to Actions](https://auth0.com/extensibility/movetoactions) page that highlights feature comparisons, [an Actions demo](https://www.youtube.com/watch?v=UesFSY1klrI), and other resources to help you on your migration journey.

To read more about the Rules and Hooks deprecation, read our blog post: [Preparing for Rules and Hooks End of Life](https://auth0.com/blog/preparing-for-rules-and-hooks-end-of-life/).

</Warning>

ルールには、`global`オブジェクトを使用して高コストなリソースを保存することができます。`global`オブジェクトは個々の実行後も存続するため、ルールが実行される度に作成するのではなく、ルールに保存されているオブジェクトを再利用できます。ただし、ルールの環境はいつでも再利用される可能性があるので、コードでは常に、`global`に期待どおりの内容が含まれていることを確認する**必要があります**。

This example shows how to use the `global` object to keep a MongoDB connection:

```javascript lines
//If the db object is there, use it.
if (global.db){
  return query(global.db, callback);
}

//If not, get the db (mongodb in this case)
mongo('mongodb://user:pass@mymongoserver.com/my-db',  function (db){
  global.db = db;
  return query(db, callback);
});

//Do the actual work
function query(db, cb){
  // Do something with db
  ...
  return cb(null, user, context);
}
```






To learn more about using MongoDB, read [the MongoDB Manual](https://docs.mongodb.com/manual/).