---
og:description: Configure an update policy form using Forms for Actions
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: ユースケース：Formsを使用して更新ポリシーフォームを構成する
og:url: https://auth0.com/docs/
permalink: configure-update-policy-form
title: ユースケース：Formsを使用して更新ポリシーフォームを構成する
twitter:description: Configure an update policy form using Forms for Actions
twitter:title: ユースケース：Formsを使用して更新ポリシーフォームを構成する
---

Forms for Actionsは、カスタムプライバシーポリシーフローを作成し、`app_metadata`オブジェクトの下に同意を保存できるようにします。

以下のセクションでは、ノードとフローを使用して更新ポリシーフォームを作成する方法と、フォームを[ログイン後](/signup-and-login-triggers/login-trigger)のアクションに追加する手順について説明します。



### ステップノードを構成する

ステップノードは、ユーザーに表示されるグラフィカルインターフェースです。次の手順に従って、ステップノードに[フィールド](/nodes-and-components)を追加し、新しい同意の値を収集します。

1. **［Components menu（コンポーネントメニュー）］**から**［Rich text（リッチテキスト）］**フィールドを**Step（ステップ）**ノードにドラッグします。

* **Rich text（リッチテキスト）**：プライバシーポリシー更新の説明を入力します。
* **［Save（保存）］**を選択します。
2. **［Legal（法務）］**フィールドを**Step（ステップ）**ノードにドラッグします。

* **Id**：`privacy_policies`を入力します。
* **Required（必要）**：チェックボックスを有効にします。
* **Legal（法的文）**：「`I agree to the Privacy Policy`（プライバシーポリシーに同意します）」と入力します。
* **［Save（保存）］**を選択します。
3. **［Publish（公開）］**を選択して保存します。

### **フローノード**を構成する

次の手順に従って、**Step（ステップ）**ノードの後に**Flow（フロー）**ノードを追加し、`app_metadata`を更新して認証フローを再開します。

1. フォームエディターの下にある**［Flow（フロー）］**を選択します。
2. **Step（ステップ）**ノードと**Ending Screen（終了画面）**ノードの間にある既存のリンクを削除します。
3. 新たに**［Flow（フロー）］**>**［Click to add a flow（クリックしてフローを追加する）］**>**［Create a new flow（新しいフローを作成する）］**を選択します。

* **［Name（名前）］**フィールドに`Update app_metadata`と入力します。
* **［Create（作成）］**を選択します。
* **［Save（保存）］**を選択します。
4. 下の画像のように**Flow（フロー）ノード**を**Step（ステップ）**ノードと**Ending Screen（終了画面）**ノードにリンクします。
5. **［Publish（公開）］**を選択して保存します。

Auth0ユーザーの更新アクションをフローに追加するには、次の手順に従います。

1. **［Update user_metadata（user_metadata更新）］****フロー**を選択してから**［Edit flow（フローの編集）］**を選択し、新しいタブにフローエディターを開きます。
2. アクションの**［Start（開始）］**の下にある**［+］**アイコンを選択し、**Update user（ユーザー更新）**アクションを追加します。以下のフィールドに入力して、**［Save（保存）］**を選択します。

* **Connection（接続）**：ドロップダウンからM2MアプリケーションへのVault接続を選択します。
* **User ID（ユーザーID）**：`{{context.user.user_id}}`と入力します。
* **Body（ボディー）**：以下のコードをコピーして貼り付け、privacy_policiesとprivacy_policies_timestampのプロパティを含むapp_metadataを更新します。
* **［Save（保存）］**を選択します。
3. **［Publish（公開）］**を選択して保存します。



## フォームのレンダーコードを取得する

フォームのレンダーコードを取得して、カスタムのログイン後アクションでフォームを視覚的にレンダリングするには、以下の手順に従います。

* フォームエディターから**`<>［Render（レンダー）］`**を選択します。
* **［Copy（コピー）］**を選択します。

## ログイン後のアクションを作成する

ログイン後のアクションを作成してフォームをレンダリングするには、次の手順に従います。

1. **［Auth0 Dashboard］>［Actions（アクション）］>［Flows（フロー）］>［Login（ログイン）］**に移動します。
2. **［+］**アイコンを選択し、**［Build from scratch（初めから構築する）］**を選択します。

* **Name（名前）**：`Render Update Policy Form`（更新ポリシーフォームのレンダリング）と入力します。
* **Trigger（トリガー）**：［`Login / Post Login`（ログイン/ログイン後）］を選択します。
* **Runtime（ランタイム）**：推奨バージョンを選択します。
3. **［Create（作成）］**を選択します。

ログイン後のアクションを構成するには、以下を行います。

1. 既存のコードをコードエディターから削除します。
2. フォームのレンダリングコードをコードエディターに貼り付けます。
3. コードを編集して、フォームをレンダリングする条件ロジックを定義します。
4. **［Deploy（デプロイ）］**を選択します。
5. **［Render Update Policy Form（更新ポリシーフォームのレンダリング）］**アクションを**Login（ログイン）**フローにドラッグ＆ドロップします。
6. **［Apply（適用）］**を選択します。

### **実装をテストする**

次の手順に従って実装をテストします。

1. `app_metadata`属性の`privacy_policies`に値がない既存のユーザーとしてログインします。
2. ログインフローのログイン後アクションがフォームをレンダリングして、同意を求めます。
3. **［Auth0 Dashboard］>［User Management（ユーザー管理）］>［Users（ユーザー）］**に移動し、ユーザーを見つけて、`app_metadata`属性の`privacy_policies`に`true`値とタイムスタンプが含まれていることを確認します。