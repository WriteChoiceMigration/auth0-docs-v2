---
og:description: Learn how to configure custom domains where you are responsible for
  TLS (SSL) certificates, the reverse proxy to handle SSL termination, and forwarding
  requests to Auth0.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: 自己管理証明書を使ってカスタムドメインを構成する
og:url: https://auth0.com/docs/
permalink: self-managed-certificates
title: 自己管理証明書を使ってカスタムドメインを構成する
twitter:description: Learn how to configure custom domains where you are responsible
  for TLS (SSL) certificates, the reverse proxy to handle SSL termination, and forwarding
  requests to Auth0.
twitter:title: 自己管理証明書を使ってカスタムドメインを構成する
---



Auth0からのサポートなしにカスタムドメインの証明書を管理する場合は、ドメイン上で複数のDNSレコードを必要とする受信接続の独自のプロキシと証明書を管理する方法を理解している必要があります。証明書を購入または提供し、更新をユーザー自身で管理しなければなりません。証明書がインストールされる場合はリバースプロキシも必要になります。ドメインが検証されたら、プロキシからトラフィックを受け取ります。

以下の操作を行うために、このオプションを選択してください。

* 証明書をより細かく制御する（独自のCAまたは証明書の有効期限を選択するなど）
* Auth0へのAPI呼び出しの詳細なモニタリングを有効にする

自己管理証明書を使ってカスタムドメインを設定するには、ドメイン名をAuth0に提供し、そのドメインを所有していることを確認し、リバースプロキシを構成する必要があります。カスタムドメインを設定したら、使い始められるようにAuth0機能を構成する必要があります。



## ドメイン名をAuth0に渡します。

1. [［Dashboard］>［Settings（設定）］>［Custom Domains（カスタムドメイン）］](%24%7Bmanage_url%7D/#/tenant/custom_domains)または[［Dashboard］>［Branding（ブランディング）］>［Custom Domains（カスタムドメイン）］](%24%7Bmanage_url%7D/#/custom_domains)に移動します。カスタムドメインを指定されたボックスに入力し、ドロップダウンメニューから**［Self-managed Certificates（自己管理証明書）］**を選択します。
2. **［Add Domain（ドメインを追加）］**をクリックします。ドメインを追加した後でも**［Add Domain（ドメインを追加）］**ボタンは表示されたままですが、テナントごとに追加できるドメインは1つだけです。

## 所有権を確認する

Auth0でドメインを使用するには、先にドメインを所有していることを確認する必要があります。

1. [［Dashboard］>［Branding（ブランディング）］>［Custom Domains（カスタムドメイン）］](%24%7Bmanage_url%7D/#/branding/custom_domains)の順に移動します。
2. TXT検証情報をドメインのDNSレコードに追加します。これらの手順は、お使いのドメインホストプロバイダーに応じて異なる場合があります。

1. 値をコピーできるように、Auth0のカスタムドメインページをブラウザーで開いたままにします。
2. ドメイン管理サービスにログインします。
3. 新しいレコードを作成し、以下の設定で保存します。
3. 続行するには**［Verify（確認）］**をクリックします。

DNS設定によっては、ドメインが確認されるまで数分かかることがあります。

Auth0がドメイン名を正常に検証すると、確認の画面が表示されます。
この画面に入力された情報（具体的には`cname-api-key`値）を保存してください。この値を表示できるのはこのとき**だけ**です。


検証プロセスが完了したら、1～2分以内にカスタムドメインが使用できるようになるはずです。3日以内に検証プロセスを完了できない場合は、これらの手順を繰り返してください。

## リバースプロキシを構成する

リバースプロキシサーバーは、アプリケーションに代わって1つまたは複数のサーバーからリソースを取得します。この後、これらのリソースはアプリケーションに返され、元々プロキシサーバー自体にあったかのように見えます。

[Cloudflare](/custom-domains/self-managed-certificates/configure-cloudflare-for-use-as-reverse-proxy)、[Azure CDN](/custom-domains/self-managed-certificates/configure-azure-cdn-for-use-as-reverse-proxy)、[Google Cloud Platform](/custom-domains/self-managed-certificates/configure-gcp-as-reverse-proxy)、または[AWS Cloudfront](/custom-domains/self-managed-certificates/configure-aws-cloudfront-for-use-as-reverse-proxy)などのサービスを使用し、カスタムドメインの設定を構成することができます。新しいCNAME値を、ディストリビューション用リバースプロキシのサーバードメイン名をポイントするカスタムドメインのDNSに追加します。

1. サービス上でリバースプロキシ設定を作成したら、[［Auth0 Dashboard］>［Branding（ブランディング）］>［Custom Domains（カスタムドメイン）］](%24%7Bmanage_url%7D/#/branding/custom_domains)タブの順に移動します。
2. 新しいCNAMEレコードを、ディストリビューション用のサービスドメイン名をポイントするカスタムドメインのDNSに追加します。これを見つけるには、リバースプロキシのサーバー構成で**［Distribution ID（ディストリビューションID）］**を検索します。CNAMEレコードを追加したら、証明書の更新中に問題が発生するのを避けるために、このレコードは常時必要となります。
3. プロキシサーバーの構成方法は、使用するサービスごとに異なります。構成が必要となる可能性の高い設定タイプは以下のとおりです。

* [ディストリビューション](#distribution-settings)
* [Origin custom headers（オリジンのカスタムヘッダー）](#origin-custom-header-settings)
* [Origin hostname（オリジンのホスト名）](#origin-hostname-settings)
* [Default cache behavior（デフォルトのキャッシュ動作）](#default-cache-behavior-settings)

### ディストリビューション設定



### オリジンのカスタムヘッダー設定



### オリジンのホスト名設定



カスタムドメインの詳細を取得する方法については、「[カスタムドメイン構成を取得する](https://auth0.com/docs/api/management/v2/custom-domains/get-custom-domains)」をご覧ください。

### デフォルトのキャッシュ動作設定



## 特定のAuth0機能で使用するその他の手順

使用しているAuth0機能に応じて、完了しなければならない手順がほかにもあります。詳細については、「[カスタムドメインを使用するために機能を構成する](/custom-domains/configure-features-to-use-custom-domains)」をお読みください。

Cloudflareでは、CNAME Flatteningと呼ばれる機能を使用します。この機能は、DNSレコードを処理する方法においてAuth0の検証と証明書更新に影響します。どうしても使用しなければならない場合を除き、CNAME Flattening機能はオフにすることを推奨します。詳細については、「[Cloudflareのドキュメント](https://support.cloudflare.com/hc/en-us/articles/200169056-Understand-and-configure-CNAME-Flattening)」をお読みください。