---
og:description: Learn how to set up Cloudflare for use as the custom domain proxy
  for Auth0.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: Cloudflareをリバースプロキシとして構成する
og:url: https://auth0.com/docs/
permalink: configure-cloudflare-for-use-as-reverse-proxy
title: Cloudflareをリバースプロキシとして構成する
twitter:description: Learn how to set up Cloudflare for use as the custom domain proxy
  for Auth0.
twitter:title: Cloudflareをリバースプロキシとして構成する
---



推奨される方法を使ってCloudflareをリバースプロキシとしてセットアップするには、以下の機能を備えたCloudflareのEnterpriseプランが必要です。



## Cloudflareを構成する



Cloudflareをリバースプロキシとして構成するには、CloudflareでCNAMEレコード、ページルール、変換ルールを作成する必要があります。

1. [カスタムドメインを構成して自己管理証明書を使って検証する](https://auth0.com/docs/customize/custom-domains/self-managed-certificates)作業がまだ済んでいない場合は、ここで行います。**［Origin Domain Name（オリジンのドメイン名）］**と**cname-api-key**の値が後で必要になるのでメモしておきます。
2. 目的のゾーンのCloudflareダッシュボードで、以下の設定の[CNAMEレコードを作成](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/#create-dns-records)します。
3. 以下の設定で、選択したカスタムドメインすべてのURLを対象とする[ページルールを作成](https://support.cloudflare.com/hc/en-us/articles/200172336-Creating-Page-Rules)します。
4. [変換ルールを作成](https://developers.cloudflare.com/rules/transform/request-header-modification/create-dashboard/)します。

1. **［要求ヘッダーを修正する］**ビューに切り替えます。
2. **［ルールを作成］**を選択して、任意の名前を入力します。
3. **［受信要求が一致する場合］**の下にある**［カスタムフィルター式］**を選択し、選択したカスタムドメインと紐づけられた要求にルールのスコープを定める式を設定します。たとえば、**［ホスト名］**フィールドに完全一致を使用します。
4. ［要求ヘッダーを修正する］で、**［スタティック設定］**を選択し、以下のフィールドを設定します。
5. [［常にHTTPSを使用］](https://developers.cloudflare.com/ssl/edge-certificates/additional-options/always-use-https/)が有効で、選択したカスタムドメインの[［暗号化モード］](https://developers.cloudflare.com/ssl/origin-configuration/ssl-modes/)が少なくとも**［フル］**に設定されていることを確認します。



## Auth0を構成する

以下のペイロードを本文に含むAuth0 Management APIの[カスタムドメイン構成の更新](https://auth0.com/docs/api/management/v2#!/Custom_Domains/patch_custom_domains_by_id)エンドポイントを呼び出します。