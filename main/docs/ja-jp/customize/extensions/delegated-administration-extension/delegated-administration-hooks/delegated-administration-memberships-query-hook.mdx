---
og:description: Learn how to use the Memberships Query Hook with the Delegated Administration
  Extension.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: 委任管理：メンバーシップクエリフック
og:url: https://auth0.com/docs/
permalink: delegated-administration-memberships-query-hook
title: 委任管理：メンバーシップクエリフック
twitter:description: Learn how to use the Memberships Query Hook with the Delegated
  Administration Extension.
twitter:title: 委任管理：メンバーシップクエリフック
---

新しいユーザーの作成では、ユーザーインターフェイスにドロップダウンが表示され、ユーザーに割り当てるメンバーシップを選択することができます。これらのメンバーシップは**メンバーシップクエリフック**を使って定義されます。

## フックコントラクト

* **ctx**：コンテキストオブジェクトです。
* **callback(error, \{ createMemberships: true/false, memberships: })**: Callback to which you can return an error and an object containing the membership configuration.

## 使用例

IT部のユーザーは他の部署にユーザーを作成できなくてはなりません。他の部署のユーザーは自身の部署にのみユーザーを作成できなくてはなりません。

```javascript lines
function(ctx, callback) {
  var currentDepartment = ctx.payload.user.app_metadata && ctx.payload.user.app_metadata.department;
  if (!currentDepartment || !currentDepartment.length) {
    return callback(null, [ ]);
  }

  if (currentDepartment === 'IT') {
    return callback(null, [ 'IT', 'HR', 'Finance', 'Marketing' ]);
  }

  return callback(null, [ ctx.payload.user.app_metadata.department ]);
}
```






## 注記

このクエリが使用できるのはUI内だけであるため、特定部署のユーザー割り当てにルールの実行が必要な場合には、**書き込みフック**を使用してメンバーシップを割り当てなければなりません。

メンバーシップのグループが1つだけの場合、UIに［Memberships（メンバーシップ）］フィールドは表示されません。

**createMemberships**をtrueに設定すると、エンドユーザーが**memberships**フィールドに任意の値を入力できるようになります。

```javascript lines
function(ctx, callback) {
  var currentDepartment = ctx.payload.user.app_metadata.department;
  if (!currentDepartment || !currentDepartment.length) {
    return callback(null, [ ]);
  }

  return callback(null, {
    createMemberships: ctx.payload.user.app_metadata.department === 'IT' ? true : false,
    memberships: [ ctx.payload.user.app_metadata.department ]
  });
}
```






## Learn more

* [Delegated Administration: Access Hook](/docs/customize/extensions/delegated-administration-extension/delegated-administration-hooks/delegated-administration-access-hook)
* [Delegated Administration: Filter Hook](/docs/customize/extensions/delegated-administration-extension/delegated-administration-hooks/delegated-administration-filter-hook)
* [Delegated Administration: Settings Query Hook](/docs/customize/extensions/delegated-administration-extension/delegated-administration-hooks/delegated-administration-settings-query-hook)
* [Delegated Administration: Write Hook](/docs/customize/extensions/delegated-administration-extension/delegated-administration-hooks/delegated-administration-write-hook)