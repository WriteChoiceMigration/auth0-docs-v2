---
og:description: Learn how to use the Filter Hook with the Delegated Administration
  Extension.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: 委任管理：フィルターフック
og:url: https://auth0.com/docs/
permalink: delegated-administration-filter-hook
title: 委任管理：フィルターフック
twitter:description: Learn how to use the Filter Hook with the Delegated Administration
  Extension.
twitter:title: 委任管理：フィルターフック
---

**Delegated Admin - User**ロールのユーザーはデフォルトで、そのAuth0アカウントに紐づけられたすべてのユーザーを表示できます。しかし、**フィルターフック**を使うと、ユーザーに表示されるデータをフィルタリングすることができます。

## フックコントラクト

* **ctx**：コンテキストオブジェクト。
* **callback(error, query)**: Callback to which you can return an error or the lucene query used when filtering the users. The extension will send this query to the [**Get Users** endpoint](https://auth0.com/docs/api/management/v2#!/Users/get_users) of the <Tooltip tip="Management API: A product to allow customers to perform administrative tasks." cta="View Glossary" href="/docs/glossary?term=Management+API">Management API</Tooltip>.

To learn more about the lucene query, review [User Search Query Syntax](/docs/manage-users/user-search/user-search-query-syntax).

### サンプルユースケース

財務部門を管理するKellyには、財務部門に所属するユーザーしか表示されるべきではありません。そこで、該当するユーザーと部門（この場合は、財務部門とKelly）に応じて全体のユーザーにフィルターをかけます。

```javascript lines
function(ctx, callback) {
  // Get the department from the current user's metadata.
  var department = ctx.request.user.app_metadata && ctx.request.user.app_metadata.department;
  if (!department || !department.length) {
    return callback(new Error('The current user is not part of any department.'));
  }

  // The IT department can see all users.
  if (department === 'IT') {
    return callback();
  }

  // Return the lucene query.
  return callback(null, 'app_metadata.department:"' + department + '"');
}
```






### 検索エンジンのオーバーライド

デフォルトの検索エンジンは、応答で選択を指定することでオーバーライドできます。

```javascript lines
// Return the lucene query.
return callback(null, { query: 'app_metadata.department:"' + department + '"', searchEngine: 'v2' });
```






## 注記

フィルタイリングする際には一重引用符、二重引用符、その他の特殊文字（**+**や**-**など）は使用しないでください。使用するとLuceneクエリに問題が生じる可能性があります。

OR、NOT、ANDなどの複数の演算子を使用する場合は、それらの検索パラメーターを括弧[`()`]で囲み、どの演算子がどこで有効かを明確にしてください。

このフックを構成しないと、検索結果に**すべてのユーザー**が返されます。

## Learn more

* [Delegated Administration: Access Hook](/docs/customize/extensions/delegated-administration-extension/delegated-administration-hooks/delegated-administration-access-hook)
* [Delegated Administration: Memberships Query Hook](/docs/customize/extensions/delegated-administration-extension/delegated-administration-hooks/delegated-administration-memberships-query-hook)
* [Delegated Administration: Settings Query Hook](/docs/customize/extensions/delegated-administration-extension/delegated-administration-hooks/delegated-administration-settings-query-hook)
* [Delegated Administration: Write Hook](/docs/customize/extensions/delegated-administration-extension/delegated-administration-hooks/delegated-administration-write-hook)