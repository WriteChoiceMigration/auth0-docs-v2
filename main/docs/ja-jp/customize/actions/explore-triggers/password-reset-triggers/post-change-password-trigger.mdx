---
og:description: Learn about the Post Change Password flow and the post-change-password
  Action trigger, which runs after a Database connection user resets or changes their
  password. This trigger can be used to notify another system that the user’s password
  has changed.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: パスワード変更後フロー
og:url: https://auth0.com/docs/
permalink: post-change-password-trigger
sidebarTitle: パスワード変更後フロー
title: パスワード変更後フロー
twitter:description: Learn about the Post Change Password flow and the post-change-password
  Action trigger, which runs after a Database connection user resets or changes their
  password. This trigger can be used to notify another system that the user’s password
  has changed.
twitter:title: パスワード変更後フロー
---

パスワード変更後フローは、ユーザーがパスワードをリセット・変更した後に実行されます。このフローを使ってパスワード変更後にユーザーにメールを送ったり、他のシステムに変更を通知したりすれば、Auth0で管理されていないセッションを取り消すことができます。

<Frame>![Diagram showing the Actions パスワード変更後 Flow.](/images/cdy7uua7fh8z/3i65TvmTpHkyDTqKvXAkMi/3adb8f0bd195cec4dd0a82cb87b270b9/post-change-password-flow.png)</Frame>

このフローのアクションは非ブロック（非同期）であるため、Authパイプラインの実行はアクションの完了を待たずに継続されます。そのため、アクションの結果は、Auth0のトランザクションに影響しません。

## トリガー

### パスワード変更後

データベース接続のユーザーがパスワードをリセットまたは変更した後、`post-change-password`トリガーが実行されます。

このトリガーには、複数のアクションを結びつけることができ、アクションは順番に実行されます。ただし、これらのアクションは非同期で実行されるため、パスワードリセットのプロセスがブロックされることはありません。

### リファレンス

* [Event object](/docs/customize/actions/explore-triggers/password-reset-triggers/post-change-password-trigger/post-change-password-event-object): Provides contextual information about the user and the connection on which the password was changed.
* [API object](/docs/customize/actions/explore-triggers/password-reset-triggers/post-change-password-trigger/post-change-password-api-object): Provides methods for changing the behavior of the flow.

## 一般的なユースケース

### ユーザーの他のシステムでのセッションを無効にする

post-change-passwordアクションを使うと、そのユーザーの他のシステムでのセッションを無効にすることができます。

```javascript lines
const axios = require("axios");

/**
 * @param {Event} event - Details about user whose password was changed.
 */
exports.onExecutePostChangePassword = async (event) => {
  axios.post("https://my-api.exampleco.com/revoke-session", { params: { email: event.user.email }});
};
```






<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

To use an `npm` library like `axios`, you must add the library to the Action as a dependency. To learn more, read the "Add a dependency" section in [Write Your First Action](/docs/customize/actions/write-your-first-action).

</Callout>

### ユーザーのパスワード変更後にメールを送信する

```javascript lines expandable
const axios = require("axios");

exports.onExecutePostChangePassword = async (event) => {
  try {
    // https://sendgrid.api-docs.io/v3.0/mail-send
    axios.post('https://api.sendgrid.com/v3/mail/send',
      {
        personalizations: [{
          to: [{ email: event.user.email }]
        }],
        from: { email: 'admin@exampleco.com' },
        subject: 'Your password was changed',
        content: [{
          type: 'text/plain',
          value: 'The password for your ' + event.connection.name + ' account ' + event.user.email + ' was recently changed.'
        }]
      },
      {
        headers: {
          'Authorization': 'Bearer ' + event.secrets.SENDGRID_API_KEY
        },
      }
    );
  } catch (err) {
    console.log(`Error sending email to ${event.user.email}:`, err.message)
  }
};
```