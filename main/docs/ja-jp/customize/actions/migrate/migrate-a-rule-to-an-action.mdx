---
og:description: Description on how to use the Rule migration tooling in the Auth0
  dashboard
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: 移行ツール
og:url: https://auth0.com/docs/
permalink: migrate-a-rule-to-an-action
title: 移行ツール
twitter:description: Description on how to use the Rule migration tooling in the Auth0
  dashboard
twitter:title: 移行ツール
---

Simplify the migration process of Rules to Actions by using the Rule Migration tooling in the [Auth0 Dashboard](https://manage.auth0.com/). In addition to facilitating the switch from a Rule to an Action, the new tooling also offers built-in guidance and fixes for common Rule patterns.

## 移行を開始する前に、「[RulesからActionsに移行する](/migrate-from-rules-to-actions)」をご覧ください。.この移行ガイドは、ルールとアクションの違いが説明されている優れたリソースであり、移行過程においても役立つツールです。

Before you start the migration, visit [Migrate from Rules to Actions](/docs/customize/actions/migrate/migrate-from-rules-to-actions). This migration guide is an excellent resource that explains the differences between Rules and Actions and is a helpful tool in the migration journey.

### ルールはアクションの前に実行されるため、実行順序の逆にルールを移行する必要があります。既存のフローで最後に実行するルールを移行し、最初のルールまで時系列を遡って移行していきます。

この順序で移行を行わないと、ルールとアクションの順序における依存関係によって予期せぬ結果が生じ、エラーが発生する可能性があります。

安全なロールバック

### 移行ツールを使うと、何か問題が発生した場合に、安全かつ簡単にロールバックすることができます。ルールを再有効化すると、対応するアクションロジックがスキップされます。

ルールの移行

## ルールの移行を開始するには、**［Auth Pipeline（Authパイプライン）］>［Rules（ルール）］**を選択します。選択すると、ルールとそれらを個別に移行するオプションが提供されます。

アクションへの移行

<Frame>![](/images/cdy7uua7fh8z/79DmJp8C2vYZpdos51Z0nM/5a665d04c66dd9f0b8f0e25198cb9e4e/SS1_Dashboard_migration_screenshot.png)</Frame>

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

Only migration begins when you chose Migrate to Action. As a developer, you can choose when to activate the new Action.

</Callout>

### **［Migrate to Action（アクションへの移行）］**を選択すると、新しいアクションの作成が求められます。

**［Create（作成）］**を選択すると、新しいアクションが作成され、Actions Editor（アクションエディター）が表示されます。

<Frame>![](/images/cdy7uua7fh8z/1A8FnVyvqAwW8hbrkOQDoG/f83ba9d5157db14ac2a3a666b2280574/SS2_Migrate_to_Action_screenshot.png)</Frame>

ルールがアクションに移行され、アクティブのままになっていると、ルールはロジックが実行される前に終了します。

<Frame>![](/images/cdy7uua7fh8z/2A10fE69aVngEcL2ZQCqWX/720dca2a8e6005c9378efad3bc140af0/Screenshot_2024-06-06_at_11.55.38_AM.png)</Frame>

これは、`api.rules.wasExecuted()`を呼び出すことで実行されます。`wasExecuted`関数がルールIDを含む文字列を使用する場合、そのルールがすでに実行されていると`true`が返され、実行されていないと`false`が返されます。

これは、ロジックが2回実行されるのを防ぐのに役立つツールです。参照されたルールを無効にすると、即座にこの関数が`false`を返し、ビジネスロジックがアクションで実行されるようになります。

ルールのコードを書き換える

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

The Rule ID value populates automatically for any rule that is migrated using the **Migrate to Action** feature.

</Callout>

For more information about the `api.rules.wasExecuted()` function, refer to [Actions Triggers: post-login - API Object](/docs/customize/actions/explore-triggers/signup-and-login-triggers/login-trigger/post-login-api-object).

## ルール関数の内容をコピーして、アクション内の「`// YOUR CODE HERE`」コメントの下に貼り付けます。おそらく、このコードはアクションのプログラミングモデルに適合しません。

Actions Editor（アクションエディター）は、コードのリファクタリングが必要な箇所のフィードバックを表示します。また、ほとんどの状況で、自動修正の方法が提案されます。提案の確認や修正を行うには、下線のあるコードの上にカーソルを置きます。

**Quick Fix（クイック修正）**モーダルからオプションを選択すると、アクション特定の更新を適用できることがあります。

<Frame>![](/images/cdy7uua7fh8z/2jWCZFnfERuN7NzBPrpCDn/80ba271699893a007dac7baaf2dd44cb/Screenshot_2024-06-06_at_11.57.03_AM.png)</Frame>

推奨の修正を選択すると、コードが互換性のあるものに自動更新されます。

<Frame>![](/images/cdy7uua7fh8z/5jRGI4iDX9ZgwcPRADTbZ1/caa90923a76800526871b137806e2af3/Screenshot_2024-06-06_at_11.58.07_AM.png)</Frame>

自動的に修正を適用できない場合もありますが、その場合でもガイダンスが提供されます。

<Frame>![](/images/cdy7uua7fh8z/qTS4RD6cjWFVfI0T9Uph3/45776c464f7247ddd8e91860f4646f2e/Screenshot_2024-06-06_at_11.58.48_AM.png)</Frame>

たとえば、ルールの`callback`関数の場合、エラーには[`api.access.deny`]()、正常処理には`return`の使用が推奨されます。

<Frame>![](/images/cdy7uua7fh8z/1cAq5A1MNVLPAsinHjtROh/c71276afd1f6df9e01d71cc869778907/Screenshot_2024-06-06_at_11.59.37_AM.png)</Frame>

新しいアクションをテストする

<Frame>![](/images/cdy7uua7fh8z/4Lx3RxJh8v4tj1J2SpPVvU/0ff35b0f40bb24d195ab2f4b06817d86/Screenshot_2024-06-06_at_12.00.22_PM.png)</Frame>

For example: in the case of the Rule’s `callback` function, it is recommended to use [`api.access.deny`](/docs/customize/actions/explore-triggers/signup-and-login-triggers/pre-user-registration-trigger/pre-user-registration-api-object) for errors, or just `return` in successful cases.

### アクションを自動的に有効化する

Actions can be tested directly in the editor, as this is an essential part of the migration journey. For more information, review [Test Actions](/docs/customize/actions/test-actions).

<Warning>

We highly recommend you validate all migration logic in a development tenant before you enable it in production.

</Warning>

### フローにアクションを追加する方法については、「[初めてアクションを作成する](/actions/write-your-first-action)」を参照してください。

残りのルールを移行する

1. Select **Deploy**.
2. On the alert that confirms your deployment, select **Add to flow**.
3. Add your newly created Action to the flow, then select **Apply.**
4. Select **Continue**, **and disable any Rules selected** to simultaneously enable the new Action and disable the original Rule. If you are not ready, select **Cancel**, and you can disable the Rule later to activate the migrated Action logic.

For more information on adding your Action to the flow, refer to [Write your first Action](/docs/customize/actions/write-your-first-action).

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

If you re-enable a Rule, the corresponding Action logic is skipped.

</Callout>

## Migrate remaining rules

This process can be repeated to migrate each Rule in your login flow. Remember, Rules should be migrated in the reverse order they execute during the login flow.