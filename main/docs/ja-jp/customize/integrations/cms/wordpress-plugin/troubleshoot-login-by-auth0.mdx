---
og:description: This page explains common troubleshooting issues with the Login by
  Auth0 WordPress plugin
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: WordpressプラグインのLogin by Auth0のトラブルシューティング
og:url: https://auth0.com/docs/
permalink: troubleshoot-login-by-auth0
title: WordpressプラグインのLogin by Auth0のトラブルシューティング
twitter:description: This page explains common troubleshooting issues with the Login
  by Auth0 WordPress plugin
twitter:title: WordpressプラグインのLogin by Auth0のトラブルシューティング
---

以下ではトラブルシューティングでよくある質問をいくつか説明します。これらで問題が解消されない場合には、次を検討してください。

* If you're setting up the plugin for the first time or having problems with users logging in, please read [Configure Login by Auth0](/docs/customize/integrations/cms/wordpress-plugin/configure-login-by-auth0).
* If you found a bug in the plugin code, [submit an issue](https://github.com/auth0/wp-auth0/issues) or [create a pull request](https://github.com/auth0/wp-auth0/pulls) in GitHub.
* If you have questions about how to use Auth0 or the plugin, please [post on our community site](https://community.auth0.com/) or [create a request in the plugin's WordPress support forum](https://wordpress.org/support/plugin/auth0).
* To see additional documentation and find more answers, [visit our support site](https://support.auth0.com). Customers on a paid Auth0 plan can [submit a trouble ticket](https://support.auth0.com/tickets) for a fast response.

## 「無効な状態」のエラーメッセージが表示され、ログインできない

State validation is a security feature added in [version 3.6.0](https://github.com/auth0/wp-auth0/releases/tag/3.6.0). A cached callback URL usually causes this error message (see your Application settings for the callback URLs that should not be cached). To learn more, read [Troubleshoot WordPress Plugin Invalid State Errors](/docs/customize/integrations/cms/wordpress-plugin/troubleshoot-wordpress-plugin-invalid-state-errors).

## ログインで問題が起きているか、カスタムデータベースを使用したメールやパスワードの変更で問題が起きている

To learn about possible solutions, read [User Migration in Login by Auth0 WordPress Plugin](/docs/customize/integrations/cms/wordpress-plugin/user-migration-in-login-by-auth0).

## 「無効なIDトークン」または「期限切れのIDトークン」のエラーメッセージが表示され、ログインできない

これは通常、サーバーの時刻設定が間違っていることが原因になります。エラーメッセージが「早すぎる」と告知している場合には、サーバーの時刻が将来に設定されています。トークンの有効期限が切れていると告知される場合には、サーバーの時刻がかなり過去に設定されています。2つのサーバー間で時刻が異なることはよくあります。サーバー上のPHPで`echo date(DateTime::ISO8601)`を出力し、それを現在のUTC時間と秒まで比較します。サーバーの時刻がUCT時間よりも60秒（デフォルトの許容誤差）以上違っている場合には、サーバーのクロックスキューを調整するために許容誤差をより長く設定する必要があります。以下のコードをテーマの`functions.php`に貼り付けるか、そのコードの実行をプラグインが読み込まれた後、ログインのフックが実行される前に処理できる場所に貼り付けます。

```js wrap lines
add_filter( 'auth0_jwt_leeway', function( $default_leeway ) { return 120; } );
```






そうすることで、許容誤差が120秒になります。サーバーの時刻にある誤差の程度に合わせて調整が必要かもしれません。

## 「このアカウントに関連付けられているメールがありません」というエラーメッセージが表示され、ログインできない

If you get this error, make sure you are requesting an email from each provider in the <Tooltip tip="Auth0 Dashboard: Auth0's main product to configure your services." cta="View Glossary" href="/docs/glossary?term=Auth0+Dashboard">Auth0 Dashboard</Tooltip> under **Connections > Social** (expand each provider). Take into account that not all providers return email addresses for users (e.g., X). If this happens, you can always add an Email address to any logged in user through the Auth0 Dashboard (or API). See **Users > Edit**.

**このフィールドは、Auth0が推奨するセキュリティ対策を迂回するため、必要な場合にのみ使用してください**。

「同じメールのユーザーが存在します」というエラーメッセージが表示され、ログインできない

## これは、別のAuth0ユーザーに関連付けられているログインに同じメールを使用しているWordPressユーザーが存在することを示しています。プラグインをテストしているか、既存のユーザーを新しいAuth0ユーザーに関連付けたい場合には、以下を行います。

Auth0に同じメールアドレスで2人のユーザーが存在する限り、このエラーメッセージは今後も表示されます。[ユーザーアカウントをリンクする](/users/user-account-linking/link-user-accounts)ことをお勧めします。

1. Log in as an admin
2. Go to **wp-admin > Users** and search for the email being used
3. View the user's profile and scroll down to the bottom
4. Click **Delete Auth0 Data** and confirm

If you have 2 user accounts in Auth0 with the same email address, this error message will persist. We recommend that you [link user accounts](/docs/manage-users/user-accounts/user-account-linking/link-user-accounts).

## Chromiumベースのブラウザーを使用している場合には、サードパーティーのクッキーが無効になっていないことを確認してください。詳細については、「[クロスオリジン認証](/login/cross-origin-authentication)」をお読みください。

Go to [Auth0 Dashboard > Applications > Applications](https://manage.auth0.com/#/applications), select your WordPress application to view its settings, and check that the **Allowed Callback URLs** and **Allowed Origins (CORS)** match your WordPress site.

If you're using a Chromium-based browser, make sure you don't have third-party cookies turned off. To learn more, read [Cross-Origin Authentication](/docs/authenticate/login/cross-origin-authentication).

## パスワードレスログインをセットアップしたい

This means that the plugin is already configured with a Domain, <Tooltip tip="Client ID: Identification value given to your registered resource from Auth0." cta="View Glossary" href="/docs/glossary?term=Client+ID">Client ID</Tooltip>, and <Tooltip tip="Client ID: Identification value given to your registered resource from Auth0." cta="View Glossary" href="/docs/glossary?term=Client+Secret">Client Secret</Tooltip>. Running the Setup Wizard a second time can have unpredictable results. If you're setting up WordPress for the first time and want to start over before any logins have occurred:

1. Go to **wp-admin** > **Auth0** > **Settings** > **Basic**.
2. Delete the Domain and Client ID. Scroll down and click **Save Changes**.
3. Go to [Auth0 Dashboard > Applications > Applications](https://manage.auth0.com/#/applications).
4. Find the Application that was created by WordPress (its name should be the site name of your WordPress site).
5. Select the Application to view its settings. Scroll down, and select **Delete Application**.
6. Go to [Auth0 Dashboard > Authentication > Database](https://manage.auth0.com/#/connections/database).
7. Find the Connection that was created by WordPress (its name should be the site name of your WordPress site prepended with "DB-").
8. Select the Connection to view its settings. Scroll down, and select **I Want To Delete This Connection.** Please note that this will delete the Connection and all users that were created within it.
9. Return to WordPress. You will now see the Setup Wizard option under Auth0 in the admin menu.

## メールを使用するには、**［Email（メール）］**接続を有効にして、必要であれば設定を編集します。これは、メールコードでログイン（ユーザーがメールでコードを受け取り、それをサイトのログインフォームに入力）できるようにします。

<Tooltip tip="Passwordless: Form of authentication that does not rely on a password as the first factor." cta="View Glossary" href="/docs/glossary?term=Passwordless">Passwordless</Tooltip> login is possible any Auth0-enabled website using email or SMS. To make this work on your WordPress site:

1. Turn on **Passwordless Login** from the plugin settings' **Features** view and save.
2. Go to [Auth0 Dashboard > Authentication > Passwordless](https://manage.auth0.com/#/connections/passwordless).

* SMSでのグインを使用するには、**SMS**接続を有効にして、手順に従い、Twilioの開発者アカウントをセットアップします（使用の状況によっては有料のTwilioアカウントが必要です）。
* 上の手順で有効にした接続に応じて、Auth0のログインフォームがパスワードレス方式を選択します。両方の接続を有効にした場合には、デフォルトでメールが選択されます。その場合にSMSを表示するには、メール接続を無効にするか、プラグイン設定の**［Advanced（詳細設定）］**タブにある**［Connections（接続）］**フィールドに`sms`を追加します。
* WordPressで同じユーザーに2つのアカウントがある

一部の状況では、1人のユーザーに2つのアカウントができてしまうことがあります。WordPressで1つのアカウントを削除して、そのアカウントのコンテンツを別のユーザーに移動すると、ユーザーをマージできます。［wp-admin］>［Users］に移動して、削除したいアカウントを選択し、確認ダイアログが表示されたら、コンテンツの移動先となる別のアカウントを選択します。

## 自分の構成が間違っていてAuth0で認証できないため、プラグインへのアクセスに別の方法が必要である

ログインURLに「`?wle`」を追加すると、通常のWordPressログインで有効なWordPressの資格情報を使用して、プラグインにアクセスすることができます。例：`

## ユーザーのログインで問題が起きているため、詳細を確認するのにログがある場所を知りたい

The plugin can be accessed using valid WordPress credentials through the regular WordPress login by adding `?wle` to the login URL. For example: `http://yourdomain.com/wp-login.php?wle`.

## サインアップモードにデフォルトでウィジェットまたはショートコードを表示したい

The plugin provides an error log where you can check what has happened. Access it through the **Error Log** sub-item of the **Auth0** plugin menu. You can find additional information at [Auth0 Dashboard > Monitoring > Logs](https://manage.auth0.com/#/logs).

## プラグインでログインを強制すると、ユーザーがログインされない

これは通常、ログイン後にページがキャッシュされていることが原因になります。軽減する方法をホストに問い合わせるか、キャッシュバスティングパラメーターをURLに追加してみてください。詳細については、[GitHubにあるこのgistを使用]()してみてください。

## 強制ログインのプラグインを使用すると、ユーザーがログインされない

This is typically caused by a cached page after login. Check with your host for strategies to mitigate this or try adding a cache-busting parameter to the URL. To learn more, [use this gist on GitHub](https://gist.github.com/joshcanhelp/e3eb693749f0fe66aad097c3bbb3b415).

### ログイン後にユーザーを特定のURLにリダイレクトしたい

すべてのリダイレクトは実行前に`wp_safe_redirect()`を使って確認されます。自身のメインドメイン以外のドメインにリダイレクトしたい場合には、WordPressの`allowed_redirect_hosts`フィルターを使用して、そのドメインを確認に追加します。詳細については、[wordpress.orgに記載のapply_filters( 'allowed_redirect_hosts', string[] $hosts, string $host )]()を参照してください。

```javascript lines
function wp_auth0_forcelogin_whitelist( $whitelist ) {
  if ( ! empty( $_GET['auth0'] ) ) {
    $whitelist[] = site_url($_SERVER['REQUEST_URI']);
  }
  return $whitelist;
}
add_filter('v_forcelogin_whitelist', 'wp_auth0_forcelogin_whitelist', 10, 1);
```






## ログインページ

All redirects are checked using `wp_safe_redirect()` before being performed. If you're trying to redirect to a domain that is not your main domain, add that domain to the check using the core WordPress `allowed_redirect_hosts` filter. To learn more, read [apply_filters( 'allowed_redirect_hosts', string[] $hosts, string $host ) on wordpress.org](https://developer.wordpress.org/reference/hooks/allowed_redirect_hosts/).

### また、Auth0のプラグイン設定ページで**［Login redirection URL（ログインリダイレクトURL）］**の設定を使用することもできます。`redirect_to`パラメーターがない場合には、ユーザーのリダイレクトにこのURLが使用されます。

ウィジェット

ウィジェットは自動的に、認証前と同じ場所にユーザーをリダイレクトします。これは、［`Redirect after login:`（ログイン後のリダイレクト）］設定を使ってオーバーライドできます。

### ショートコード

ショートコードは自動的に、認証前と同じ場所にユーザーをリダイレクトします。これは、`redirect_to`属性を使ってオーバーライドできます。

### WordPressユーザーをAuth0に移行したい

現在のバージョンのプラグインには、ユーザーをAuth0に自動移行する方法はありませんが、以下を行うことができます。

## プラグインは2つのエンドポイントを公開して、カスタムデータベース接続を**Auth0へのインポート**モードでマークできるようにしています。エンドポイントの詳細については、「[データベースからの自動移行を構成する](/connections/database/migrating)」をお読みください。[これらのプラグインスクリプトを使用]()して、接続をセットアップすることができます。

ユーザーデータをJSONファイルにエクスポートして、Auth0への一括インポートを行うためにアップロードします。移行後に初めてユーザーがAuth0を使ってログインするときには、パスワードをリセットする必要があります。これは、Auth0が移行中にAuth0がWordPressのパスワードを復号化できないためです。JSONファイルを生成する方法については、「[ユーザーを一括してインポートする](/users/import-and-export-users/bulk-user-imports)」をお読みください。それから、Auth0 Management APIの[ユーザーインポートエンドポイント](/api/v2#!/Jobs/post_users_imports)を使用して、ファイルをアップロードする必要があります。

* The plugin exposes two endpoints to mark your custom database connection for **import to Auth0** mode. To learn more about the endpoints, read [Configure Automatic Migration from Your Database](/docs/manage-users/user-migration/configure-automatic-migration-from-your-database). You can [use these plugin scripts](https://github.com/auth0/wp-auth0/blob/master/lib/WP_Auth0_CustomDBLib.php) to set up your connection.
* Export your user data to a JSON file and upload it for batch-import into Auth0. Initially, your users will have to reset their passwords when logging in using Auth0 because there is no way for Auth0 to decrypt the WordPress passwords during migration. To learn how to generate the JSON file, read [Bulk User Imports](/docs/manage-users/user-migration/bulk-user-imports). Then you will need to upload the file using the Auth0 <Tooltip tip="Management API: A product to allow customers to perform administrative tasks." cta="View Glossary" href="/docs/glossary?term=Management+API">Management API</Tooltip>'s [Import Users endpoint](https://auth0.com/docs/api/v2#!/Jobs/post_users_imports).
* [Use this script](https://gist.github.com/glena/b31716e3c8fe48927be2) and the WordPress XML RPC endpoint to set up the migration flow using a custom database connection. To learn more about setting up the migration flow, read [Configure Automatic Migration from Your Database](/docs/manage-users/user-migration/configure-automatic-migration-from-your-database). To learn more about the WordPress XML RPC endpoint, read [XML-RPC Support on wordpress.org](https://codex.wordpress.org/XML-RPC_Support).

## その場合にform_titleを変更するには、以下の属性をdictのJSONに追加する必要があります。

埋め込まれたAuth0のログインフォームを変更したい

プラグイン設定ページの**［Appearance（外観）］**タブは数多くのオプションを提供して、サイト（`wp-login/php`ページ、ショートカット、またはウィジェット）に埋め込まれたログインフォームの外観や操作性を変更できるようにしています。これらのオプションについては、「[Login by Auth0を構成する](/cms/wordpress-plugin/configure-login-by-auth0)」をお読みください。これは、Auth0がホストしているユニバーサルログインページのログインフォームには影響しません。

```json lines
{
    "signin": {
        "title": "The desired form title"
    }
}
```






## また、**［Advanced（詳細設定）**］タブには［Extra Settings（追加設定）］フィールドがあり、構成したい設定をすべて含めた有効なJSONオブジェクトを使用することができます。これは、**［Appearance（外観）］**タブで行った変更内容をオーバライドします。使用できるすべての構成オプションについては、「[Lock構成オプション](/libraries/lock/lock-configuration)」をお読みください。

There are many options on the **Appearance** tab of the plugin settings page that can change the look and feel of the login form that is embedded on your site (`wp-login/php` page, shortcodes, or widgets). To learn more about these options, read [Configure Login by Auth0](/docs/customize/integrations/cms/wordpress-plugin/configure-login-by-auth0). This will not affect the the login form on the Auth0-hosted <Tooltip tip="Universal Login: Your application redirects to Universal Login, hosted on Auth0's Authorization Server, to verify a user's identity." cta="View Glossary" href="/docs/glossary?term=Universal+Login">Universal Login</Tooltip> Page.

There is also a field called "Extra Settings" on the **Advanced** tab that accepts a valid JSON object with all the settings you want to configure. This will override any changes made on the **Appearance** tab. To see all possible configuration options, read [Lock Configuration Options](/docs/libraries/lock/lock-configuration).

External style sheets and JS files should be loaded in your theme using the `wp_enqueue_scripts` hook for shortcodes/widgets and the `login_enqueue_scripts` hook for `wp-login.php`. To learn more, read [`do_action( 'wp_enqueue_scripts' )` on wordpress.org](https://developer.wordpress.org/reference/hooks/wp_enqueue_scripts/) and [`do_action( 'login_enqueue_scripts' )` on wordpress.org](https://developer.wordpress.org/reference/hooks/login_enqueue_scripts/).

## リフレッシュトークンを実装したい

リフレッシュトークンを使用できるように、プラグインのログイン方法には追加のパラメーターが実装されています。これを行うには、`auth0_auth_scope`フィルターを`auth0_user_login`アクションと組み合わせて使用します。

## WordPressで保存されているプロファイルデータは、Auth0のユーザーアカウントとは同期されません。

We implemented additional parameters in the login methods used by the plugin to allow for <Tooltip tip="Refresh Token: Token used to obtain a renewed Access Token without forcing users to log in again." cta="View Glossary" href="/docs/glossary?term=Refresh+Tokens">Refresh Tokens</Tooltip>. Use the `auth0_auth_scope` filter combined with the `auth0_user_login` action to accomplish this.

## Social Login with Auth0からLogin by Auth0に移行したい

Auth0はこれまで次の2つのWordPressプラグインを維持してきました。

## これら2つのプラグインは実質的には同じですが、**Social Login with Auth**はバージョン3.7.0（2018年8月13日にリリース）を最後に更新されていません。**Social Login with Auth**から**Login by Auth0**への移行は簡単です。Auth0やWordPressでデータが失われることはありません。

**Social Login with Auth**から**Login by Auth0**に移行すると、表示されるバージョン番号が更新されます。（wp-adminでプラグインを更新する場合と同様に）必ず先にステージングや開発用のサーバー上で変更をテストしてください。また、移行プロセス中はログインが動作しないことがあるため、必ずメンテナンスモードのプラグインを使用するか、オフピーク時間内に移行を完了させてください。

* [Login by Auth0](https://wordpress.org/plugins/auth0/)
* [Social Login with Auth0](https://wordpress.org/plugins/social-login-with-auth0/)

最も簡単なのは(S)FTPを使用した移行です。

FTPを使ってサイトにアクセスできない場合には、WordPressの管理画面から直接処理を実行することができます。

これで、新しいプラグインですべてが期待通りに動作するはずです。更新は通常通りに継続されます。

1. Log in to the WordPress site as an administrator.
2. [Download Login by Auth0](https://downloads.wordpress.org/plugin/auth0.zip) and unzip it locally.
3. Deactivate the **Social Login with Auth0** plugin from the WordPress admin > Plugins screen.
4. Log in to the server you want to migrate to and navigate to `wp-content/plugins`.
5. Move the `social-login-with-auth0` folder out of the plugins folder to back up the contents.
6. Upload the new `auth0` plugin folder to the plugins directory.
7. Activate the new "Login by Auth0" plugin from the WordPress **Admin** > **Plugins** screen.

If you're unable to access the site via FTP, you can also run the process directly from the WordPress admin:

1. Log in to the WordPress site as an administrator.
2. Go to **Auth0** > **Import-Export Settings**.
3. Click **Export Settings**, then **Export**.
4. Deactivate the **Social Login with Auth0** plugin from the WordPress **Admin** > **Plugins** screen.
5. Delete the **Social Login with Auth0** plugin and confirm.
6. Go to **Plugins** > **Add New** and search for "Auth0".
7. For the **Login by Auth0** plugin (make sure to check the name), click **Install Now**.
8. When this completes, click **Activate**.
9. Check **Auth0** > **Settings** and make sure the previous settings remain. If not:

   1. Go to **Auth0** > **Import-Export Settings**.
   2. Paste in the settings JSON exported previously and click **Import**.
10. Completely delete the settings file export JSON (it contains sensitive information).

Everything should now be working as expected with the new plugin and updates will resume as usual.

## Learn more

* [Integrate with WordPress](/docs/customize/integrations/cms/wordpress-plugin/integrate-with-wordpress)
* [Install Login by Auth0](/docs/customize/integrations/cms/wordpress-plugin/install-login-by-auth0)
* [Configure Login by Auth0](/docs/customize/integrations/cms/wordpress-plugin/configure-login-by-auth0)
* [Extend Login by Auth0 WordPress Plugin](/docs/customize/integrations/cms/wordpress-plugin/extend-login-by-auth0)