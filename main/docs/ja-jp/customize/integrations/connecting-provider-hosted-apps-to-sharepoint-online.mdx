---
og:description: How to connect provider hosted apps to SharePoint Online.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: プロバイダーがホストするアプリをSharePoint Onlineに接続
og:url: https://auth0.com/docs/
permalink: connecting-provider-hosted-apps-to-sharepoint-online
title: プロバイダーがホストするアプリをSharePoint Onlineに接続
twitter:description: How to connect provider hosted apps to SharePoint Online.
twitter:title: プロバイダーがホストするアプリをSharePoint Onlineに接続
---

Auth0 can help radically simplify the authentication process for SharePoint Apps. Auth0 will negotiate an <Tooltip tip="Access Token: Authorization credential, in the form of an opaque string or JWT, used to access an API." cta="View Glossary" href="/docs/glossary?term=Access+Token">Access Token</Tooltip> you can the use to call SharePoint APIs.

特別なライブラリは必要ありません。Auth0でサポートされているSDKのいずれかを使用できます。

## Step 1.Auth0にアプリケーションを登録する

通常どおり、Auth0に新しいアプリケーションを登録するだけです。**［Applications（アプリケーション）］ > ［NEW（新規）］**。詳細なステップについては、利用可能なSDKのいずれかを選択してください。次のステップで必要になるので、`client_id`を手元に置いてください。

## Step 2.アプリケーションのパッケージを作成する

You need to obtain a **<Tooltip tip="Client ID: Identification value given to your registered resource from Auth0." cta="View Glossary" href="/docs/glossary?term=Client+ID">Client ID</Tooltip>** and a **<Tooltip tip="Client ID: Identification value given to your registered resource from Auth0." cta="View Glossary" href="/docs/glossary?term=Client+Secret">Client Secret</Tooltip>** for your application. There are many ways of registering your application depending on the expected usage.

[Register SharePoint Add-ins (Microsoft Docs)](https://docs.microsoft.com/en-us/sharepoint/dev/sp-add-ins/register-sharepoint-add-ins) explains all different ways of registering your application in SharePoint. This step in the tutorial will use the simplest form: using self-registration in a specific tenant (yours).

### SharePoint Onlineを開く

The URL for the dashboard is `https://{your Office365 tenant}.sharepoint.com/_layouts/15/appregnew.aspx`

### Generate a Client_Id and ClientSecret:

<Frame>![SharePoint - generate client id - generate client secret](/images/cdy7uua7fh8z/2BLGIJdnfbknayoyF4U5wP/70e66c7d10a001e0eb7ffa7aaebfb035/90SvG.png)</Frame>

### フォームに情報を入力します。

Auth0はアプリとOffice 365インフラストラクチャの間にあるため、アプリにはこのURLを使用する必要があります。

**アプリドメイン**:

```http lines
{yourDomain}
```

**リダイレクトURI**:

```http wrap lines
https://{yourDomain}/login/callback?SP_APP_TOKEN&connection=CONNECTION&client_id={yourClientId}&redirect_uri={https://yourApp/callback}
```

* `connection`は、Auth0の接続で使用する名前です（「sharepoint」など）。
* `client_id`は、Auth0でアプリを識別します（ステップ1で作成）。
* `redirect_uri`は、すべてのネゴシエーションが完了した後にユーザーが最終的にアクセスする実際のアプリ内の場所です。指定しない場合は、常にAuth0で定義されたアプリのコールバックURLになります（localhostの場合もあります）

### アプリをパッケージ化してSharePointにアップロードします。

Visual Studioでアプリマニフェストの情報を入力します:

<Frame>![SharePoint - Visual Studio - Application Manifest](/images/cdy7uua7fh8z/36dscLHlLHZjJx1rLgrQ7N/8d64ec7a51f4e053627ecb5dfd3c7707/90SEc.png)</Frame>

**Publishing Profile（発行プロファイル）**を作成します（SharePointダッシュボードで取得した同じ**クライアントID**と**クライアントシークレット**を入力する必要があります）。

**［Package（パッケージ）］**をクリックし、結果のファイルをSharePointにアップロードします。

3.Auth0で接続を作成する

## Step 統合の最後のステップは、Auth0でSharePoint接続を追加することです。

次のものが必要です。

`Connection Name（接続名）`。これは任意の名前です。ステップ2で入力したものと一致する必要があります。

* `クライアントID`および`クライアントシークレット`。ステップ2で入力したものと一致する必要があります。
* `テスト用SharePointサイトURL`。これは、接続をテストするために使用されるSPサイトURLです。（ダッシュボードの［試す］ボタンを押したときなど）。ユーザーは常にSharePoint内からサイトへのリンクをたどるため、実行時には使用されません。
* ユーザーはOffice Marketplaceからアプリをインストールします。リンクをクリックするとAuth0にリダイレクトされ、Auth0がアクセストークンをネゴシエートして、最終的にアプリにリダイレクトされます。アプリは次のような`ユーザープロファイル`を受け取ります。

次のプロパティが含まれます。`cacheKey`、`refresh_token`、`host`、および`site`。これらにより、SharePoint API（リストなど）をコールバックできます。

<Frame>![Office Marketplace - Redirect -  User Profile Example](/images/cdy7uua7fh8z/4piqwmx1ONWMd3kjTFMq4I/714545f5cda3ab1d1dd5c620bc96b083/8Xp6x.png)</Frame>

The following properties will be included: `cacheKey`, `refresh_token`, `host`, and `site`. These will allow you to call back SharePoint APIs (such as lists).