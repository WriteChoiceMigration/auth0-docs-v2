---
og:description: Learn how to manage a multi-tenant workflow with the Auth0 Deploy
  CLI using keyword replacement.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: キーワードの置換
og:url: https://auth0.com/docs/
permalink: keyword-replacement
title: キーワードの置換
twitter:description: Learn how to manage a multi-tenant workflow with the Auth0 Deploy
  CLI using keyword replacement.
twitter:title: キーワードの置換
---

Deploy CLIは、環境固有の値を使用した動的なキーワード置換をサポートします。これにより、すべてのテナントが同じリソース構成ファイルを共有しながらも、微妙に異なる値を挿入するスケーラブルなマルチテナントワークフローが可能になります。

キーワード置換を使用するには、`AUTH0_KEYWORD_REPLACEMENT_MAPPINGS`構成プロパティに適切なマッピングが含まれていなければなりません。リソース構成ファイルには、以下のいずれかの方法でキーワードを挿入できます。‌‌

1. `@@EXAMPLE_KEY@@`: Using the `@` symbols causes the tool to perform a `JSON.stringify` on your value before replacing it. So if your value is a string, the tool will add quotes; if your value is an array or object, the tool will add braces.
2. `##EXAMPLE_KEY##`: Using the `#` symbol causes the tool to perform a literal replacement; it will not add quotes or braces.

## config.jsonの例

```json lines
{
  "AUTH0_DOMAIN": "test-tenant.us.auth0.com",
  "AUTH0_CLIENT_ID": "FOO",
  "AUTH0_CLIENT_SECRET": "BAR",
  "AUTH0_KEYWORD_REPLACE_MAPPINGS": {
    "ENVIRONMENT": "dev",
    "ALLOWED_LOGOUT_URLS": ["https://dev-test-site.com/logout", "localhost:3000/logout"],
    "ALLOWED_ORIGINS": ["https://dev-test-site.com", "localhost:3000"]
  }
}
```






## tenant.yamlの例

```yaml lines
tenant:
  friendly_name: "##ENVIRONMENT## tenant"
  allowed_logout_urls: @@ALLOWED_LOGOUT_URLS@@
  enabled_locales:
    - en
clients:
  - name: Test App
    allowed_origins: @@ALLOWED_ORIGINS@@
    allowed_logout_urls: @@ALLOWED_LOGOUT_URLS@@
```






## tenant.jsonの例

```json lines
{
  "friendly_name": "##ENVIRONMENT## tenant",
  "allowed_logout_urls": "@@ALLOWED_LOGOUT_URLS@@"
}
```






## 配列の連結

You may encounter situations where you would want to concatenate values onto a static array through keyword replacement. There is no special syntax to support this case, however, it is possible to achieve this by escaping double quotes in a single string that contains the appropriate values and injecting with the `##` keyword syntax. This technique works for both the [YAML and directory formats](/docs/deploy-monitor/deploy-cli-tool/available-resource-configuration-formats).

### config.jsonの例

```json lines
{
  "AUTH0_KEYWORD_REPLACE_MAPPINGS": {
    "GLOBAL_WEB_ORIGINS": "\"http://local.me:8080\", \"http://localhost\", \"http://localhost:3000\""
  }
}
```






### tenant.yamlの例

```yaml lines
clients:
  - name: Test App
    web_origins: [ "http://production-app.com", "https://production-app.com", ##GLOBAL_WEB_ORIGINS## ]
```






## エクスポート時にキーワードを保持する

通常、Deploy CLIは、下位レベルの環境（例: dev、test）から本番環境までの一方向ワークフローで操作する場合に最適です。ただし、上位レベルの環境からローカル構成ディレクトリに構成をエクスポートする必要がある場合があります。デフォルトでは、リモート値によってローカル値が上書きされ、**キーワードマーカーが削除されます**。ただし、キーワード置換の保持は、`AUTH0_PRESERVE_KEYWORDS`ブール構成プロパティを使用して有効にできます。この構成を有効にすると、Deploy CLIはエクスポート時にローカル構成ファイルで定義されたキーワードマーカーを保持しようとします。

キーワード保持機能は、リソース構成ファイルの正確性を維持しながら、できるだけ多くのキーワードを保持しようとします。そして、ほとんどの場合、ユーザーによる介入なしで機能します。ただし、いくつかの大きな制限があります:

* In the case of a keyword-replaced configuration field with differing values between local and remote, the local configuration value will always be favored. This will cause **any out-of-band changes on remote to be wiped away** if a keyword replace marker exists anywhere in that field's value in the resource definition file; there is no "intelligent" reconciliation.
* Arrays without a specific identifiers are not eligible for preservation. Ex: `["http://site.com/logout", "localhost:3000/logout", "##LOGOUT_URL##"]`. This is because the ordering of these values are non-deterministic. Alternatively, to preserve these values, it is recommended to leverage the `@@ARRAY_REPLACE@@` keyword replace syntax with the entire value.

To learn more about the history and technical challenges of of keyword preservation, refer to [RFC: Keyword Preservation During Export](https://github.com/auth0/auth0-deploy-cli/issues/688).