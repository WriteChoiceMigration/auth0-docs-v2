---
og:description: Describes Auth0's user search query string syntax.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: ユーザー検索のクエリ構文
og:url: https://auth0.com/docs/
permalink: user-search-query-syntax
title: ユーザー検索のクエリ構文
twitter:description: Describes Auth0's user search query string syntax.
twitter:title: ユーザー検索のクエリ構文
---



ユーザーを検索するとき、[Luceneクエリ構文](http://www.lucenetutorial.com/lucene-query-syntax.html)を使用してクエリを作成し、検索を絞り込むことができます。

クエリ文字列は、一連のタームと演算子に解析されます。

* タームは、`jane`や`smith`などの１つの単語の場合があります。
* タームは、二重引用符で囲まれたフレーズ（`"green apple"`）の場合があり、同じ順序のフレーズのすべての担当が一致します。
* フィールド名のないタームは、[ユーザーメタデータ](/users/metadata)フィールドのテキストと一致しません。
* 複数のタームは、括弧を使ってグループにまとめ、サブクエリにすることができます。
* 正規化されたユーザーフィールド（`email`、`name`、`given_name`、`family_name`、および`nickname`）の検索値は、大文字と小文字を区別しません。その他すべてのフィールド（すべての`app_metadata/user_metadatafi-rudo`/`user_metadata`フィールドを含む）は、大文字と小文字を区別します。
* 演算子（`AND`、`OR`、`NOT`）は、正規化されたユーザーフィールドおよびルートメタデータフィールドのすべてで機能します。
* 演算子は、常に大文字である必要があります。

## 検索可能なフィールド

すべての[正規化ユーザープロファイルフィールド](/users/user-profiles/normalized-user-profile-schema)および以下のフィールドを使用して、ユーザーを検索できます。



メタデータフィールドは、以下と使用できます。

* ブール値
* 数値：integerまたはdouble
* 文字
* オブジェクト：別のオブジェクトにネストされているスカラー値を検索するには、フィールドへのパスを使用します。たとえば、`app_metadata.subscription.plan:"gold"`
* 配列：配列にネストされているオブジェクト内のフィールドを検索するには、フィールドへのパスを使用し、配列レベルを無視します。たとえば、`user_metadata.addresses.city:"Paris"`

空の配列、空のオブジェクト、または`null`値を含むメタフィールドは、インデックスされていないため、検索できません。

範囲検索とワイルドカード検索は、`user_metadata`フィールドで使用できません。

## 完全一致

完全一致で検索するには、二重引用符を使用します：`name:"jane smith"`

たとえば、`jane smith`という名前のユーザーを検索するには、`q=name:"jane smith"`を使用します。



## ワイルドカード

ワイルドカード検索は、アスタリスク文字（`*`）を使用して0以上の文字を置換するタームに実行できます。ワイルドカード検索は、`user_metadata`フィールドで使用できません。

#### 例

* `name:john*`は、名前の始めに`john`があるユーザーすべてを返します。
* `name:j*`は、名前の始めに`j`があるユーザーすべてを返します。
* `q=name:john*` は、 `john`で始まる名前のユーザーすべてを返します。
* サフィックスの照合の場合、リテラルは3文字以上である必要があります。たとえば、`name:*usa`は使用できますが、`name:*sa`は使用できません。



## 範囲

ユーザー検索クエリで範囲を使用することができます。範囲検索は、ユーザーメタデータフィールドで使用できません。

* 包括範囲の場合は、角括弧を使用します：`[min TO max]`
* 排他的な範囲には、中括弧を使用します：`{min TO max}`
* 中括弧と角括弧は同じ範囲の表現内で組み合わせることができます：`logins_count:[100 TO 200}`
* ワイルドカードと組み合わせて範囲を使用します。たとえば、100回以上ログインしているユーザーを見つけるには、 `q=logins_count:{100 TO *]`を使用します。



## 検索可能なプロファイル属性の例

Auth0管理APIのユーザーを検索する場合、`user_metadata`または`app_metadata`で、ユーザーをフィルタリングできます。これを行うには、`q `パラメーターのLucene検索構文を使用できます。

Auth0管理API[リストまたは検索ユーザー](https://auth0.com/docs/api/management/v2#!/Users/get_users)エンドポイントは、結果が1000に制限されているため（レコード100件の10ページ）、フィルタリングは、最も関連性の高い結果が返るようにするのに役立ちます。

以下は、ユーザープロファイル`user_metadata`の例です。



### メタデーター属性のフィルタリング

`user_metadata`値を返すには、属性のフィルタリングを付けて`q`クエリを更新します。

`User_metadata `値については、プロファイルに直接クエリを実行できます。

`q:_exists_:user_metadata.fav_color`

このクエリは、`user_metadata`に`fav_color`属性を持つユーザープロファイルすべてを返します。

### メタデータのネストされたオブジェクト属性および値をフィルタリング

また`user_metadata`のネストされたオブジェクトを検索できます：

`q:_exists_:user_metadata.preferences.fontSize`

これは、`user_metadata`で`preferences.fontSize`に構成されたユーザープロファイルすべてにクエリを実行します。

別のオブジェクトからネストされたオブジェクトの値を検索するには、以下のクエリを参照してください。

`q: user_metadata.preferences.fontSize:13`

このクエリは、`13`の値の`fontSize`属性と一致するユーザープロファイルすべてを返します。

### メタデータのネストされた配列値をフィルタリング

ネストされた配列のフィールドを検索するために、以下のクエリを使用できます。

`q: user_metadata.addresses.city:"Seattle"`

これは、`user_metadata`の`address.city `属性から`Seattle`の値を返したユーザープロファイルのすべてを返します。