---
og:description: Learn how to perform bulk user imports with the Management API.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: 一括ユーザーインポート
og:url: https://auth0.com/docs/
permalink: bulk-user-imports
title: 一括ユーザーインポート
twitter:description: Learn how to perform bulk user imports with the Management API.
twitter:title: 一括ユーザーインポート
---

ユーザーデータを一括してAuth0にインポートするには、[ユーザーインポートジョブ作成](/api/management/v2#!/Jobs/post_users_imports)エンドポイントを使用します。一括インポートは、ユーザーを既存のデータベースやサービスからAuth0に移行するのに便利です。



## 前提条件

ユーザーインポートジョブを実行する前に、以下を行います。

* データベース接続をユーザーのインポートに構成して、少なくとも1つのアプリケーションに有効化します。
* パスワードをインポートする場合には、対応しているアルゴリズムの1つを使ってパスワードがハッシュ化されていることを確認します。ユーザーのパスワードが非対応のアルゴリズムでハッシュ化されている場合には、一括インポート後に初回のログインでユーザーがパスワードをリセットする必要があります。
* MFAの登録をインポートする場合には、対応している`email`、`phone`または`totp`のタイプであることを確認します。
* ジョブエンドポイントの要求に、[Management APIトークンを取得](/security/tokens/access-tokens/management-api-access-tokens)します。



## ユーザーのJSONファイルを作成する

Auth0にインポートしたいユーザーデータを含むJSONファイルを作成します。ユーザーデータをJSONファイルにエクスポートする方法は、既存のユーザーデータベースによって異なります。Management APIのエンドポイントはJSONファイルを期待します。そのため、`fs.readFileSync`ではなく、`fs.createReadStream`を使用する必要があります。エンドポイントは、JSONファイルではなく、パイプで連結された読み出しストリームを期待します。

JSONファイルのスキーマと例については、「[一括インポートのデータベーススキーマと例](/users/import-and-export-users/bulk-user-import-database-schema-and-examples)」をお読みください。



## 一括ユーザーインポートを要求する

一括ユーザーインポートジョブを始めるには、`POST`要求を[一括ユーザーインポートジョブ作成](https://auth0.com/docs/api/management/v2#!/Jobs/post_users_imports)エンドポイントに対して行います。必ず、`MGMT_API_ACCESS_TOKEN`、`USERS_IMPORT_FILE.json`、`CONNECTION_ID`、および`EXTERNAL_ID`のプレースホルダーの値をそれぞれManagement APIのアクセストークン、ユーザーのJSONファイル、データベース[接続ID](/get-started/dashboard/locate-the-connection-id)と外部IDに置き換えます。





要求に成功すると、以下のような応答を受け取ります。



返されたエンティティはインポートジョブを表します。

ユーザーインポートジョブが完了すると、`send_completion_email`が`true`に設定されている場合には、ジョブの成功または失敗がテナント管理者に通知されます。ジョブ失敗のメールでは、ユーザーのインポートでユーザーのJSONファイルが解析に失敗したことを管理者に知らせる場合もあります。

### 複数のインポートジョブを同時に実行する

[ユーザーインポートジョブ作成](https://auth0.com/docs/api/management/v2#!/Jobs/post_users_imports)エンドポイントでは、同時に実行可能なインポートジョブが2つまでに制限されています。2つのジョブが保留中の場合に追加のジョブを要求すると、`429 Too Many Requests`（要求が多すぎます）応答が返されます。



## ジョブステータスを確認する

ジョブのステータスを確認するには、`GET`要求を[ジョブ取得](https://auth0.com/docs/api/management/v2#!/Jobs/get_jobs_by_id)エンドポイントに対して行います。必ず、`MGMT_API_ACCESS_TOKEN`および`JOB_ID`のプレースホルダーの値をそれぞれManagement APIのアクセストークンとユーザーインポートジョブIDに置き換えます。



ユーザーインポートジョブのステータスに応じて、以下のような応答の1つを受け取ります。

**保留中**

****

**完了**

ジョブが完了すると、ジョブステータス応答には、成功、失敗、挿入、および更新レコードの総計が含めれます。



**失敗**

ジョブ内にエラーがある場合には、失敗が返されます。ただし、無効なメールなどの無効なユーザー情報では、ジョブが全体として失敗しないことに注意してください。



失敗エントリの詳細については、以下で「**失敗エントリを取得する**」を参照してください。

## ジョブのタイムアウト

すべてのユーザーインポートジョブは、**2時間**が経過するとタイムアウトします。ジョブがこの時間制限内に完了しない場合は、失敗としてマークされます。

また、ジョブ関連のデータはすべて24時間後に自動削除され、アクセスできなくなります。そのため、**何らかのストレージメカニズムを使ってジョブ結果を保管することを強くお勧めします**。

## ログエントリを取得する



ユーザーインポートジョブにエラーがある場合には、`GET`要求を[ジョブエラー詳細取得](/api/management/v2#!/Jobs/get_errors)エンドポイントに行って、エラー詳細を取得することができます。必ず、`MGMT_API_ACCESS_TOKEN`および`JOB_ID`のプレースホルダーの値をそれぞれManagement APIのアクセストークンとユーザーインポートジョブIDに置き換えます。



要求に成功すると、以下のような応答を受け取ります。`hash.value`などの機密フィールドは応答内でマスクされます。



それぞれのエラーオブジェクトには、エラーコードとエラー詳細を説明するメッセージが含まれます。以下のようなエラーコードがあります。