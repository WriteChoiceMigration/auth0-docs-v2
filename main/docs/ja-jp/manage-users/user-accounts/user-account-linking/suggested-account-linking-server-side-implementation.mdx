---
og:description: Describes how to link user accounts with a regular web app using server-side
  code using a sample scenario.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: ユーザーアカウントのリンク：サーバー側実装
og:url: https://auth0.com/docs/
permalink: suggested-account-linking-server-side-implementation
title: ユーザーアカウントのリンク：サーバー側実装
twitter:description: Describes how to link user accounts with a regular web app using
  server-side code using a sample scenario.
twitter:title: ユーザーアカウントのリンク：サーバー側実装
---

Auth0は、様々なIDプロバイダーのユーザーアカウントのリンクをサポートします。サーバー側コードを使用して、通常のWebアプリケーションのアカウントをリンクし、続行する前にユーザーに許可を求めることができます。コードは、ユーザーを認証し、メールアドレスを使用してユーザーを検索・特定します。その後、アプリケーションは、ターゲットアカウントの資格情報で認証することで、アカウントをリンクすることをユーザーに促し、アカウントとリンクします。

このサンプルアプリケーションの全ソースは [GitHub](https://github.com/auth0-samples/auth0-link-accounts-sample/tree/master/RegularWebApp)でご覧いただけます。

1. ユーザーをアプリケーションにログインさせる。

ユーザーは [ユニバーサルログイン](/login/universal-login)を使用して、アプリケーションに対して認証を受けます。詳細については、Auth0 Management APIオーディエンスのトークンを要求する（オーディエンス=`https://${account.namespace}/api/v2/`）、[Regular Web App Quickstart（通常のWebアプリクイックスタート）](/quickstart/webapp)をお読みください。
2. 同じメールアドレスを持つユーザーを検索する。

同じ検証済みメール持っているユーザーのユーザープロファイルおよびリストを取得できます。

同じ検証済みメール持っているユーザーレコードの全リストを取得するには、アプリケーションは、`read:users`スコープを持つ[Management APIアクセストークン](/security/tokens/access-tokens/management-api-access-tokens)を使用してAuth0 Management APIの[Get Users By Emailエンドポイント](/api/v2#!/users-by-email/get_users_by_email)を呼び出します。
3. アカウントのリンクをユーザーに促す。

1. Auth0が、一致するメールアドレスを持つ1件以上のレコードを返すと、ユーザーには、アカウントのリンクを促す以下のメッセージと共に、リストが表示されます。
2. ユーザーがアカウントをリンクしたい場合は、アカウントの隣にある**［Link（リンク）］**をクリックします。
4. ユーザーが**［Link（リンク）］**をクリックすると、アプリケーションは、ターゲットアカウントで認証を受けることをユーザーに求め、その後アカウントのリンクを実行します。 

以下のコードスニペットは、メタデータの検証およびマージの方法を示しています。
5. アプリケーションは、`update:users`スコープを持つ[Management APIアクセストークン](/security/tokens/access-tokens/management-api-access-tokens)を使用してAuth0 Management APIの[Link a User Accountエンドポイント](/api/v2#!/Users/post_identities)を呼び出します。

## メタデータマージの例

以下の例は、[Node.js Auth0 SDK for API V2](https://github.com/auth0/node-auth0)を使用して、セカンダリアカウントの `user_metadata`および`app_metadata`をプライマリアカウントにマージする方法を明確に示しています。