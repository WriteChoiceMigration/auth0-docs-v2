---
og:description: Overview of the different ways to verify user emails using Auth0
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: Auth0を使ってメールを検証する
og:url: https://auth0.com/docs/
permalink: verify-emails
title: Auth0を使ってメールを検証する
twitter:description: Overview of the different ways to verify user emails using Auth0
twitter:title: Auth0を使ってメールを検証する
---

ユーザーが提供したメールアドレスを使用する際には、ユーザーがそのメールを実際に使用できるかを確かめることが先決です。これは、ユーザーへのメール送信では常に必要で、検索のインデックスとしてメールを使う場合にも行います。Auth0では、ユーザーが本人であることを確認する方法としては、メールアドレスの使用を推奨していません。

メールの検証は以下のようなアプリケーションには必要不可欠です。

* ユーザーにインデックスを付ける基本的な方法の1つとしてメールアドレスを使用する
* メールをユーザーに送信する
* アカウントのリンクを奨励するのにメールアドレスを使用する
* メールアドレスに結び付けたアカウントをユーザーが作成できるようにする

Auth0 provides several ways to add email verification to your application, as well as [a Marketplace extension](https://marketplace.auth0.com/integrations/auth-0-require-email-verification) that requires users to verify their emails before signing in.

<Warning>

While email verification lowers the risk of accounts being compromised, it is not a perfect solution. Your application may also need other security measures.

</Warning>

## 正しい手法を選択する

メールには検証済または未検証のマークを付ける方法が複数あります。どの手法が最適かを判断するために、ご自身やチームで以下の点を検討してください。

* 識別子とパスワードをAuth0（またはAuth0を介して接続されているデータベース）に保管する（予定）か？
* Auth0に組み込みのメール検証フローを利用できない、特殊なメール検証上の要件があるか？
* 大量のユーザーを検証済メールに一括設定する必要があるか？
* メールの検証が必要になるユーザーがMicrosoft Entra ID、ADFS、その他のエンタープライズ接続からアクセスしてくるか？

識別子とパスワードをAuth0で保管するか、カスタムデータベース接続を使って独自のシステムでユーザーを保管する場合には、おそらくAuth0に[組み込みのメール検証フロー](#magic-link-in-a-verification-email)を使用できます。

特殊な要件があるためAuth0の組み込みフローを利用できない場合や、大量のユーザーを一括設定しなければならない場合には、[APIエンドポイント](#custom-or-bulk-verification-with-the-management-api)をご利用ください。

最後に、エンタープライズ接続からのユーザーを扱う場合、一部の接続には専用のメール検証ワークフローがあります。詳細については、「[特殊な検証の対応](#special-verification-support)」をお読みください。

## メール確認リンク

Auth0でメールを検証する一般的な方法は、ユーザーにメール確認リンクを送信することです。ユーザーがこのリンクをクリックすると、ユーザーの`email_verified`フラグが`true`に設定されます。

**デフォルトで、Auth0はユーザーのサインアップ時にメール確認リンクを送信します。**

Auth0が確認メールを送信するタイミングをカスタマイズすることもできます。たとえば、一括でメールを検証する必要がある場合や、検証済のメールが必要なアクションをユーザーが実行するまで検証を遅らせたい場合などです。

ユーザーが確認メールを受け取るタイミングを制御するには、2つの方法があります。

* Use the [email verification job](https://auth0.com/docs/api/management/v2#!/Jobs/post_verification_email). This triggers Auth0 to send the verification email using the verify email template
* Create an [email verification ticket](https://auth0.com/docs/api/management/v2#!/Tickets/post_email_verification) and send the email yourself, including the ticket the user should use to verify their email

## ワンタイムパスワード

ワンタイムパスワード (OTPs) can be emailed to each new user at the time of account creation to ensure every user has an verified email. Because email verification links can lead to accidental verification by email scanners or the users themselves, OTPs ensures each user actively verifies an existing email address. To use OTPs, your tenant must have [Universal Login](/docs/authenticate/login/auth0-universal-login), [Flexible Identifiers](/docs/authenticate/database-connections/flexible-identifiers-and-attributes), and [Identifer-First login](/docs/authenticate/login/auth0-universal-login/identifier-first) enabled.

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

OTP tokens for phone and email identifier verification have a lifetime of 900 seconds.

</Callout>

To set up OTPs, go to [**Authentication > Database**](https://manage.auth0.com/#/authentication) and select the connection to change, then pick **Attributes**, locate **Email,** choose the menu button,and enable **One-Time Password (OTP)**.

<Frame>![](/images/cdy7uua7fh8z/5SO4gvkdOOZEnPInXrIN1m/5b30204358ac42dcbc3ec0f7e6af9dcf/Email_Config_-_English.png)</Frame>

## 特殊な検証の対応

<Warning>

This works for social and database connections but does not work for enterprise connections. Keep in mind, the `email_verified` field may be overwritten by the social identity provider if the data comes from them.

</Warning>

そのような場合には、[PATCH `/api/v2/users`エンドポイント](/api/management/v2/#!/Users/patch_users_by_id)を使って`email_verified`を`true`に設定します。

In these cases you can use the [PATCH `/api/v2/users` endpoint](https://auth0.com/docs/api/management/v2/#!/Users/patch_users_by_id) to set `email_verified` to `true`.

## そのような場合には、[PATCH `/api/v2/users`エンドポイント](/api/management/v2/#!/Users/patch_users_by_id)を使用して、`email_verified`を`true`に設定します。

For Azure AD and ADFS enterprise connections, Auth0 supports some custom email verification workflows. This can help you ensure users coming from other systems have verified emails in an accurate and secure way. To learn more, read [Email Verification for Azure AD and ADFS](/docs/authenticate/identity-providers/enterprise-identity-providers/azuread-adfs-email-verification).

## Learn more

* [Check API Calls](/docs/troubleshoot/authentication-issues/check-api-calls)
* [Check User Profiles](/docs/troubleshoot/authentication-issues/check-user-profiles)