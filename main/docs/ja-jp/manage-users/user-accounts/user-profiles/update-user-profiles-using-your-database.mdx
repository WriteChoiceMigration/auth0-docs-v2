---
og:description: Learn how to update user profiles when using your own database as
  an identity provider.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: データベースでユーザープロファイルを更新する
og:url: https://auth0.com/docs/
permalink: update-user-profiles-using-your-database
title: データベースでユーザープロファイルを更新する
twitter:description: Learn how to update user profiles when using your own database
  as an identity provider.
twitter:title: データベースでユーザープロファイルを更新する
---

Update user profiles when [using your own database as an identity provider](/docs/authenticate/database-connections/custom-db) by doing the following tasks:

* Use the [Management API](https://auth0.com/docs/api/management/v2#!/Users/patch_users_by_id).
* データベースからAuth0への[ユーザー移行を構成する](/users/import-and-export-users/configure-automatic-migration-from-your-database)
* [Configure user migration](/docs/manage-users/user-migration/configure-automatic-migration-from-your-database) from your database to Auth0.

## 認証に独自のデータベースを使用する場合は、[Management API](/api/management/v2)を使用して次のフィールドを更新できます。

When using your own database for authentication, you can use the [Management API](https://auth0.com/docs/api/management/v2) to update the following fields:

* `user_metadata`
* ユーザーフィールド以外の更新が必要な場合には、独自のデータベースで直接更新します。
* ユーザーフィールド以外の更新が必要な場合には、独自のデータベースで直接更新します。

独自のデータベースでユーザーを更新する

## 独自のデータベースで通常通りにユーザープロファイルを更新することができます。次回ユーザーがログインした際に、Auth0はキャッシュにあるユーザープロファイルを更新します。

カスタムデータベースにあるユーザープロファイルは、任意のユーザープロファイル構造と統合できますが、「ログイン」カスタムデータベーステンプレートが示すように、ログイン呼び出しでAuth0の正規化ユーザープロファイル属性にマッピングする必要があります。

カスタムデータベーステンプレートは、［Connections（接続）］->［Database（データベース）］->［Custom Database（カスタムデータベース）］にあります。スクリプトを編集するには、［Use my own database（独自のデータベースを使用する）］を有効にしてください。

Auth0がユーザープロファイルをキャッシュする方法の概要については、以下の「[ユーザープロファイルのキャッシュ](#user-profile-cache)」のセクションを参照してください。
移行でユーザーを更新する

ユーザーが移行されると、Management APIから、`name`、`nickname`、`given_name`、`family_name`、`picture`、`email`、`email_verified`などのフィールドを更新することもできます。

## ただし、[正規化ユーザープロファイル](/users/user-profiles/normalized-user-profiles)で説明されているように、他のユーザーフィールドを更新するルールは引き続き適用されます。

If you have [enabled user migration](/docs/manage-users/user-migration/configure-automatic-migration-from-your-database), and a user has already been migrated to the Auth0 database, then Auth0 will not query your database again for the user profile. Therefore, all changes made in the custom database for that user will never reflect in Auth0.

Once a user has been migrated, you will also be able to update fields, such as `name`, `nickname`, `given_name`, `family_name`, `picture`, `email`, and `email_verified` via the <Tooltip tip="Management API: A product to allow customers to perform administrative tasks." cta="View Glossary" href="/docs/glossary?term=Management+API">Management API</Tooltip>.

However, rules for updating other user fields will still apply as described in the [Normalized User Profile](/docs/manage-users/user-accounts/user-profiles/normalized-user-profiles).

## User profile cache

Auth0 caches the user profile received from a [database connection](/docs/authenticate/database-connections) before sending it to the client application. This cache is stored in the Auth0 database and is refreshed each time the user authenticates.

The cached values for the [Normalized User Profile](/docs/manage-users/user-accounts/user-profiles/normalized-user-profile-schema) fields are based on the values returned from the Login Script of your custom database connection.

The User Profile is cached for several reasons. First, caching allows you the option of implementing [Single Sign-on (SSO)](/docs/authenticate/single-sign-on) at the Auth0 layer to avoid going to the connection for every request. Additionally, this provides resilience if a connection is temporarily unavailable.

## Learn more

* [Check API Calls](/docs/troubleshoot/authentication-issues/check-api-calls)
* [Check User Profiles](/docs/troubleshoot/authentication-issues/check-user-profiles)