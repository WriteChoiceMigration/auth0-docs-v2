---
og:description: Outlines proper usage of the email_verified field in a user profile.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: 確認済みのメールをユーザープロファイルで使用する
og:url: https://auth0.com/docs/
permalink: verified-email-usage
title: 確認済みのメールをユーザープロファイルで使用する
twitter:description: Outlines proper usage of the email_verified field in a user profile.
twitter:title: 確認済みのメールをユーザープロファイルで使用する
---

The `email_verified` field of a user profile indicates whether the user has verified their email address. Email verification is optional, but valid email addresses are required for certain actions, such as sending email communications, password reset/recovery links, and <Tooltip tip="Passwordless: Form of authentication that does not rely on a password as the first factor." cta="View Glossary" href="/docs/glossary?term=passwordless">passwordless</Tooltip> magic links to users.

メールは通常、ユーザーアカウントが作成された直後か、ユーザーがアプリケーションに初めてログインしたときに確認されます。サインアップを行う当人がその時点でメールアドレスの実際の所有者であると判定するのに有効な方法です。

メール確認はその特定の時点で一度だけ行われるため、後でそのユーザーアカウントにログインした人が確認済みのメールアドレスをまだ所有しているかどうか確かめることはできません。

In case of federated <Tooltip tip="Identity Provider (IdP): Service that stores and manages digital identities." cta="View Glossary" href="/docs/glossary?term=identity+providers">identity providers</Tooltip>, they sometimes report if the user has a verified email, and based on that, Auth0 sets the `email_verified` field in the user profile. This, however, transfers the responsibility to the identity provider to do it properly - something we can't ensure. We also don't know if the verified email from that provider is still owned by the user.

こうした理由から、確認済みのメールから何が想定できるか、慎重に考える必要があります。

## Auth0はいつメールを確認済みに設定するのか?

When users signup with email and password, they get a verification email with a link. When they click the link, Auth0 verifies their email. To learn more, read [Customize Email Templates](/docs/customize/email/email-templates).

ユーザーがフェデレーションIDプロバイダー（ソーシャルやエンタープライズ接続など）で認証を行うと、`email_verified`フィールドの値はIDプロバイダーがユーザープロファイルで返す値に一致します。IDプロバイダーが何も値を返さない場合は、`false`に設定されます。

## 確認済みのメールとアカウントのリンク

When you want to [link two user accounts](/docs/manage-users/user-accounts/user-account-linking), you need to make sure that the user still has access to both accounts. The only way to achieve that is to have users authenticate with both accounts before linking them.

Travel0の社員であるJohn Doeが、自分の会社メール（`john.doe@travel0.com`）とパスワードを使ってサイトにサインアップします。数か月後に会社を辞めた後、同姓同名の別のJohn Doeが新たに採用されます。メールアカウントは同じです。この人物が同じWebサイトにアクセスし、会社のIDプロバイダー（Google Workspaceなど）で認証を行うと、アカウントは別のユーザーに自動的にリンクされてしまいます。

* フェデレーションIDプロバイダーは、メール確認の処理方法を間違えて、ユーザーが所有していないメールを所有していると報告する場合があります。
* その一方で、以下のようなシナリオを軽減するために、アカウントをリンクさせる前に、`email_verified`フィールドを確認することを推奨します。

攻撃者がGoogleアカウント（`attacker@gmail.com`）を作成する

* 攻撃者が被害者のメール（`victim@hotmail.com`など）で新しいデータベースユーザーを作成する
* 攻撃者が両方のアカウントをリンクする
* 攻撃者がフィッシング攻撃を被害者に仕掛ける
* 被害者がサインアップしようとすると、ユーザーはすでに存在すると言われ、パスワードをリセットするよう求められる
* ユーザーがパスワードを入力し攻撃者のアカウントにログインしたため、被害者がアプリケーションで入力するあらゆるデータに不正アクセスされてしまう
* 確認済みのメールと認可の決定

## メールを完全に信用できないのと同じで、メールのドメインも完全に信用してはなりません。

アプリケーションがユーザーの雇用主に基づいてアクセスを制限する必要がある場合、ユーザーが特定の企業ドメインからのメールでログインしているからといって、アクセスが付与されるべきものとして保証するものではありません。

アプリケーションで顧客が新しいアカウントにサインアップし、別の会社の社員が会社の資格情報を使用して認証を行うとします。この場合、`user@acme.com`アカウントでサインアップしたユーザーに、acme.comの企業ディレクトリで認証を行うユーザーと同じ機能セットへのアクセスを付与してはなりません。

アプリケーションがEntra IDでの認証に対応し、ディレクトリがゲストユーザーに対応している場合、そのEntra IDテナントからログインするどんなドメインのユーザーでもアクセスできてしまいます。そのテナントで認証を行う残りのユーザーと同じアクセスレベルをゲストユーザーに付与してはなりません。

* 一般には、**メールのドメインを使用して認可の決定を行わない**よう推奨します。ユーザーが特定のOrganizationに属するかどうか確認する必要がある場合は、認証に使用した接続またはEntra IDのテナントIDなど接続固有の属性を使用するとよいでしょう。
* If your application supports authenticating with Azure AD, and the directory supports guest users, you can get users from any domain logging-in from that Azure AD tenant. You should not give guest users the same access level as the rest of the users authenticating with that tenant.

As a general recommendation, **you should not use the email's domain to make authorization decisions**. If you need to check if the user belongs to a specific organization, it's better to rely on the connection they used to authenticate, or in connection-specific attributes like the Azure AD's tenant id.

## Learn more

* [Link User Accounts](/docs/manage-users/user-accounts/user-account-linking/link-user-accounts)
* [User-Initiated Account Linking: Client-Side Implementation](/docs/manage-users/user-accounts/user-account-linking/user-initiated-account-linking-client-side-implementation)
* [User Account Linking: Server-Side Implementation](/docs/manage-users/user-accounts/user-account-linking/suggested-account-linking-server-side-implementation)