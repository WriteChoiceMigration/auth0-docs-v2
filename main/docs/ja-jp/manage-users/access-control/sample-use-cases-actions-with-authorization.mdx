---
description: ''
og:description: Learn how to use Actions with roles-based access control (RBAC).
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: サンプルユースケース：認可のあるActions
og:url: https://auth0.com/docs/
permalink: sample-use-cases-actions-with-authorization
title: サンプルユースケース：認可のあるActions
twitter:description: Learn how to use Actions with roles-based access control (RBAC).
twitter:title: サンプルユースケース：認可のあるActions
---

Auth0 [Actions](/actions)は、事前構成された[認可ポリシー](/authorization-policies)の決定結果を修正または補完できるため、[Role-based Access Control（RBAC）](/rbac)だけでは対応できないより複雑なケースを処理することができます。Actionsは実行順序に基づいて、アクセストークンにアクセス許可が追加される前に、認可での決定を変更することができます。また、トークンの内容をカスタマイズすることもできます。

## 特定のアプリケーションに平日のみのアクセスを許可する

たとえば、平日のみにアクセスを許可したいアプリケーションがあるとします。[新しいアクションを作成](/actions/write-your-first-action)し、ログインフローにアクションを追加するために`Login / Post Login`トリガーを選択します。以下のコードを［Actions Code Editor（アクションコードエディター）］にコピーします。



そして、作成したアクションを[ログインフロー](%24%7Bmanage_url%7D/#/actions/flows/login/)に追加します。Actionsをフローにアタッチする方法については、「[初めてアクションを作成する](/actions/write-your-first-action)」の「アクションをフローにアタッチする」セクションをお読みください。

ユーザーが週末にアプリケーションにアクセスしようとした場合には、たとえ認証され、適切な権限があったとしても、アクセスが拒否されます。

## 企業ネットワーク内部のユーザーにのみアクセスを許可する

たとえば、アプリケーションへのアクセスを許可するのに、企業ネットワークの内側からアクセスするユーザーに限定したいとします。[新しいアクションを作成](/actions/write-your-first-action)し、ログインフローにアクションを追加するために`Login / Post login`トリガーを選択します。以下のコードをActionsコードエディターにコピーします。



そして、作成したアクションを[ログインフロー](%24%7Bmanage_url%7D/#/actions/flows/login/)に追加します。Actionsをフローにアタッチする方法については、「[初めてアクションを作成する](/actions/write-your-first-action)」の「アクションをフローにアタッチする」セクションをお読みください。

ユーザーが企業ネットワークの外側にいる場合には、たとえ認証に成功して、適切な権限があったとしても、アクセスが拒否されます。



## APIを呼び出すユーザーすべてのアクセスを拒否する

たとえば、APIを呼び出すユーザーのすべてに対して、アクセスを拒否したいとします。つまり、[［Auth0 Dashboard］ > ［Applications（アプリケーション）］ > ［APIs］](%24%7Bmanage_url%7D/#/apis)から、**APIオーディエンス**フィールドに記載された`識別子`の値に基づいてアクセスを拒否する必要があります。[新しいアクションを作成](/actions/write-your-first-action)し、ログインフローにアクションを追加するために`Login / Post login`トリガーを選択します。以下のコードをActionsコードエディターにコピーします。



そして、作成したアクションを[ログインフロー](%24%7Bmanage_url%7D/#/actions/flows/login/)に追加します。Actionsをフローにアタッチする方法については、「[初めてアクションを作成する](/actions/write-your-first-action)」の「アクションをフローにアタッチする」セクションをお読みください。

この場合、APIの`identifier`の値は`https://api.example.com`であり、これが拒否する対象となるオーディエンスです。

## ユーザーのロールをトークンに追加する

Auth0が発行したトークンにユーザーロールを追加するには、`event.authorization`オブジェクトと`api.idToken.setCustomClaim`および`api.accessToken.setCustomClaim`メソッドを使用します。[新しいアクションを作成](/actions/write-your-first-action)し、ログインフローにアクションを追加するために`Login / Post login`トリガーを選択します。以下のコードをActionsコードエディターにコピーします。



そして、作成したアクションを[ログインフロー](%24%7Bmanage_url%7D/#/actions/flows/login/)に追加します。Actionsをフローにアタッチする方法については、「[初めてアクションを作成する](/actions/write-your-first-action)」の「アクションをフローにアタッチする」セクションをお読みください。

注意：

* 要求元のアプリケーションに返されるJWTは、トリガー処理の終わりに作成され、署名されます。最終の署名されたJWTは、アクションでは処理できません。