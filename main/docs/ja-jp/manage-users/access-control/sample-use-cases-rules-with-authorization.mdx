---
description: ''
og:description: Learn how to use rules with roles-based access control (RBAC). For
  use with our Authorization Core feature set.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: サンプルユースケース：認可を使ったルール
og:url: https://auth0.com/docs/
permalink: sample-use-cases-rules-with-authorization
title: サンプルユースケース：認可を使ったルール
twitter:description: Learn how to use rules with roles-based access control (RBAC).
  For use with our Authorization Core feature set.
twitter:title: サンプルユースケース：認可を使ったルール
---



[ルール](/rules)を使うことで、事前構成された[認可ポリシー](/authorization-policies)の決定結果を修正または補完できるため、[Role-based Access Control（RBAC）](/rbac)だけでは対応できないより複雑なケースを処理することができます。ルールは実行順序に基づいて、アクセストークンにアクセス許可が追加される前に、認可での決定を変更することができます。また、トークンの内容をカスタマイズすることもできます。

## 特定のアプリケーションに平日のみのアクセスを許可する

たとえば、平日のみにアクセスを許可したいアプリケーションがあるとします。これを行うには、[以下のルールを作成します](/rules/create-rules)。



ユーザーが週末にアプリケーションにアクセスしようとした場合には、たとえ認証され、適切な権限があったとしても、アクセスが拒否されます。

## 企業ネットワーク内部のユーザーにのみアクセスを許可する

たとえば、アプリケーションへのアクセスを許可するのに、企業ネットワークの内側からアクセスするユーザーに限定したいとします。これを行うには、以下のルールを作成します。



ユーザーが企業ネットワークの外側にいる場合には、たとえ認証に成功して、適切な権限があったとしても、アクセスが拒否されます。

## APIを呼び出すユーザーすべてのアクセスを拒否する

たとえば、APIを呼び出すユーザーのすべてに対して、アクセスを拒否したいとします。つまり、[［Dashboard］ > ［Applications（アプリケーション）］ > ［APIs］](%24%7Bmanage_url%7D/#/apis)の**APIオーディエンス**フィールドに記載されたAPIの`オーディエンス`の値に基づいてアクセスを拒否する必要があります。これを行うには、以下のルールを作成します。



この場合、APIの`オーディエンス`の値は`http:://todoapi2.api`であり、これが拒否する対象となるオーディエンスです。誰かがこの`オーディエンス`値でAPIへのアクセスを試みた場合、アクセスが拒否され、`HTTP 401`応答を受け取ります。

## ユーザーのロールをトークンに追加する

「Add Permissions in the Access Token（アクセストークンに許可を追加）」と一緒に[APIのRBACを有効にした場合](/apis/enable-role-based-access-control-for-apis)（またはManagement APIを介してRBACを有効にし、**［Token Dialect（トークンダイアレクト）］**を`access_token_authz`に設定した場合）、アクセストークンでユーザー権限を受け取ります。ユーザーのロールをトークンに追加するには、以下のルールを作成するときに`context.authorization`オブジェクトを使用します。



## Authorization Core（認可コア）機能セットでDelegated Administration Extension（DAE、委任管理拡張機能）を管理する

[Delegated Administration Extension（DAE：委任管理拡張機能）](/extensions/delegated-administration-extension)とAuthorization Core（認可コア）は全く別の機能ですが、ルールを使用する場合、Authorization Core（認可コア）機能セットを使用すると、DAEのロールを作成し、管理することができます。

1. Authorization Core（認可コア）機能セットを使用して[DAEロールを作成します](/rbac/roles/create-roles)。作成したロールの名前は必ず、[あらかじめ定義されたDAEロール](/extensions/delegated-admin#assign-roles-to-users)と一致しなければなりません。
2. Authorization Core（認可コア）機能セットを使用して、[作成したDAEロールを適切なユーザーに割り当てます](/rbac/rbac-users/assign-roles-to-users)。
3. ユーザーのロールをIDトークンにあるDAEの名前空間に追加します。これを行うには、[以下のルールを作成します](/rules/create-rules)。`CLIENT_ID`プレースホルダー値をアプリケーションのクライアントIDに置き換えることを忘れないでください。