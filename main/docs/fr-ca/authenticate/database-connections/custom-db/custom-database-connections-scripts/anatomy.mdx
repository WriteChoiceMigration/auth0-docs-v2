---
og:description: Learn about best practices for custom database connection anatomy.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: Meilleures pratiques en matière d’anatomie de connexion à la base de données
  personnalisées
og:url: https://auth0.com/docs/
permalink: anatomy
title: Meilleures pratiques en matière d’anatomie de connexion à la base de données
  personnalisées
twitter:description: Learn about best practices for custom database connection anatomy.
twitter:title: Meilleures pratiques en matière d’anatomie de connexion à la base de
  données personnalisées
---

You typically use a custom database connection to provide access to your own legacy identity store for authentication (sometimes referred to as **legacy authentication**) or [perform user import through automatic migration](/docs/manage-users/user-migration/configure-automatic-migration-from-your-database) (often referred to as **trickle** or **lazy** migration). You can also use custom database connections to proxy access to an Auth0 tenant in scenarios where you use Auth0 multi-tenant architecture. To learn more, read [Multi-Tenant Applications Best Practices](/docs/get-started/auth0-overview/create-tenants/multi-tenant-apps-best-practices).

You typically create and configure custom database connections using the <Tooltip tip="Auth0 Dashboard: Auth0's main product to configure your services." cta="View Glossary" href="/docs/glossary?term=Auth0+Dashboard">Auth0 Dashboard</Tooltip>. You create a database connection and then toggle **Use my own database** to enable editing of the database action scripts. A custom database connection can also be created and configured with the Auth0 <Tooltip tip="Management API: A product to allow customers to perform administrative tasks." cta="View Glossary" href="/docs/glossary?term=Management+API">Management API</Tooltip> [Create a connection endpoint](https://auth0.com/docs/api/management/v2#!/Connections/post_connections) and the `auth0` strategy.

<Frame>![Auth0 Dashboard Authentication Database Connection Custom Database Settings Use Own Database Enabled](/images/cdy7uua7fh8z/11HPAdVwJMmnWbzMVjHCJ8/f75ff47f613a41778f266643f29ab2b1/2025-02-27_17-25-36.png)</Frame>

Comme indiqué ci-dessous, vous utilisez des connexions à la base de données personnalisées dans un flux de connexion afin d’obtenir des informations sur l’identité de l’utilisateur à partir de votre propre magasin d’identités hérité pour l’authentification ou l’importation d’utilisateurs.

<Frame>![Custom Database Connection Flow](/images/cdy7uua7fh8z/1H2Ky1WyPlZ9zHZrEVlFhP/4e4856395fac6d6339c883c35d4b4ac0/custom-database-connections.png)</Frame>

Outre les artefacts communs à tous les types de connexion à la base de données, une connexion à la base de données personnalisée vous permet de configurer des scripts d’action, c’est-à-dire du code personnalisé utilisé lors de l’interface avec les magasins d’identités hérités. Les scripts que vous choisissez de configurer dépendent de si vous créez une connexion pour l’authentification héritée ou pour la migration automatique.

Action scripts can be implemented as anonymous functions; however, anonymous functions make it hard to debug when it comes to interpreting the call-stack generated as a result of any exceptional error conditions. For convenience, we recommend providing a function name for each action script. To see some recommended names, read [Custom Database Action Script Execution Best Practices](/docs/authenticate/database-connections/custom-db/custom-database-connections-scripts/execution).

In a legacy authentication scenario, no new user record is created; the user remains in the legacy identity store and Auth0 uses the identity it contains when authenticating the user. Custom database connections are also used outside of the <Tooltip tip="Universal Login: Your application redirects to Universal Login, hosted on Auth0's Authorization Server, to verify a user's identity." cta="View Glossary" href="/docs/glossary?term=Universal+Login">Universal Login</Tooltip> workflow. For example, a connection's `changePassword` action script is called when a password change operation occurs for a user that resides in a legacy identity store.

## Migration automatique

Pendant la migration automatique, Auth0 crée un nouvel utilisateur dans un magasin d’identité (base de données) géré par Auth0. Auth0 utilise l’identité contenue dans le magasin d’identité géré par Auth0 lors de l’authentification de l’utilisateur. Pour ce faire, Auth0 exige premièrement que l’utilisateur soit authentifié auprès du magasin d’identité hérité, et ce n’est qu’en cas de succès que le nouvel utilisateur sera créé dans la base de données gérée par Auth0. Auth0 crée le nouvel utilisateur en utilisant le même ID et le même mot de passe que ceux fournis lors de l’authentification.

La création d’utilisateurs dans un scénario de migration automatique se produit généralement une fois que le script d’action de Connexion s’achève. Nous vous recommandons de ne pas essayer de supprimer les utilisateurs issus d’un magasin d’identités hérité en tant qu’opération incorporée dans le script Connexion, mais plutôt comme un processus indépendant. Cela permet d’éviter la suppression accidentelle d’un utilisateur en cas d’erreur lors de la migration.

Avec la migration automatique, les utilisateurs restent dans le magasin d’identités hérité et peuvent être supprimés ou archivés si nécessaire. Un effet secondaire peut se produire lorsqu’un utilisateur est supprimé d’Auth0 mais reste dans le magasin de données hérité. Dans ce cas, une connexion effectuée par l’utilisateur supprimé pourrait entraîner l’exécution du script Login (Connexion) ou Get User (Obtenir un utilisateur) et une nouvelle migration de l’utilisateur à partir du magasin d’identités hérité.

Nous vous recommandons de marquer les identités des utilisateurs de magasins hérités comme migrées avant la fin des scripts Login ou Get User et avant toute suppression éventuelle de magasins hérités afin d’éviter la recréation involontaire d’utilisateurs supprimés intentionnellement.

## Poids

Nous recommandons l’utilisation d’un script d’action dont le poids total ne dépasse pas 100 Ko. Plus il est lourd, plus la latence est importante en raison du processus d’emballage et de transport utilisé par la plateforme Auth0, ce qui aura un impact sur les performances de votre système. Notez que la limite de 100 ko n’inclut pas les modules `npm` qui peuvent être référencés dans le cadre d’une déclaration d’ `exigence` .

## Learn more

* [Custom Database Connection Security Best Practices](/docs/authenticate/database-connections/custom-db/custom-database-connections-scripts/connection-security)
* [Custom Database Action Script Execution Best Practices](/docs/authenticate/database-connections/custom-db/custom-database-connections-scripts/execution)
* [Custom Database Action Script Environment Best Practices](/docs/authenticate/database-connections/custom-db/custom-database-connections-scripts/environment)