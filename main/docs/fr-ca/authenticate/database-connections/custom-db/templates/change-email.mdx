---
og:description: Describes the custom database action script for changing a user's
  email.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: Modifier le modèle de script de courriel
og:url: https://auth0.com/docs/
permalink: change-email
title: Modifier le modèle de script de courriel
twitter:description: Describes the custom database action script for changing a user's
  email.
twitter:title: Modifier le modèle de script de courriel
---

Le script Change Email (Modifier le courriel) met en œuvre la fonction définie lorsque l’adresse de courriel d’un utilisateur ou son statut de vérification de l’adresse courriel change. Nous recommandons de nommer cette fonction `changeEmail` (Modifier le courriel).

The script is only used in a [legacy authentication scenario](/docs/authenticate/database-connections/custom-db/overview-custom-db-connections), and is required if you want to update a user's email address (and/or email address verification status) in Auth0 and your external database in the same operation.

The Change Email script is not configurable through the <Tooltip tip="Auth0 Dashboard: Auth0's main product to configure your services." cta="View Glossary" href="/docs/glossary?term=Auth0+Dashboard">Auth0 Dashboard</Tooltip>. To manage this script, you must use the Auth0 <Tooltip tip="Management API: A product to allow customers to perform administrative tasks." cta="View Glossary" href="/docs/glossary?term=Management+API">Management API</Tooltip> [Create a connection](https://auth0.com/docs/api/management/v2#!/Connections/post_connections) or [Update a connection](https://auth0.com/docs/api/management/v2#!/Connections/patch_connections_by_id) endpoint, or the [Auth0 Deploy CLI](/docs/deploy-monitor/deploy-cli-tool).

<Warning>

If you manage a custom database connection's Database Action Scripts through the Auth0 Dashboard, the Change Email script will be automatically deleted upon saving.

To ensure that the Change Email script is not removed accidentally, use the Auth0 Management API or Auth0 Deploy CLI when managing the connection.

If you manually change a user's email in your custom database, you must patch the user separately; Auth0 will not automatically detect the change.

</Warning>

## Fonction changeEmail

La fonction changeEmail devrait :

* Mettre à jour de l’adresse courriel de l’utilisateur dans la base de données externe.
* Renvoyer une erreur si l’opération a échoué ou si une erreur s’est produite.

### Définition

La fonction `changeEmail` accepte quatre paramètres et renvoi à une fonction de `callback` :

```js lines
changeEmail(email, newEmail, verified, callback): function
```






<table class="table"><thead>
<tr>
<th><strong>Parameter</strong></th>
<th><strong>Type</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>email</code></td>
<td>String</td>
<td>User's current email address.</td>
</tr>
<tr>
<td><code>newEmail</code></td>
<td>String</td>
<td>Value to be set as user's new email address in external database.</td>
</tr>
<tr>
<td><code>verified</code></td>
<td>Boolean</td>
<td>Email verification status of the new email address.</td>
</tr>
<tr>
<td><code>callback</code></td>
<td>Function</td>
<td>Used to pass error data through the pipeline.</td>
</tr>
</tbody>
</table>

### Exemple

Il s’agit d’un exemple pseudo-JavaScript de la manière dont vous pourriez implémenter la fonction `changeEmail` :

```javascript lines expandable
function (email, newEmail, verified, callback) {
  // Prepare the API call
  let options = {
    url: "https://example.com/api/users",
    action: "PATCH",
    body: {
      email: email,
      new_email: newEmail,
      email_verified: verified
    }
  };

  // Call the API
  send(options, err => {
    // Return `false` value in callback if operation failed
    if (err && err.id == "FAIL_CHANGE_EMAIL") {
      return callback(null, false);
    } else if (err) {
      // Return error in callback if unspecified error occurred
      return callback(new Error("My custom error message."));
    }

    // Return `true` value in callback if operation succeeded
    return callback(null, true);
  });
}
```






## Fonction de rappel

La fonction de `callback` accepte deux paramètres et renvoie une fonction.

### Définition

```js lines
callback(error, operationResult): function
```






<table class="table"><thead>
<tr>
<th><strong>Parameter</strong></th>
<th><strong>Type</strong></th>
<th><strong>Required</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>error</code></td>
<td>Object</td>
<td>Required</td>
<td>Contains error data.</td>
</tr>
<tr>
<td><code>operationResult</code></td>
<td>Boolean</td>
<td>Optional</td>
<td>Indicates the result of the change email operation.</td>
</tr>
</tbody>
</table>

### Retourne un succès

Si l’opération de modification de courriel est réussie, renvoyez la fonction de `callback`, et passez à une valeur `null` comme paramètre d’`error` et une valeur `true` comme paramètre `operationResult` :

```js lines
return callback(null, true);
```






### Renvoyer un échec

Si l’opération de modification du courriel a échoué, renvoyez la fonction de `callback`, et passez à une valeur `null` comme paramètre d’`error` et une valeur `false` comme paramètre `operationResult` :

```js lines
return callback(null, false);
```






### Renvoyer une erreur

Si une erreur survient, renvoyez la fonction de `callback`, et passer l’information pertinente concernant l’erreur comme paramètre `error` :

```js lines
return callback(new Error("My custom error message."));
```






## Learn more

* [Change Password Script Templates](/docs/authenticate/database-connections/custom-db/templates/change-password)
* [Create Script Templates](/docs/authenticate/database-connections/custom-db/templates/create)
* [Delete Script Templates](/docs/authenticate/database-connections/custom-db/templates/delete)
* [Get User Script Templates](/docs/authenticate/database-connections/custom-db/templates/get-user)
* [Login Script Templates](/docs/authenticate/database-connections/custom-db/templates/login)
* [Verify Script Templates](/docs/authenticate/database-connections/custom-db/templates/verify)