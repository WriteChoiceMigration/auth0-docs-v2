---
og:description: Learn how to create a database connection.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: Créer des connexions de base de données personnalisée
og:url: https://auth0.com/docs/
permalink: create-db-connection
title: Créer des connexions de base de données personnalisée
twitter:description: Learn how to create a database connection.
twitter:title: Créer des connexions de base de données personnalisée
---

<Card title="Availability varies by Auth0 plan">

Your Auth0 plan or custom agreement affects whether this feature is available. To learn more, read [Pricing](https://auth0.com/pricing).

</Card>

If you have your own user database, you can use it as an <Tooltip tip="Identity Provider (IdP): Service that stores and manages digital identities." cta="View Glossary" href="/docs/glossary?term=identity+provider">identity provider</Tooltip> in Auth0 to authenticate users. In this process, you will create the custom database connection, create database action scripts, and add configuration parameters.

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

Make sure that your database has the appropriate fields to store user profiles attributes, such as `id`, `nickname`, `email`, and `password`. To learn about Auth0's user profile schema, read [Normalized User Profiles](/docs/manage-users/user-accounts/user-profiles/normalized-user-profiles). To learn more about updating user profiles, read [Update User Profiles Using Your Database](/docs/manage-users/user-accounts/user-profiles/update-user-profiles-using-your-database).

</Callout>

Auth0 vous permet de créer des connexions et des scripts pour la plupart des bases de données couramment utilisées, notamment :

* Fournisseur d’adhésion ASP.NET
* MongoDB
* MySQL
* PostgreSQL
* SQLServer
* Base de données SQL de Windows Azure
* Services Web accessibles via Auth de base

You can connect to any kind of database or web service with a properly-configured custom script. Note that input sanitization must be completed on the customer end; Auth0 does not sanitize or validate any username/password combination passed by a custom database. Base de données personnalisée scripts are subject to Auth0's [Rate Limit Policy](/docs/troubleshoot/customer-support/operational-policies/rate-limit-policy).

<Card title="Network firewall">

If you are behind a firewall, this feature may require that you add the appropriate Auth0 IP addresses to the Allow List to work properly.

</Card>

## Créer la connexion dans Auth0 Dashboard

1. Navigate to [Auth0 Dashboard > Authentication > Database](https://manage.auth0.com/#/connections/database), and select **Create DB Connection**.
2. Configure the connection's settings, and click **Create**:

<table class="table"><thead>
<tr>
<th><strong>Parameter</strong></th>
<th><strong>Definition</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Name</strong></td>
<td>The name of the connection. The name must start and end with an alphanumeric character, contain only alphanumeric characters and dashes, and not exceed 35 characters.</td>
</tr>
<tr>
<td><strong>Requires Username</strong></td>
<td>Forces users to provide a username <em>and</em> email address during registration.</td>
</tr>
<tr>
<td><strong>Username Length</strong></td>
<td>Sets the minimum and maximum length for a username.</td>
</tr>
<tr>
<td><strong>Disable Sign Ups</strong></td>
<td>Prevents signups to your application. You will still be able to create users with your API credentials or via the Auth0 Dashboard.</td>
</tr>
</tbody>
</table>

   Une fois que Auth0 a créé votre connexion, vous disposerez des affichages suivants (en plus de l’affichage des **settings [paramètres]**) :
   * Attributs
   * Méthodes d’authentification
   * Base de données personnalisée
   * Applications
3. Select the **Custom Database** view, and enable the **Use my own database** switch.

   <Frame>![Enable Base de données personnalisée Use My Own Database Option](/images/cdy7uua7fh8z/3kgHDpBFdVWNq9XOfhsTXI/2efa43e44793b8dd69b9f9e8b54bf752/2025-02-25_10-20-20.png)</Frame>

## Créer les scripts d’action de la base de données.

L’activation du bouton bascule **Use my own database (Utiliser ma propre base de données) **active les **scripts d’action de la base de données** dans laquelle vous allez créer des scripts afin de configurer le mode d’authentification lors de l’utilisation de votre base de données. Vous pouvez écrire vos scripts d’action de base de données, ou vous pouvez sélectionner un modèle dans la liste déroulante des **Templates (Modèles)** et le modifier, si nécessaire.

Vous ** must (devez)** configurer un script de `login`. Les scripts additionnels pour les fonctionnalités utilisateur sont facultatifs.

Les scripts d’action de base de données incluent :

<table class="table"><thead>
<tr>
<th><strong>Name</strong></th>
<th><strong>Description</strong></th>
<th><strong>Parameters</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Login</strong> <br/><span class="label label-danger">Required</span></td>
<td>Executes each time a user attempts to log in.</td>
<td><code>email</code>, <code>password</code></td>
</tr>
<tr>
<td><strong>Create</strong></td>
<td>Executes when a user signs up.</td>
<td><code>user</code></td>
</tr>
<tr>
<td><strong>Verify</strong></td>
<td>Executes after a user follows the verification link.</td>
<td><code>email</code></td>
</tr>
<tr>
<td><strong>Change Password</strong></td>
<td>Executes when a user clicks on the confirmation link after a reset password request.</td>
<td><code>email</code>, <code>newPassword</code></td>
</tr>
<tr>
<td><strong>Get User</strong></td>
<td>Retrieves a user profile from your database without authenticating the user.</td>
<td><code>email</code></td>
</tr>
<tr>
<td><strong>Delete</strong></td>
<td>Executes when a user is deleted using the API or Auth0 Dashboard.</td>
<td><code>id</code></td>
</tr>
</tbody>
</table>

To learn more about the scripts, read [Custom Database Action Script Templates](/docs/authenticate/database-connections/custom-db/templates) and [Custom Database Action Script Execution Best Practices](/docs/authenticate/database-connections/custom-db/custom-database-connections-scripts/execution).

### Créer un script de connexion

<Card title="Avoid user ID collisions with multiple databases">

The `id` (or alternatively `user_id`) property in the returned user profile will be used by Auth0 to identify the user.

If you are using multiple custom database connections, then `id` value must be unique across all the custom database connections to avoid user ID collisions. Our recommendation is to prefix the value of `id` with the connection name (omitting any whitespace). To learn more about user IDs, read [Identify Users](/docs/manage-users/user-accounts/identify-users).

</Card>

Les étapes suivantes utilisent un exemple de script pour se connecter à la base de données MySQL.

1. After toggling the **Use my own database** switch, the **Database Action Scripts** area is enabled. Make sure you are on the **Login** tab.
2. Use the **Templates** dropdown to select the MySQL database script template.

   ```javascript lines expandable
   function login(email, password, callback) {
     var bcrypt = require('bcrypt');
     var mysql = require('mysql');
     var connection = mysql.createConnection({
       host: 'localhost',
       user: 'me',
       password: 'secret',
       database: 'mydb'
     });
     connection.connect();
     var query = "SELECT id, nickname, email, password " +
       "FROM users WHERE email = ?";
     connection.query(query, [email], function (err, results) {
       if (err) return callback(err);
       if (results.length === 0) return callback(new WrongUsernameOrPasswordError(email));
       var user = results[0];
       bcrypt.compare(password, user.password, function (err, isValid) {
         if (err) {
           callback(err);
         } else if (!isValid) {
           callback(new WrongUsernameOrPasswordError(email));
         } else {
           callback(null, {
             // This prefix (replace with your own custom DB name)
             // ensure uniqueness across different custom DBs if there's the
             // possibility of collisions (e.g. if the user ID is an email address or an integer)
             id: 'MyConnection1|' + user.id.toString(),
             nickname: user.nickname,
             email: user.email
           });
         }
       });
     });
   }
   ```


   

   

   Avec la méthode `bcrypt.compareSync`, il vérifie ensuite si les mots de passe correspondent, puis, si c’est le cas, il renvoie un objet contenant les informations du profil utilisateur, y compris l’`id`, le `nickname` et l’`email`.
   Ce script suppose que vous avez une tableau `users` contenant ces colonnes. L’`id` retourné par le script de connexion est utilisé pour construire l’attribut identifiant utilisateur du profil utilisateur.
   Les modèles de script ne sont pas utilisés par Auth0 tant que vous n’avez pas cliqué sur **Save (Enregistrer)** ou **Try (Essayer)**. Ceci est vrai même si vous n’avez modifié qu’un seul script, sans toucher aux autres. Vous devez cliquer sur **Save (Enregistrer)** au moins une fois pour que tous les scripts soient en place.
3. Click **Save and Try**.
4. In the pop-up modal, enter your email and password and click **Try**. This provides a dropdown to select from a list of available runtimes, with your current runtime on top.

   <Frame>![Modal to try the login script.](/images/cdy7uua7fh8z/8uBGZhHYZwOcO19ljJNNp/ccd69d84fdbdff90dc779a6b1ea8a6fd/Try_the_Login_Script_-_English.png)</Frame>

Soutien aux organizations en matière de bases de données personnalisées

## Si vous utilisez des connexions par base de données personnalisée en conjonction avec Organizations, vous pouvez utiliser le paramètre `context` dans la signature du script pour rendre les détails de l’organization tels que l’`id`, `name` et `metadata` disponibles pour vos scripts d’action de base de données personnalisée. Les données de l’organization sont envoyées dans l’objet contexte lorsque l’action correspondante se produit dans le contexte de l’organization. Par exemple, lorsqu’un utilisateur s’authentifie à l’invite de connexion d’une organization, le script d’action de connexion est transmis. Pour en savoir plus, consultez [Connexions à la base de données](/connections/database).

If you use custom database connections in conjunction with Organizations, you can use the `context` parameter in the script signature to make Organization details like `id`, `name`, and `metadata` available to your custom database action scripts. Organization data is passed in the context object when the associated action happens in the context of an organization; for example, when a user authenticates on an organization’s login prompt, the login action script is passed. To learn more, read [Database Connections](/docs/authenticate/database-connections).

### Utiliser le contexte d’Organization

1. Navigate to [Auth0 Dashboard > Authentication > Database](https://manage.auth0.com/dashboard/us/#/connections/database/).
2. Select your database connection.
3. Under the **Custom Database** tab, find **Context objects in database scripts** and select **Enable**.

   <Warning>

   This feature cannot be disabled once toggled.

   </Warning>

### Une fois que vous avez activé l’objet de contexte sur le Dashboard, vous pouvez ajouter un objet `context` à vos scripts d’action de base de données personnalisée, qui seront insérés juste avant le paramètre de rappel. Lorsque des événements sont déclenchés avec le contexte d’Organization, les données correspondantes sont fournies à vos scripts d’action de base de données personnalisée dans le format suivant :

Ajouter des paramètres de configuration

<Tabs><Tab title="Login">

```json lines
{
    "organization": {
        "display_name": "My Organization",
        "id": "org_XXXXXX",
        "metadata": {
            "example": "value"
        },
        "name": "my-organization"
    }
}
```






</Tab><Tab title="Create">

```json lines
{
    "organization": {
        "display_name": "My Organization",
        "id": "org_XXXXXX",
        "metadata": {
            "example": "value"
        },
        "name": "my-organization"
    }
}
```






</Tab><Tab title="Verify">

```json lines
{
    "organization": {
        "display_name": "My Organization",
        "id": "org_XXXXXX",
        "metadata": {
            "example": "value"
        },
        "name": "my-organization"
    }
}
```






</Tab><Tab title="Change Password">

```json lines
{
    "organization": {
        "display_name": "My Organization",
        "id": "org_XXXXXX",
        "metadata": {
            "example": "value"
        },
        "name": "my-organization"
    }
}
```






</Tab><Tab title="Get User">

```json lines
{
    "organization": {
        "display_name": "My Organization",
        "id": "org_XXXXXX",
        "metadata": {
            "example": "value"
        },
        "name": "my-organization"
    }
}
```


</Tab>
<Tab title="Delete">
</Tab>
</Tabs>

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

An empty context will always be passed to the `delete` script.

</Callout>

## Vous pouvez stocker des paramètres, tels que les identifiants client requis pour se connecter à votre base de données, dans la section **Settings (Paramètres)** sous l’éditeur de script. Ces paramètres seront accessibles pour tous vos scripts et vous pourrez y accéder en utilisant l’objet `configuration` dans les scripts d’action de votre base de données (p. ex., `configuration.MYSQL_PASSWORD`).

Utilisez les paramètres ajoutés dans vos scripts pour configurer la connexion. Vous pouvez par exemple ajouter ce qui suit au script de connexion MySQL :

Use the added parameters in your scripts to configure the connection. For example, you might add the following to the MySQL Login script:

```javascript lines
function login (username, password, callback) {
  var mysql = require('mysql');
  var connection = mysql.createConnection({
    host     : configuration.MYSQL_HOST,
    user     : 'me',
    password : configuration.MYSQL_PASSWORD,
    database : 'mydb'
  });
}
```






## Learn more

* [Custom Database Connection and Action Script Best Practices](/docs/authenticate/database-connections/custom-db/custom-database-connections-scripts)
* [Troubleshoot Custom Databases](/docs/authenticate/database-connections/custom-db/error-handling)
* [Import and Export Users](/docs/manage-users/user-migration)