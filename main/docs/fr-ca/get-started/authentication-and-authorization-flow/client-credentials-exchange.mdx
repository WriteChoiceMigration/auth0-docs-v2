---
og:description: Learn how Hooks can be used with the Client Credentials Exchange extensibility
  point, which is available for database connections and passwordless connections.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: Échange d’identifiants clients
og:url: https://auth0.com/docs/
permalink: client-credentials-exchange
title: Échange d’identifiants clients
twitter:description: Learn how Hooks can be used with the Client Credentials Exchange
  extensibility point, which is available for database connections and passwordless
  connections.
twitter:title: Échange d’identifiants clients
---



Au point d’extensibilité Échange d’identifiants clients, les Hooks vous permettent d’exécuter des actions personnalisées lorsqu’un jeton d’accès est émis via le point de terminaison[`POST /oauth/token`](/api/authentication#client-credentials-flow) de l’Authentication API à l’aide du flux des identifiants client. Par exemple, vous pouvez refuser l’émission du jeton, ajouter des demandes personnalisées au jeton d’accès ou modifier ses permissions. Pour en savoir plus, consulter [Flux des identifiants client](/login/flows/client-credentials-flow).

Les Hooks à ce point d’extensibilité sont bloquants (synchrones), ce qui signifie qu’ils s’exécutent dans le cadre du processus du déclencheur et empêchent le reste du pipeline Auth0 de s’exécuter jusqu’à ce que le hook soit terminé.





## Code de départ et paramètres

Lors de la création d’un hook exécuté au point d’extensibilité Échange d’identifiants clients, le code de départ suivant peut s’avérer utile. Les paramètres qui peuvent être transmis et utilisés par la fonction Hook sont énumérés en haut de l’exemple de code.



Remarque :

* La fonction de rappel (`cb`) à la fin de l’exemple de code signale l’achèvement et doit être incluse.
* La ligne `access_token.scope = scope` garantit que toutes les permissions accordées seront présentes dans le jeton d’accès. Si vous la supprimez, toutes les permissions seront réinitialisées et le jeton n’inclura que les permissions que vous aurez ajoutés avec le script.

### Réponse par défaut

Lorsque vous exécutez un hook au point d’extensibilité Échange d’identifiants clients, l’objet de réponse par défaut est :



### Réponse du code de départ

Une fois que vous avez personnalisé le code de départ avec vos permissions et vos demandes supplémentaires, vous pouvez tester le hook à l’aide du programme d’exécution intégré à Éditeur de hook. Le programme d’exécution simule un hook avec le même corps et la même réponse que vous obtiendriez avec un Échange d’identifiants clients.





Lorsque vous exécutez un hook basé sur le code de départ, l’objet de réponse est :



## Exemple de script : Ajouter une permission supplémentaire au jeton d’accès

Dans cet exemple, nous utilisons un hook pour ajouter une permission supplémentaire à celles qui existent déjà pour le jeton d’accès.



Pour en savoir plus, consulter [Permissions](/apis/scopes).

### Réponse

Lorsque nous exécutons ce hook, l’objet de réponse est :



## Exemple de script : Ajouter une demande au jeton d’accès

Dans cet exemple, nous ajoutons une demande personnalisée avec espace de noms et sa valeur au jeton d’accès. Pour en savoir plus, consulter [Créer des demandes personnalisées avec espace de noms](/security/tokens/json-web-tokens/create-custom-claims).

Vous pouvez ajouter les éléments suivants en tant que demandes au jeton émis :

* La propriété `scope` de l’objet de réponse
* Toutes les propriétés avec des noms de propriété avec espace de noms

Le point d’extensibilité ignore toutes les autres propriétés de l’objet de réponse.





### Réponse

Lorsque nous exécutons ce hook, l’objet de réponse est :



## Exemple de script : Générer une erreur ou refuser un jeton d’accès

Dans cet exemple, nous utilisons des objets erreur personnalisés pour générer des réponses d’erreur OAuth2. (Pour en savoir plus, consultez [OAuth2 RFC - Section 5.2 dans le Datatracker de l’IETF](https://tools.ietf.org/html/rfc6749#section-5.2)).

Si une erreur JavaScript simple est renvoyée dans le rappel, comme par exemple :



Ensuite, lorsque vous demandez une autorisation `client_credentials` à partir du point de terminaison `/oauth/token`, Auth0 répondra par :



Toutefois, si vous souhaitez exercer un contrôle supplémentaire sur la réponse d’erreur OAuth2, vous pouvez utiliser trois objets erreur personnalisés.

### InvalidScopeError



Ainsi, lorsque vous demandez une autorisation `client_credentials` à partir du point de terminaison `/oauth/token`, Auth0 répond par :



### InvalidRequestError



Ensuite, lorsque vous demandez une autorisation `client_credentials` à partir du point de terminaison `/oauth/token`, Auth0 répondra par :



### ServerError



Lorsque vous demandez une autorisation `client_credentials` à partir du point de terminaison `/oauth/token`, Auth0 répond par :