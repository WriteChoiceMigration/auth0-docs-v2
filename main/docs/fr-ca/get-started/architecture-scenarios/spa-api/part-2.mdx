---
og:description: Auth0 Configuration for the SPA + API architecture scenario
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: Configuration Auth0 (SPA + API)
og:url: https://auth0.com/docs/
permalink: part-2
title: Configuration Auth0 (SPA + API)
twitter:description: Auth0 Configuration for the SPA + API architecture scenario
twitter:title: Configuration Auth0 (SPA + API)
---

In this section we will review all the configurations we need to apply at the [Auth0 Dashboard](https://manage.auth0.com/#).

## Créer l’API

Navigate to the [APIs section](https://manage.auth0.com/#/apis) of the dashboard, and click the **Create API** button.

On vous demandera de fournir les informations suivantes concernant votre API :

* **Nom** : un nom convivial pour l’API. N’affecte aucune fonctionnalité.
* **Identifiant** : un identifiant unique pour votre API. Nous recommandons d’utiliser une URL, mais il n’est pas nécessaire qu’elle soit une URL accessible au public, Auth0 n’appellera pas votre API. Cette valeur ne peut pas être modifiée par la suite.
* **<Tooltip tip="Signing Algorithm: Algorithm used to digitally sign tokens to ensure the token has not been tampered with." cta="View Glossary" href="/docs/glossary?term=Signing+Algorithm">Signing Algorithm</Tooltip>**: the algorithm to sign the tokens with. The available values are `HS256` and `RS256`. When selecting RS256 the token will be signed with the tenant's private key. To learn more about signing algorithms, see [Signing Algorithms](/docs/get-started/applications/signing-algorithms).

<Frame>![Dashboard - Applications - APIs - Create API - Popup](/images/cdy7uua7fh8z/4kIH4BQc4vDel2zhJ6lwCE/094cff6e8e1788c39796eb28ab1925ca/2024-06-27_14-50-24.png)</Frame>

Remplissez les informations requises et cliquez sur le bouton **Créer**.

## Configurer les permissions

Une fois l’application créée, il vous faudra configurer les permissions que les applications pourront solliciter lors du processus d’autorisation.

Dans les paramètres de votre API, accédez à l’onglet Autorisations. Dans cette section, vous pouvez ajouter les permissions de notre étude de cas : `read:timesheets`, `create:timesheets`, `delete:timesheets`, et `approve:timesheets`.

<Frame>![Dashboard - Applications - APIs - Permissions](/images/cdy7uua7fh8z/xxMOKezob6gNHJ0CcKhcg/ccbb9bbab29576a96ed8425329ecffb4/dashboard-apis-edit_view-permissions.png)</Frame>

## Créer l’application

Il existe quatre types d’applications dans Auth0 :

* **Native App** (used by mobile or desktop apps),
* ** Application Web à page unique**;
* **Regular Web App** and
* **Machine to Machine App** (used by CLIs, Daemons, or services running on your backend).

Dans ce scénario, nous souhaitons créer une nouvelle application pour notre SPA. Nous opterons donc pour une application à page unique comme type d’application.

To create a new Application, navigate to the [dashboard](https://manage.auth0.com/#) and click on the [Applications](https://manage.auth0.com/#/applications) menu option on the left. Click the **+ Create Application** button.

Définissez un nom pour votre application (nous utiliserons `Timesheets SPA`) et sélectionnez `Single-Page Web App` pour le type.

Cliquez sur **Créer**.

C’est tout pour l’instant. Une fois la mise en œuvre de la SPA terminée, nous retournerons au tableau de bord ainsi qu’aux paramètres de cette application afin d’y apporter certaines modifications de configuration.

## Configurer l’extension d’autorisation

You will need to ensure that the Authorization Extension is installed for your tenant. You can refer to the [Authorization Extension documentation](/docs/customize/extensions/authorization-extension) for details on how to do this.

### Définir les autorisations

Vous allez maintenant définir les autorisations requises, en fonction des permissions que vous avez déjà définies : `read:timesheets`, `create:timesheets`, `delete:timesheets`, et `approve:timesheets`.

Dans Authorization Extension, cliquez sur l’onglet **Permissions (Autorisations)**, puis cliquez sur le bouton **Create Permission (Créer une autorisation)**.

Dans la boîte de dialogue, saisissez les détails de chaque autorisation.

Assurez-vous que le nom de l’autorisation est exactement le même que la permission correspondante :

<Frame>![Dashboard - Extensions - Authorization Extension - Create Permission](/images/cdy7uua7fh8z/6G4X14X3A73IDRwOrkmttq/e0c20c44a32e0b39a6d8fb72731ffbaf/create-permission.png)</Frame>

Procédez à la création des autorisations pour l’ensemble des permissions restantes :

### Définir les rôles

Passons ensuite à la configuration des deux rôles : employé et gestionnaire.

Accédez à l’onglet **Rôles**, cliquez sur le bouton **Créer un rôle** et sélectionnez l’application **SPA Feuilles de temps**.

Réglez le **Nom** et la **Description** sur `Employee`, et sélectionnez les autorisations `delete:timesheets`, `create:timesheets` et `read:timesheets` permissions. Cliquez sur **Enregistrer**.

Ensuite, appliquez le même processus pour créer un rôle de `Manager`, en veillant à sélectionner l’ensemble des autorisations.

### Assigner des utilisateurs à des rôles

Vous devez assigner tous les utilisateurs soit au rôle  `Manager` , soit au rôle `Employee`.

Vous pouvez accomplir cela en accédant à l’onglet **Users (Utilisateurs)** dans Authorization Extension et en sélectionnant un utilisateur.

Sur l’écran d’informations utilisateur, accédez à l’onglet **Rôles**. Cliquez sur **Ajouter un rôle à l’utilisateur** et sélectionnez le rôle approprié.

### Configurer Authorization Extension

Vous devrez également vous assurer que la règle relative à Authorization Extension est publiée.

Pour ce faire, cliquez sur votre avatar utilisateur situé en haut à droite d’Authorization Extension, puis sélectionnez **Configuration**.

Assurez-vous que le paramètre **Autorisations** est activé, puis cliquez sur **Publier la règle**.

### Créer une règle pour valider les permissions des jetons

The final step in this process is to create a Rule to check if the scopes contained in an <Tooltip tip="Access Token: Authorization credential, in the form of an opaque string or JWT, used to access an API." cta="View Glossary" href="/docs/glossary?term=Access+Token">Access Token</Tooltip> are valid based on the permissions assigned to the user. Any scopes which are not valid for a user should be removed from the Access Token.

In your <Tooltip tip="Auth0 Dashboard: Auth0's main product to configure your services." cta="View Glossary" href="/docs/glossary?term=Auth0+Dashboard">Auth0 Dashboard</Tooltip>, go to the **Rules** tab. You should see the Rule created by the Authorization Extension. Click on the **Create Rule** button and select the **Empty Rule** template. You can give the Rule a name, such as **Access Token Scopes**, and then specify the following code for the Rule:

```javascript lines
function (user, context, callback) {
  var permissions = user.permissions || [];
  var requestedScopes = context.request.body.scope || context.request.query.scope;
  var filteredScopes = requestedScopes.split(' ').filter( function(x) {
    return x.indexOf(':') < 0;
  });

  var allScopes = filteredScopes.concat(permissions);
  context.accessToken.scope = allScopes.join(' ');

  callback(null, user, context);
}
```






Le code ci-dessus garantira que tous les jetons d’accès ne contiendront que les permissions correctement formatées (p. ex., `action:area` ou `delete:timesheets`) qui sont valides en fonction des autorisations d’un utilisateur. Une fois que vous avez terminé, vous pouvez cliquer sur le bouton **Enregistrer**.

Les règles s’exécutent dans l’ordre dans lequel elles figurent sur la page Règles. Veillez donc à ce que la nouvelle règle que vous avez créée soit placée sous la règle d’Authorization Extension, afin qu’elle s’exécute après celle-ci.