---
og:description: Learn how to support multi-tenant, multi-environment workflows when
  using the Auth0 Deploy CLI.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: Intégration dans les flux de production multienvironnement
og:url: https://auth0.com/docs/
permalink: incorporate-into-multi-environment-workflows
title: Intégration dans les flux de production multienvironnement
twitter:description: Learn how to support multi-tenant, multi-environment workflows
  when using the Auth0 Deploy CLI.
twitter:title: Intégration dans les flux de production multienvironnement
---

L’outil Deploy CLI prend en charge le travail dans un contexte multilocataire et multienvironnement. Lorsqu’il est intégré dans vos flux de production de développement CI/CD, peut être utilisé pour propager les modifications Auth0 du développement des fonctionnalités jusqu’à la production.

En général, le flux de production conseillé est le suivant :

1. Create a separate Auth0 tenant for each environment (development, staging, production).
2. Create a single repository of resource configuration files for all environments.
3. Add a step in your CI/CD pipeline when deploying to environments that applies the Auth0 resource configurations to the appropriate Auth0 tenant.

## Du locataire à l’environnement

Il est recommandé d’avoir un compte/locataire Auth0 distinct pour chaque environnement que vous avez. Par exemple :

<table class="table"><thead>
<tr>
<th><strong>Environment</strong></th>
<th><strong>Tenant</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Development</td>
<td><code>travel0-dev</code></td>
</tr>
<tr>
<td>Testing</td>
<td><code>travel0-uat</code></td>
</tr>
<tr>
<td>Staging</td>
<td><code>travel0-stage</code></td>
</tr>
<tr>
<td>Production</td>
<td><code>travel0-prod</code></td>
</tr>
</tbody>
</table>

## Référentiel de configuration des ressources

When exported, your Auth0 tenant state will be represented as a set of resource configuration files, either in a [YAML or directory format](/docs/deploy-monitor/deploy-cli-tool/available-resource-configuration-formats). In a multi-environment context it is expected to have a single repository of resource configurations that is applied to all environments. In practice, this may exist as a directory in your project’s codebase or in a separate codebase altogether.

Vous devriez avoir au moins une branche pour chaque locataire dans votre référentiel, ce qui vous permet d’apporter des modifications sans les déployer. De cette façon, les modifications ne seront déployées que lorsque vous fusionnerez la branche de travail dans la branche principale (comme `main` ou `master`). Avec cette configuration, vous pouvez avoir une tâche d’intégration continue pour chaque environnement qui déploie automatiquement les modifications à l’environnement ciblé chaque fois que la branche principale reçoit des mises à jour.

Votre flux de production pourrait ressembler à ceci :

1. Make changes to development.
2. Merge changes to testing (or uat).
3. Test changes to uat. When ready, move and merge the changes to staging.
4. Test staging. When ready, move and merge the changes to production.

Par précaution, vous pouvez configurer votre environnement de production pour le déployer uniquement lorsque déclenché manuellement.

## Flux unidirectionnel

The multi-environment workflow works best when changes are propagated “up” in a single direction. Changes to the resource configuration files should first be applied to the lowest level environment (such as development) and then incrementally applied up through all other environments until applied to production. This unidirectional practice ensures sufficient testing and approval for changes to your tenant. Once set, it is recommended to not apply configurations directly to production through other means such as the <Tooltip tip="Auth0 Dashboard: Auth0's main product to configure your services." cta="View Glossary" href="/docs/glossary?term=Auth0+Dashboard">Auth0 Dashboard</Tooltip> or <Tooltip tip="Auth0 Dashboard: Auth0's main product to configure your services." cta="View Glossary" href="/docs/glossary?term=Management+API">Management API</Tooltip> unless those changes are captured by a subsequent Deploy CLI export. Otherwise, those changes are subject to overwrite.

## Valeurs propres à l’environnement

While it is expected that all environments will share the same set of resource configuration files, environment-specific values can be expressed through separate tool configuration files and dynamic [Keyword Replacement](/docs/deploy-monitor/deploy-cli-tool/keyword-replacement).

## Fichiers de configuration distincts

La spécification d’un fichier de configuration d’outil distinct par environnement peut être utilisé pour garder les fichiers de configuration des ressources indépendants de l’environnement, tout en prenant en charge les besoins de chaque environnement. Au minimum, vous devrez fournir des identifiants distinctes pour chaque environnement, mais il est également possible d’exclure certaines ressources, d’activer la suppression et d’effectuer un remplacement dynamique de mots clés par environnement.

### Exemple de structure de fichier

```text lines
project-root
│
└───auth0
│   │   config-dev.json   # Dev env config file
│   │   config-test.json  # Test env config file
│   │   config-prod.json  # Prod env config file
│   │   ... all other resource configuration files
│
└───src
    │   ... your project code
```






## Valeurs dynamiques avec remplacement de mots-clés

Once separate configuration files are adopted for each environment, keyword replacement through the `AUTH0_KEYWORD_REPLACE_MAPPINGS` configuration property can be used to express the dynamic replacement values depending on the environment. For example, you may find it necessary to have a separate set of allowed origins for your clients. To learn more, read [Keyword Replacement](/docs/deploy-monitor/deploy-cli-tool/keyword-replacement).

### Exemple config-dev.json

```json lines
{
  "AUTH0_DOMAIN": "travel0-dev.us.auth0.com",
  "AUTH0_CLIENT_ID": "PdwQpGy62sHcsV6ufZNEVrV4GDlDhm74",
  "AUTH0_ALLOW_DELETE": true,
  "AUTH0_KEYWORD_REPLACE_MAPPINGS": {
    "ENV": "dev",
    "ALLOWED_ORIGINS": ["http://localhost:3000", "http://dev.travel0.com"]
  }
}
```






### Exemple config-prod.json

```json lines
{
  "AUTH0_DOMAIN": "travel0.us.auth0.com",
  "AUTH0_CLIENT_ID": "vZCEFsDYzXc1x9IomB8dF185e4cdVah5",
  "AUTH0_ALLOW_DELETE": false,
  "AUTH0_KEYWORD_REPLACE_MAPPINGS": {
    "ENV": "prod",
    "ALLOWED_ORIGINS": ["http://travel0.com"]
  }
}
```