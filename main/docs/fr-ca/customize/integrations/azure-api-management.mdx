---
og:description: Using Auth0 as an OAuth 2.0 server to authenticate users wanting access
  to an API managed by the Azure API Management service
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: Intégrer avec Azure Management API
og:url: https://auth0.com/docs/
permalink: azure-api-management
title: Intégrer avec Azure Management API
twitter:description: Using Auth0 as an OAuth 2.0 server to authenticate users wanting
  access to an API managed by the Azure API Management service
twitter:title: Intégrer avec Azure Management API
---

<Card title="Before you start">

You'll need a Microsoft account with access to the [Azure Portal](https://azure.microsoft.com/).

</Card>

The [Azure API Management](https://azure.microsoft.com/en-us/services/api-management/) service allows you to create new APIs or import existing API definitions and publish them for use by the approved audiences. Auth0 makes authorizing users of your API (using <Tooltip tip="OAuth 2.0: Authorization framework that defines authorization protocols and workflows." cta="View Glossary" href="/docs/glossary?term=OAuth+2.0">OAuth 2.0</Tooltip> standards) easy.

Dans ce tutoriel, vous apprendrez à utiliser Auth0 pour authentifier et autoriser les utilisateurs lorsqu’ils accèdent à une API de calculatrice de base gérée par Azure Management API.

## Configurer Auth0

### Créer une API

You'll need to create an API in Auth0 to represent the API managed by the Azure API Management Service. To learn more, read [Register APIs](/docs/get-started/auth0-overview/set-up-apis).

1. Navigate to [Auth0 Dashboard > Applications > APIs](https://manage.auth0.com/#/apis), and select **Create API**.
2. Set the following parameters:

   <table class="table"><thead>
   <tr>
   <th><strong>Field</strong></th>
   <th><strong>Value</strong></th>
   </tr>
   </thead>
   <tbody>
   <tr>
   <td><strong>Name</strong></td>
   <td><code>Basic Calculator</code></td>
   </tr>
   <tr>
   <td><strong>Identifier</strong></td>
   <td><code>basic-calculator</code></td>
   </tr>
   <tr>
   <td><strong>Signing Algorithm</strong></td>
   <td><code>RS256</code></td>
   </tr>
   </tbody>
   </table>
3. Select **Create**.

### Créer une application Web ordinaire

You'll need to create a Regular Web Application (RWA) in Auth0 to communicate with the OAuth 2.0 <Tooltip tip="Authorization Server: Centralized server that contributes to defining the boundaries of a user’s access. For example, your authorization server can control the data, tasks, and features available to a user." cta="View Glossary" href="/docs/glossary?term=authorization+server">authorization server</Tooltip> in Azure:

1. Navigate to [Auth0 Dashboard > Applications > Applications](https://manage.auth0.com/#/applications), and select the **Create Application** button.
2. Enter a **Name** for your application, and select **Regular Web Applications** for the application type.

### Créer et activer une connexion

Vous devrez créer une connexion dans Auth0 et l’activer pour votre application :

1. Navigate to [Auth0 Dashboard > Authentication > Database](https://manage.auth0.com/#/connections/database), and select **Create DB Connection**.
2. Enter a **Name** for your connection. We suggest choosing a name that reflects the source of users (such as `Facebook` for a Connection that contains users using their Facebook credentials or `site-sign-ups` for a database connection where users sign up on your site).
3. Select **Create**.
4. Navigate to your connection's **Settings** page.
5. Switch to the **Applications** view, where you'll see a list of all the applications on your tenant.
6. Toggle the application you created previously to enable it for the connection.

### Créez un utilisateur

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

If you already have a set of users, you can import them or create a [custom database connection](/docs/authenticate/database-connections/custom-db).

</Callout>

Vous devez avoir au moins un utilisateur sur votre connexion pour tester l’authentification et l’autorisation. Si vous ne disposez pas d’un ensemble d’utilisateurs pour la connexion, vous pouvez en créer un manuellement :

1. Navigate to [Auth0 Dashboard > User Management > Users](https://manage.auth0.com/#/users), and select **Create User**.
2. Enter an **Email** and **Password**, and select the connection you created in Step 3 for the **Connection** field.
3. Select **Create**.

## Configurer Azure

### Créer le service Azure API Management

Vous devrez créer une instance de service API Management dans Azure pour gérer votre API :

1. In the navigation bar, select **Create a resource**.
2. Once redirected, select **Web** > **API Management**.
3. Provide the following configuration variables:

   <table class="table"><thead>
   <tr>
   <th><strong>Parameter</strong></th>
   <th><strong>Description</strong></th>
   </tr>
   </thead>
   <tbody>
   <tr>
   <td><strong>Name</strong></td>
   <td>The name for your service (which will also be used to create the URL you need to access the service)</td>
   </tr>
   <tr>
   <td><strong>Subscription</strong></td>
   <td>The Azure subscription plan with which you'll use with the service</td>
   </tr>
   <tr>
   <td><strong>Resource group</strong></td>
   <td>The collection of <a href="https://docs.microsoft.com/en-us/azure/azure-resource-manager/resource-group-portal">resources</a> sharing a lifecycle, permissions, and policies. You can use an existing resource group or you can create a new one (you'll need to provide a name for the group if you create a new one)</td>
   </tr>
   <tr>
   <td><strong>Location</strong></td>
   <td>Choose the location that services your API instance</td>
   </tr>
   <tr>
   <td><strong>Organization name</strong></td>
   <td>The name of your organization</td>
   </tr>
   <tr>
   <td><strong>Administrator email</strong></td>
   <td>The email address of the person who will be administering this instance</td>
   </tr>
   <tr>
   <td><strong>Pricing tier</strong></td>
   <td>The pricing tier you want, which determines the number of calls you can make to your API, as well as the maximum amount of data transfer allowed. You must opt for the <a href="https://azure.microsoft.com/en-us/pricing/details/api-management/">Developer plan</a> or higher; the Consumption plan does not offer sufficient functionality for this integration to work.</td>
   </tr>
   </tbody>
   </table>
4. Select **Create** to begin provisioning your service (this may take up to 15 minutes to complete).

### Importer l’exemple d’API

For this tutorial, we will be importing and using the Basic Calculator API provided by Microsoft. For detailed instructions, see [Import and Publish Your First API](https://docs.microsoft.com/en-us/azure/api-management/import-and-publish#go-to-your-api-management-instance) from Microsoft.

Lorsque vous avez terminé, sélectionnez **Créer** pour importer votre API. Vous serez redirigé vers la page de résumé de votre API lorsqu’elle sera entièrement importée.

### Configurer un serveur d’autorisation OAuth 2.0

Pour utiliser Auth0 afin de sécuriser votre API Azure, vous devez enregistrer Auth0 en tant que serveur d’autorisation OAuth 2.0 :

1. Find the **OAuth 2.0 + OpenID Connect** area of your API Management service instance near the navigation bar. Select **OAuth 2.0**,and then select **Add**.
2. Go to the **Add OAuth2 service** configuration screen, and select the Authorization Code grant type.
3. Set the following parameters:

   <table class="table"><thead>
   <tr>
   <th><strong>Parameter</strong></th>
   <th><strong>Description</strong></th>
   </tr>
   </thead>
   <tbody>
   <tr>
   <td><strong>Display name</strong></td>
   <td>Enter a descriptive name for your authorization server, such as <code>Auth0</code>.</td>
   </tr>
   <tr>
   <td><strong>Id</strong></td>
   <td>This field should auto-populate based on the display name you provide.</td>
   </tr>
   <tr>
   <td><strong>Description</strong></td>
   <td>Enter a description for your authorization server, such as <code>Auth0 API Authentication</code>.</td>
   </tr>
   <tr>
   <td><strong>Client registration page URL</strong></td>
   <td>Enter `https://placeholder.contoso.com` as a placeholder.</td>
   </tr>
   <tr>
   <td><strong>Authorization code grant types</strong></td>
   <td>Select <code>Authorization code</code>.</td>
   </tr>
   <tr>
   <td><strong>Authorization endpoint URL</strong></td>
   <td>Refer to your tenant's <a href="https://{yourDomain}/.well-known/openid-configuration">OIDC Discovery endpoint</a> and append the <code>audience</code> parameter. For example: `https://{yourDomain}/authorize?audience={API_AUDIENCE}`.</td>
   </tr>
   <tr>
   <td><strong>Authorization request method</strong></td>
   <td>Default is <code>GET</code>.</td>
   </tr>
   <tr>
   <td><strong>Token endpoint URL</strong></td>
   <td>Refer to your tenant's <a href="https://{yourDomain}/.well-known/openid-configuration">OIDC Discovery endpoint</a> .</td>
   </tr>
   <tr>
   <td><strong>Client authentication methods</strong></td>
   <td>Select <code>Basic</code>.</td>
   </tr>
   <tr>
   <td><strong>Access Token sending method</strong></td>
   <td>Select <code>Authorization header</code>.</td>
   </tr>
   <tr>
   <td><strong>Default scope</strong></td>
   <td>Specify a default <Tooltip tip="Mechanism that determines actions applications can perform on a user's behalf with information previously created in an online resource." cta="View Glossary" href="/docs/glossary?term=scope">scope</Tooltip>, if required.</td>
   </tr>
   </tbody>
   </table>
4. Under the **Client Credentials** section, enter your Auth0 applications client ID in the **Client ID** field and client secret in the **Client secret** field.
5. Switch to the **Redirect URI** view, and copy the URI value in the **Authorization code flow grant** field.
6. Select **Create**.

### Configurer l’API Azure pour utiliser Auth0

Après avoir créé votre serveur d’autorisation OAuth 2.0 dans Azure, vous devrez mettre à jour votre API Azure afin d’utiliser Auth0 pour l’autorisation de l’utilisateur :

1. Under the **APIs** section in the navigation, select **APIs**.
2. Select the Basic Calculator API, and go to the **Design** view.
3. Switch to the **Settings** view.
4. Navigate to the **Security** section, and select **OAuth 2.0** under **User Authorization**.
5. Select the server you configured in the previous step for the **Authorization Server** field.
6. Click **Save**.

## Définir l’URL de rappel autorisée dans Auth0

Une fois votre API Azure fournie et configurée pour utiliser Auth0 pour l’autorisation des utilisateurs, vous devrez mettre à jour votre application Auth0.

1. Navigate to [Auth0 Dashboard > Applications > Applications](https://manage.auth0.com/#/applications).
2. Select your application, and switch to the **Settings** view.
3. Enter the Redirect URIyou copied previously into the **Allowed Callback URLs** field.
4. Click **Save**.

## Tester l’intégration

Dans le portail Azure, ouvrez votre instance du service API Management.

1. Select **Developer Console** to launch the developer-facing side of your APIs.
2. Go to **APIs** > **Basic Calculator**. This opens up to the page where you can make a `GET` call that allows you to add two integers.
3. Select **Try It**. This will bring up the page where you can provide the parameters for your call.
4. Navigate to the **Authorization** section, and select **Authorization Code** (next to the **Auth0** field).
5. A popup window will appear with the Auth0 login widget (if it doesn't, ensure that any pop-up blockers are disabled for your browser). Enter the credentials for the Auth0 user you created in Step 4, and log in.
6. If you were able to successfully log in, a message will appear with the expiration date of the access token you can use to call your API.
7. Navigate to the bottom, and select **Send**. If the request is successful, you'll see a message containing the `HTTP 200` response at the bottom of the page.

### Configurer une politique de validation JWT pour les jetons d’accès

In the previous step, the user is prompted to sign in when they try to make a call from the Developer Console. The Developer Console attempts to obtain an <Tooltip tip="Access Token: Authorization credential, in the form of an opaque string or JWT, used to access an API." cta="View Glossary" href="/docs/glossary?term=Access+Token">Access Token</Tooltip> on behalf of the user to be included in the API request. All Access Tokens will be passed to the API via the `Authorization` header.

If you want to validate the Access Token included with each request, you can do so by using the [Validate JWT](https://docs.microsoft.com/en-us/azure/api-management/api-management-access-restriction-policies#ValidateJWT) policy. Please refer to Microsoft's documentation on [setting an API Management policy](https://docs.microsoft.com/en-us/azure/api-management/set-edit-policies).