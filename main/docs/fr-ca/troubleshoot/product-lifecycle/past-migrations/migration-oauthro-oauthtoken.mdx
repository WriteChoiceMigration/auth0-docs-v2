---
og:description: Describes how to migrate your password API calls and responses from
  /oauth/ro to /oauth/token.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: Migration du Flux de mot de passe du propriétaire de ressource
og:url: https://auth0.com/docs/
permalink: migration-oauthro-oauthtoken
title: Migration du Flux de mot de passe du propriétaire de ressource
twitter:description: Describes how to migrate your password API calls and responses
  from /oauth/ro to /oauth/token.
twitter:title: Migration du Flux de mot de passe du propriétaire de ressource
---

Support for <Tooltip tip="Resource Owner: Entity (such as a user or application) capable of granting access to a protected resource." cta="View Glossary" href="/docs/glossary?term=resource+owner">resource owner</Tooltip> password was added to `/oauth/token`. Usage of the `/oauth/ro` endpoint was deprecated on 08 July 2017. The `/oauth/ro` endpoint was previously used to exchange a one-time password (OTP) received by the end-user email or SMS for an <Tooltip tip="ID Token: Credential meant for the client itself, rather than for accessing a resource." cta="View Glossary" href="/docs/glossary?term=ID+token">ID token</Tooltip> and an <Tooltip tip="Access Token: Authorization credential, in the form of an opaque string or JWT, used to access an API." cta="View Glossary" href="/docs/glossary?term=access+token">access token</Tooltip>. Auth0 has implemented a new API that replaces `/oauth/ro` for this use case and we recommend that you migrate to using the new endpoint.

## Caractéristiques affectées

This change affects you if you use the [Resource Owner Password Flow](/docs/get-started/authentication-and-authorization-flow/resource-owner-password-flow)(sometimes called Resource Owner Password Grant or ROPG) and call `/oauth/ro` directly without the use of any Auth0 libraries or SDKs. Auth0 libraries such as Lock or Auth0.js have been updated to stop using `/oauth/ro` internally. If you use the lock-<Tooltip tip="Passwordless: Form of authentication that does not rely on a password as the first factor." cta="View Glossary" href="/docs/glossary?term=passwordless">passwordless</Tooltip> library, you can now use Passwordless Mode in Lock instead.

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

When a user's `/oauth/ro` based access token has expired, Auth0 forces them to reauthenticate (forced logout required) because the `/oauth/ro` refresh token cannot be used to call `/oauth/token` for a new access token. All currently logged in user's must log in again during an `/oauth/ro` to `/oauth/token` migration.

</Callout>

## Actions

### Changements dans les requêtes

Auparavant, la charge utile d’une requête vers `/oauth/ro` ressemblait à ceci :

```json lines
{
  "grant_type": "password",
  "client_id": "123",
  "username": "alice",
  "password": "A3ddj3w", 
  "connection": "my-database-connection",
  "scope": "openid email favorite_color offline_access",
  "device": "my-device-name"
}
```






La nouvelle version intègre les changements suivants :

* Le point de terminaison pour exécuter les échanges de jetons est désormais `/oauth/token`.
* Le type d’autorisation propre à Auth0 est utilisé pour authentifier les utilisateurs à partir d’une connexion (ou d’une partition) spécifique.
* Auth0 prend en charge les permissions OIDC standard, ainsi que les permissions que vous avez définies dans votre API personnalisée.
* Une permission qui ne s’inscrit pas dans l’une de ces catégories, comme `favorite_color` ci-dessus, n’est plus une permission valide.
* Le paramètre `device` a été retiré.
* Le paramètre `audience` est facultatif.

Voici un exemple de la charge utile d’une requête vers `/oauth/token` :

```json lines
{
  "grant_type": "http://auth0.com/oauth/grant-type/password-realm",
  "client_id": "123",
  "username": "alice",
  "password": "A3ddj3w",
  "realm": "my-database-connection",
  "scope": "openid email offline_access",
  "audience": "https://api.example.com"
}
```






* Le type d’autorisation est indiqué ici en tant que `password-realm` (partition du mot de passe) plutôt que le `password` (mot de passe) standard.
* Les paramètres `client_id`, `username`, et `password` sont inchangés.
* La `realm` (partition) est incluse car nous utilisons le type d’autorisation Partition de mot de passe, qui remplace le paramètre `connection` (connexion) des anciennes requêtes.
* Le paramètre `scope` est sensiblement le même, mais il n’accepte pas les valeurs non OIDC.
* The `audience` parameter can be added, indicating the API <Tooltip tip="Audience: Unique identifier of the audience for an issued token. Named aud in a token, its value contains the ID of either an application (Client ID) for an ID Token or an API (API Identifier) for an Access Token." cta="View Glossary" href="/docs/glossary?term=audience">audience</Tooltip> the token will be intended for.

### Changements dans les réponses

Les réponses provenant de `/oauth/ro` avait un format similaire à celui-ci :

```json lines
{
  "access_token": "SlAV32hkKG",
  "token_type": "Bearer",
  "refresh_token": "8xLOxBtZp8",
  "expires_in": 3600,
  "id_token": "eyJ..."
}
```






* The returned access token is valid for calling the `/userinfo` endpoint (provided that the API specified by the `audience` param uses RS256 as <Tooltip tip="Signing Algorithm: Algorithm used to digitally sign tokens to ensure the token has not been tampered with." cta="View Glossary" href="/docs/glossary?term=signing+algorithm">signing algorithm</Tooltip>) and optionally the custom API if one was specified.
* The ID token will be forcibly signed using RS256 if requested by a <Tooltip tip="Public Client: Client (application) that cannot hold credentials securely. Examples include a native desktop or mobile application and a JavaScript-based client-side web application (such as a single-page app (SPA))." cta="View Glossary" href="/docs/glossary?term=public+client">public client</Tooltip>.
* A <Tooltip tip="Refresh Token: Token used to obtain a renewed Access Token without forcing users to log in again." cta="View Glossary" href="/docs/glossary?term=Refresh+Token">Refresh Token</Tooltip> will be returned only if the `offline_access` scope was granted and the API has **Allow offline access** set.

Voici un exemple de réponse conforme à OIDC provenant de `/oauth/token` :

```json lines
{
  "access_token": "eyJ...",
  "token_type": "Bearer",
  "refresh_token": "8xLOxBtZp8",
  "expires_in": 3600,
  "id_token": "eyJ..."
}
```






### Vérifier la migration

1. Once you have migrated your codebase and are sure that your apps are not calling the endpoint, go to the [Dashboard > Tenant Settings > Advanced](https://manage.auth0.com/#/tenant/advanced).
2. Scroll down to **Migrations** and toggle off **Legacy** `/oauth/ro` **Endpoint**. Turning off this switch disables the deprecated endpoint for your tenant, preventing it from being used.

Si la désactivation du commutateur entraîne des échecs de connexion, c’est le signe que vous n’avez pas encore supprimé toutes les instances de code hérité de vos applications.

Une fois que les migrations ont bien été effectuées dans les environnements de production, le commutateur peut être désactivé et ignoré, afin de s’assurer que les fonctionnalités obsolètes ne peuvent plus être utilisées.