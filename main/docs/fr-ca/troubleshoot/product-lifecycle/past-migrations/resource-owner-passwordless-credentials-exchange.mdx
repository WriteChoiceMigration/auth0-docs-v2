---
og:description: Describes how to migrate your Passwordless API calls and responses
  from /oauth/ro to /oauth/token.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: Migrez votre échange d’informations d’identification sans mot de passe du
  propriétaire de la ressource
og:url: https://auth0.com/docs/
permalink: resource-owner-passwordless-credentials-exchange
title: Migrez votre échange d’informations d’identification sans mot de passe du propriétaire
  de la ressource
twitter:description: Describes how to migrate your Passwordless API calls and responses
  from /oauth/ro to /oauth/token.
twitter:title: Migrez votre échange d’informations d’identification sans mot de passe
  du propriétaire de la ressource
---

Support for <Tooltip tip="Resource Owner: Entity (such as a user or application) capable of granting access to a protected resource." cta="View Glossary" href="/docs/glossary?term=resource+owner">resource owner</Tooltip> password was added to `/oauth/token`. Usage of the `/oauth/ro` endpoint was deprecated on 08 July 2017. The `/oauth/ro` endpoint was previously used to exchange a one-time password (OTP) received by the end-user email or SMS for an <Tooltip tip="ID Token: Credential meant for the client itself, rather than for accessing a resource." cta="View Glossary" href="/docs/glossary?term=ID+token">ID token</Tooltip> and an <Tooltip tip="Access Token: Authorization credential, in the form of an opaque string or JWT, used to access an API." cta="View Glossary" href="/docs/glossary?term=access+token">access token</Tooltip>. Auth0 has implemented a new API that replaces `/oauth/ro` for this use case and we recommend that you migrate to using the new endpoint.

## Caractéristiques affectées

This change affects you if you use the resource owner <Tooltip tip="Passwordless: Form of authentication that does not rely on a password as the first factor." cta="View Glossary" href="/docs/glossary?term=passwordless">passwordless</Tooltip> credentials exchange and call `/oauth/ro` directly without the use of any Auth0 libraries or SDKs.

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

When a user's `/oauth/ro` based access token has expired, Auth0 forces them to reauthenticate (forced logout required) because the `/oauth/ro` refresh token cannot be used to call `/oauth/token` for a new access token. All currently logged in user's must log in again during an `/oauth/ro` to `/oauth/token` migration.

</Callout>

## Actions

### Demander des modifications

Auparavant, la charge utile d’une requête vers `/oauth/ro` ressemblait à ceci :

```json lines
{
  "grant_type": "password",
  "client_id": "123",
  "username": "alice",
  "password": "A3ddj3w", 
  "connection": "my-database-connection",
  "scope": "openid email favorite_color offline_access",
  "device": "my-device-name"
}
```



Voici les changements apportés à la nouvelle implémentation :

* Le point de terminaison pour exécuter les échanges de jetons est désormais `/oauth/token`.
* Le type d’autorisation propre à Auth0 est utilisé pour authentifier les utilisateurs à partir d’une connexion (ou d’une partition) spécifique.
* Auth0 prend en charge les permissions OIDC standard, ainsi que les permissions que vous avez définies dans votre API personnalisée.
* Une permission qui ne s’inscrit pas dans l’une de ces catégories, comme `favorite_color` ci-dessus, n’est plus une permission valide.
* Le paramètre `device` a été retiré.
* Le paramètre `audience` est facultatif.

Voici un exemple de la charge utile d’une requête vers `/oauth/token` :

```json lines
{
  "grant_type" : "http://auth0.com/oauth/grant-type/passwordless/otp",
  "client_id": "{yourClientId}",
  "client_secret": "{yourClientSecret}", // only for web apps, native apps don’t have a client secret
  "username": "{userEmailAddress}", // or "{userPhoneNumber}"
  "otp": "CODE",
  "realm": "email", // or "sms" 
  "audience" : "{yourApiIdentifier}", // in case you need an access token for a specific API
  "scopes": "openid profile email" // whatever scopes you need
}
```






* The grant type is specified here as `http://auth0.com/oauth/grant-type/passwordless/otp`.
* Les paramètres `client_id` et `username` sont inchangés.
* The `client_secret` needs to be specified for <Tooltip tip="Confidential Client: A client (application) that can hold credentials securely by using a trusted backend server. Examples include a web application with a secure backend and a machine-to-machine (M2M) application." cta="View Glossary" href="/docs/glossary?term=confidential+clients">confidential clients</Tooltip> (e.g. regular web apps).
* Le mot de passe à usage unique doit être envoyé dans le paramètre `otp` au lieu du paramètre `password`.
* Le `realm` est utilisé pour identifier la connexion et remplace le paramètre `connection` des appels précédents.
* Le paramètre `scope` est sensiblement le même, mais il n’accepte pas les valeurs non OIDC.
* The `audience` parameter can be added, indicating the API <Tooltip tip="Audience: Unique identifier of the audience for an issued token. Named aud in a token, its value contains the ID of either an application (Client ID) for an ID Token or an API (API Identifier) for an Access Token." cta="View Glossary" href="/docs/glossary?term=audience">audience</Tooltip> the token will be intended for.

### Changements dans les réponses

Les réponses provenant de `/oauth/ro` avait un format similaire à celui-ci :

```json lines
{
  "access_token": "SlAV32hkKG",
  "token_type": "Bearer",
  "refresh_token": "8xLOxBtZp8",
  "expires_in": 3600,
  "id_token": "eyJ..."
}
```






* The returned access token is valid for calling the `/userinfo` endpoint (provided that the API specified by the `audience` param uses RS256 as <Tooltip tip="Signing Algorithm: Algorithm used to digitally sign tokens to ensure the token has not been tampered with." cta="View Glossary" href="/docs/glossary?term=signing+algorithm">signing algorithm</Tooltip>) and optionally the custom API if one was specified.
* The ID token will be forcibly signed using RS256 if requested by a <Tooltip tip="Public Client: Client (application) that cannot hold credentials securely. Examples include a native desktop or mobile application and a JavaScript-based client-side web application (such as a single-page app (SPA))." cta="View Glossary" href="/docs/glossary?term=public+client">public client</Tooltip>.
* A <Tooltip tip="Refresh Token: Token used to obtain a renewed Access Token without forcing users to log in again." cta="View Glossary" href="/docs/glossary?term=refresh+token">refresh token</Tooltip> will be returned only if the `offline_access` scope was granted and the API has **Allow offline access** set.

Voici un exemple de réponse conforme à OIDC provenant de `/oauth/token` :

```json lines
{
  "access_token": "eyJ...",
  "token_type": "Bearer",
  "refresh_token": "8xLOxBtZp8",
  "expires_in": 3600,
  "id_token": "eyJ..."
}
```






### Modifications du code lors de l’utilisation des trousses SDK

Si votre application utilise les bibliothèques natives Auth0 pour Android ou iOS, assurez-vous que la version de la bibliothèque que vous incluez est au moins égale au minimum répertorié ci-dessous (ou supérieure). Assurez-vous également de définir le drapeau `OIDC Conformant` sur `true` lors de la configuration des bibliothèques.

<table class="table"><thead>
<tr>
<th>Library</th>
<th>Minimum Version</th>
</tr>
</thead>
<tbody>
<tr>
<td>Android SDK</td>
<td>1.2</td>
</tr>
<tr>
<td>Lock Android</td>
<td>2.17</td>
</tr>
<tr>
<td>Swift SDK</td>
<td>1.20.0</td>
</tr>
<tr>
<td>Lock iOS</td>
<td>2.14.0</td>
</tr>
</tbody>
</table>

### Vérifier la migration

1. To verify whether you are using the deprecated endpoint, check the [tenant logs](https://manage.auth0.com/#/logs), filter by **Deprecation Notice** and then check for logs that say `oauth/ro` **passwordless: This feature is being deprecated**. You can also perform this search directly with the following query: `type:depnote AND description:*passwordless*`.
2. Once you have migrated your codebase and are sure that your apps are not calling the endpoint, go to the [Dashboard](https://manage.auth0.com/#/tenant/advanced) under **Tenant Settings > Advanced**.
3. Scroll down to **Migrations** and toggle off **Legacy** `/oauth/ro` **Endpoint**. Turning off this switch disables the deprecated endpoint for your tenant, preventing it from being used.

Si la désactivation du commutateur entraîne des échecs de connexion, c’est le signe que vous n’avez pas encore supprimé toutes les instances de code hérité de vos applications.

Une fois que les migrations ont bien été effectuées dans les environnements de production, le commutateur peut être désactivé et ignoré, afin de s’assurer que les fonctionnalités obsolètes ne peuvent plus être utilisées.

## Learn more

* [Migrate Your Resource Owner Password Flow](/docs/troubleshoot/product-lifecycle/past-migrations/migration-oauthro-oauthtoken)