---
og:description: Learn how to migrate from Auth0 Search v2 to v3.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: Migrer de Recherche v2 vers v3
og:url: https://auth0.com/docs/
permalink: migrate-v2-v3
title: Migrer de Recherche v2 vers v3
twitter:description: Learn how to migrate from Auth0 Search v2 to v3.
twitter:title: Migrer de Recherche v2 vers v3
---

User search v2 has reached its end of life as of **June 30, 2019**. We highly recommend migrating user search functionality to [search engine v3](/docs/manage-users/user-search) (`search_engine=v3`) as soon as possible.

## Considérations sur la migration

Avant de commencer la migration, vous devez savoir un certain nombre de choses

* Pour vous assurer que vos requêtes utilisent le moteur de recherche v3 avant que v2 ne devienne indisponible, vous devez mettre à jour tous vos appels au point de terminaison  `GET /api/v2/users` pour inclure le paramètre `search_engine=v3`. Cela vous permettra de déterminer si des requêtes doivent être mises à jour, de manière à ne pas subir de temps d’arrêt lorsque la v2 deviendra indisponible.
* Si vous effectuez des opérations de recherche d’utilisateur via l’un des [trousses SDK impactées](#impacted-sdks), vous devez également passer le paramètre `search_engine=v30` comme indiqué ci-dessus.
* Les valeurs de recherche pour les champs utilisateur normalisés (`courriel`, `nom`, `prénom`, `nom de famille`, et `surnom`) ne sont pas sensibles à la casse. Tous les autres champs (y compris tous les champs `app_metadata`/ `user_metadata`)  sont sensibles à la casse.
* v3 limits the number of users you can retrieve to 1000. If you are reaching this limit, we recommend that you redefine your search query to obtain more granular results. If you need a list of more than 1000 users at a given time, we recommend that you use the [Export Job](https://auth0.com/docs/api/management/v2#!/Jobs/post_users_exports) API endpoint or [User Import / Export Extension](/docs/manage-users/user-migration/user-import-export-extension) instead.
* Les recherches par plage et par caractères génériques ne sont pas disponibles pour les champs `app_metadata`/`user_metadata`.
* Les champs utilisateur ne sont pas tokenisés comme dans v2, donc `user_id:auth0` ne correspondra pas à `user_id` avec la valeur `auth0|12345`, à la place, utilisez `user_id:auth0*`.
* Les caractères génériques peuvent être utilisés pour la correspondance de préfixe, par exemple  `name:j*`. Pour les autres utilisations des caractères génériques (par ex., la correspondance de suffixes), les littéraux doivent comporter 3 caractères ou plus. Par exemple, `name:*usa` est autorisé, mais `name:*sa` ne l’est pas
* L’extension de champ `.raw` n’est plus prise en charge et doit être supprimée. Dans v3, les champs correspondent à l’intégralité de la valeur fournie et ne comportent pas de jetons, comme c’était le cas dans V2 sans le suffixe `.raw`.
* Le champ  `connexion` n’est pas pris en charge dans v3. Vous devriez utiliser plutôt son alias `identities.connection`.

## Requêtes pour migrer

<table class="table"><thead>
<tr>
<th>Use case</th>
<th>v2</th>
<th>v3</th>
</tr>
</thead>
<tbody>
<tr>
<td>Search by date</td>
<td><code>updated_at:&gt;=2018-01-15</code></td>
<td><code>updated_at:[2018-01-15 TO *]</code></td>
</tr>
<tr>
<td>Search by date</td>
<td><code>updated_at:&gt;2018-01-15</code></td>
<td>
<code>
updated_at:\{2018-01-15 TO *]
</code>
</td>
</tr>
<tr>
<td>Search by date</td>
<td><code>updated_at:&lt;=2018-01-15</code></td>
<td><code>updated_at:[* TO 2018-01-15]</code></td>
</tr>
<tr>
<td>Search by date</td>
<td><code>updated_at:&lt;2018-01-15</code></td>
<td><code>updated_at:[* TO 2018-01-15}</code></td>
</tr>
<tr>
<td>Search by date</td>
<td><code>last_login:&lt;=2017-12</code></td>
<td><code>last_login:[* TO 2017-12]</code></td>
</tr>
<tr>
<td>String exact match</td>
<td><code>name.raw:"john richard doe"</code></td>
<td><code>name:"john richard doe"</code></td>
</tr>
<tr>
<td>Phrase contains a word</td>
<td><code>name:"richard"</code>, <code>name:richard</code></td>
<td><code>name:*richard*</code></td>
</tr>
<tr>
<td>Phrase contains a word (with less than 3 characters)</td>
<td><code>name:*ri</code>,<code>name:*a</code>, <code>name:*ab*</code></td>
<td><em>(not supported)</em></td>
</tr>
</tbody>
</table>

## Trousses SDK concernées

Les trousses SDK suivantes utilisent le moteur de recherche d’utilisateurs. Si vous les utilisez, assurez-vous que vous utilisez les versions énumérées ci-dessous (ou une version plus récente), et passez le paramètre `search_engine=v3`, lorsque vous effectuez des opérations de recherche d’utilisateurs.

<table class="table"><thead>
<tr>
<th>SDK</th>
<th>Version with support for v3</th>
<th>Impacted methods</th>
<th>Considerations</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/auth0/auth0-java">Auth0 Java</a></td>
<td>1.8.0</td>
<td>com.auth0.client.mgmt.UsersEntity.list</td>
<td>Provide a <code>UserFilter</code> with <code>withSearchEngine("v3")</code></td>
</tr>
<tr>
<td><a href="https://github.com/auth0/auth0-python">Auth0 Python</a></td>
<td>3.0.0</td>
<td>management.Users.list</td>
<td>Provide the parameter <code>search_engine='v3'</code></td>
</tr>
<tr>
<td><a href="https://github.com/auth0/node-auth0">Auth0 Node</a></td>
<td>2.0.0</td>
<td>UsersManager.getAll, ManagementClient.getUsers</td>
<td>Provide the parameter <code>search_engine:'v3'</code></td>
</tr>
<tr>
<td><a href="https://github.com/auth0/auth0.net">Auth0 .NET</a></td>
<td>3.0.0 or 4.0.0</td>
<td>Auth0.ManagementApi.IUsersClient.GetAllAsync</td>
<td>Provide a <code>GetUsersRequest</code> object with <code>SearchEngine</code> = <code>"v3"</code></td>
</tr>
<tr>
<td><a href="https://github.com/auth0/auth0-php">Auth0 PHP</a></td>
<td>5.2.0</td>
<td>Auth0.SDK.API.Management.Users.getAll</td>
<td>Provide the parameter <code>'search_engine' =&gt; 'v3'</code></td>
</tr>
<tr>
<td><a href="https://github.com/auth0/ruby-auth0">Auth0 Ruby</a></td>
<td>4.5.0</td>
<td>Auth0.Api.V2.Users.users</td>
<td>Provide the parameter <code>search_engine: 'v3'</code></td>
</tr>
</tbody>
</table>

## Extensions affectées

Les extensions suivantes utilisent le moteur de recherche d’utilisateurs. Si vous les avez installées, assurez-vous que vous utilisez les versions listées ci-dessous (ou une version plus récente).

<table class="table"><thead>
<tr>
<th>Extension</th>
<th>Version support for v3</th>
<th>Considerations</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/docs/customize/extensions/authorization-extension">Authorization Extension</a></td>
<td>2.5.0+</td>
<td>If you are using an earlier version, you need to manually update the extension from the <a href="https://manage.auth0.com/#/extensions">Extensions</a> page.</td>
</tr>
<tr>
<td><a href="/docs/customize/extensions/delegated-administration-extension">Delegated Administration</a></td>
<td>3.1+</td>
<td>If you are using an earlier version, you need to manually update the extension from the <a href="https://manage.auth0.com/#/extensions">Extensions</a> page. The <code>SEARCH_ENGINE</code> configuration setting no longer exists in 3.1, because only User Search v3 is available.</td>
</tr>
</tbody>
</table>

## Exploitez les journaux de votre locataire pour connaître les usages de la Recherche d’utilisateurs v2.

You can leverage the [logs](/docs/deploy-monitor/logs) in the [Dashboard](https://manage.auth0.com/#/logs) to find calls to the `/api/v2/users` endpoint that use the User Search v2 engine, including calls performed by SDKs. Those logs will help you identify where code changes might be needed in your applications.

Utilisez la requête suivante pour récupérer tous les journaux relatifs à la recherche d’utilisateurs v2 :  `type:w AND description:*search_engine*`. Les journaux fourniront des informations supplémentaires dans le champ de description dans les cas suivants :

* Requêtes susceptibles de produire des résultats différents dans la v3
* Requêtes dont la syntaxe est incompatible avec la v3
* Requêtes qui ne répondent pas aux exigences de la v3 en matière de pagination

Si aucun détail supplémentaire n’est spécifié dans les entrées du journal, il est probable que vos requêtes soient compatibles avec la v3. Nous vous recommandons toutefois de tester les requêtes avant de déployer vos modifications en production.

Notez qu’un seul journal du même type sera généré en l’espace de 60 minutes. Cela signifie que même si vous effectuez plusieurs appels au point de terminaison Recherche d’utilisateurs, un seul journal de chaque type sera généré par heure.