---
og:description: Describes Auth0 features affected by the Node.js v8 to Node.js v12
  migration and provides recommendations for migration.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: Migrer de Node.js 8 à Node.js 12
og:url: https://auth0.com/docs/
permalink: migrate-to-nodejs-12
title: Migrer de Node.js 8 à Node.js 12
twitter:description: Describes Auth0 features affected by the Node.js v8 to Node.js
  v12 migration and provides recommendations for migration.
twitter:title: Migrer de Node.js 8 à Node.js 12
---

As of December 31, 2019, [Node.js v8 went out of long-term support (LTS)](https://github.com/nodejs/Release#release-schedule), which means that the Node.js development team no longer back-ports critical security fixes to this version. This could potentially expose your extensibility code to security vulnerabilities. Therefore, Auth0 migrated from Node 8 to Node 12.

## Caractéristiques affectées

Les fonctions Auth0 suivantes utilisent Node 8 :

* Règles
* Hooks
* Connexions à des bases de données personnalisées
* Connexions sociales personnalisées
* Extensions

Si vous n’utilisez aucune des fonctions d’extension mentionnées ci-dessus, vous n’êtes pas concerné par cette migration.

## Tâches

Dans le cadre de l’introduction de Node 12 dans notre moteur d’exécution Webtask, nous avons effectué un certain nombre de tests pour déterminer quels modules ne sont pas compatibles entre Node 8 et 12. La plupart des clients devraient pouvoir passer à Node 12 sans problème.

Cela dit, avant d’effectuer une migration, il est fortement recommandé de tester vos :

* Règles
* Hooks
* Connexions et scripts de base de données personnalisés
* Connexions sociales personnalisées
* Extensions

Auth0 vous recommande d’abord de faire passer votre locataire de développement à l’exécution de Node 12, de terminer les tests dans votre locataire de développement et de ne migrer votre locataire de production que lorsque vous ne rencontrez plus de problèmes dans le développement.

### Activer l’exécution de Node 12

Il peut y avoir d’autres changements de comportement suite à cette migration; c’est pourquoi nous avons fourni un commutateur de migration qui vous permet de contrôler la migration de votre environnement vers la nouvelle exécution Webtask en utilisant Node 12.

Auth0 vous recommande d’abord de faire passer votre locataire de développement à l’exécution de Node 12, de terminer les tests dans votre locataire de développement et de ne migrer votre locataire de production que lorsque vous ne rencontrez plus de problèmes dans le développement.

You can query the [Management API](/docs/api) for your rules, hooks, custom database scripts, and custom social connections. This will make it easier for you to move items from your production tenant to development tenant for testing purposes.

When using the Connections endpoints in the <Tooltip tip="Management API: A product to allow customers to perform administrative tasks." cta="View Glossary" href="/docs/glossary?term=Management+API">Management API</Tooltip>, custom database scripts can be retrieved or updated using `options.customScripts`. Similarly, you can find custom social connections in `options.scripts.fetchUserProfile`.

1. Enable Node 12 on your development tenant using the new **Extensibility** panel on the [Advanced Tenant Settings](https://manage.auth0.com/#/tenant/advanced) page of the Dashboard. Choose **Node 12** from the **Runtime** drop-down.
2. Click **Save**.
3. If you use the items listed below, complete the migration steps for each of them.
4. Test your configuration.
5. Once you are sure that nothing has broken, use steps 1 and 2 above to enable Node 12 on your production tenant.

### Ajouter de nouvelles URL à la liste blanche

The Delegated Administration Extension and the <Tooltip tip="Single Sign-On (SSO): Service that, after a user logs into one applicaton, automatically logs that user in to other applications." cta="View Glossary" href="/docs/glossary?term=Single+Sign-on">Single Sign-on</Tooltip> (SSO) Dashboard Extension require allowlisting the URLs used to access extensions and custom webtasks. When you upgrade to Node 12, the URLs you use to access extensions and custom webtasks will change. This is a breaking change for these extensions.

Si vous utilisez l’une de ces extensions, vous devez autoriser les nouvelles URL en tant que Callback URL autorisées et URL de déconnexion autorisées.

La partie région de l’URL passe de 8 à 12. Si vous accédez à une extension en utilisant l’URL :

`https://{yourTenant}.us8.webtask.io/dummy-extension-url`

lorsque vous effectuerez une mise à jour vers Node 12, l’URL sera :

`https://{yourTenant}.us12.webtask.io/dummy-extension-url`

1. Go to [Dashboard > Applications > Applications > Settings](https://manage.auth0.com/#/applications/{yourClientId}/settings), and add the URL to the fields **Allowed Callback URLs** and **Allowed Logout URLs**.
2. The execution URLs will also change for custom webtasks in your Auth0 container. You must update any external applications that call those webtasks.

### Republier la règle de l’extension d’autorisation

Si vous utilisez l’Authorization Extension, elle génère une règle `auth0-authorization-extension`. Republiez cette règle à partir de l’Authorization Extension pour mettre automatiquement à jour les URL.

1. Ensure you have upgraded to the latest version of the Authorization Extension from the **Installed Extensions** tab. If the **Upgrade** button is present, click to upgrade. If the button is not present, you are already on the latest version of the extension.
2. Open the **Authorization Extension** configuration page.
3. To update the URL in the rule, publish the rule again by clicking the **Publish Rule** button.
4. Test to make sure everything is still working. If you see an Invalid API Key error after updating, click the **Rotate** button to generate a new API key.

### Configurer les URL d’administration déléguée

Si vous utilisez l’Administration Extension déléguée, la matrice suivante contient les URL mises à jour que vous devez configurer après avoir migré vers Node 12. L’URL varie en fonction de votre emplacement.

<table class="table"><thead>
<tr>
<th>Location</th>
<th>Allowed Callback URL for Node 12</th>
<th>Allowed Logout URL for Node 12</th>
</tr>
</thead>
<tbody>
<tr>
<td>US-1</td>
<td>`https://{yourTenant}.us12.webtask.io/auth0-delegated-admin/login`</td>
<td>`https://{yourTenant}.us12.webtask.io/auth0-delegated-admin`</td>
</tr>
<tr>
<td>US-3</td>
<td>`https://{yourTenant}.us.webtask.run/auth0-delegated-admin/login`</td>
<td>`https://{yourTenant}.us.webtask.run/auth0-delegated-admin`</td>
</tr>
<tr>
<td>EU</td>
<td>`https://{yourTenant}.eu12.webtask.io/auth0-delegated-admin/login`</td>
<td>`https://{yourTenant}.eu12.webtask.io/auth0-delegated-admin`</td>
</tr>
<tr>
<td>AU</td>
<td>`https://{yourTenant}.au12.webtask.io/auth0-delegated-admin/login`</td>
<td>`https://{yourTenant}.au12.webtask.io/auth0-delegated-admin`</td>
</tr>
<tr>
<td>JP-1</td>
<td>`https://{yourTenant}.jp.webtask.run/auth0-delegated-admin/login`</td>
<td>`https://{yourTenant}.jp.webtask.run/auth0-delegated-admin`</td>
</tr>
</tbody>
</table>

For example, if you are located in the USA and you use the Delegated Administration, you should update the following fields in your application’s settings:

* **Allowed Callback URLs**: `https://{yourTenant}.us12.webtask.io/auth0-delegated-admin/login`
* **Allowed Logout URLs**: `https://{yourTenant}.us12.webtask.io/auth0-delegated-admin`

### Configurer les URL du Dashboard à authentification unique

La matrice suivante contient les URL mises à jour que vous devez configurer après avoir migré vers le Node 12. L’URL varie en fonction de votre emplacement.

URL de connexion pour les administrateurs :

<table class="table"><thead>
<tr>
<th>Location</th>
<th>Allowed Callback URL</th>
</tr>
</thead>
<tbody>
<tr>
<td>US-1</td>
<td>`https://{yourTenant}.us12.webtask.io/auth0-sso-dashboard/admins/login`</td>
</tr>
<tr>
<td>US-3</td>
<td>`https://{yourTenant}.us.webtask.run/auth0-sso-dashboard/admins/login`</td>
</tr>
<tr>
<td>Europe</td>
<td>`https://{yourTenant}.eu12.webtask.io/auth0-sso-dashboard/admins/login`</td>
</tr>
<tr>
<td>Australia</td>
<td>`https://{yourTenant}.au12.webtask.io/auth0-sso-dashboard/admins/login`</td>
</tr>
<tr>
<td>Japan</td>
<td>`https://{yourTenant}.jp.webtask.run/auth0-sso-dashboard/admins/login`</td>
</tr>
</tbody>
</table>

URL de connexion pour les utilisateurs :

<table class="table"><thead>
<tr>
<th>Location</th>
<th>Allowed Callback URL</th>
</tr>
</thead>
<tbody>
<tr>
<td>US-1</td>
<td>`https://{yourTenant}.us12.webtask.io/auth0-sso-dashboard/login`</td>
</tr>
<tr>
<td>US-3</td>
<td>`https://{yourTenant}.us.webtask.run/auth0-sso-dashboard/login`</td>
</tr>
<tr>
<td>Europe</td>
<td>`https://{yourTenant}.eu12.webtask.io/auth0-sso-dashboard/login`</td>
</tr>
<tr>
<td>Australia</td>
<td>`https://{yourTenant}.au12.webtask.io/auth0-sso-dashboard/login`</td>
</tr>
<tr>
<td>Japan</td>
<td>`https://{yourTenant}.jp.webtask.run/auth0-sso-dashboard/login`</td>
</tr>
</tbody>
</table>

### Mettre à jour les extensions

La plupart des extensions utilisent le secret caché `PUBLIC_WT_URL` pour l’autorisation. Ce secret dépend de la version de l’exécution et n’est pas automatiquement mis à jour.

To update it, you need to save the extension’s settings (no changes are necessary). To do so, after switching the runtime to `Node 12`, you need to open the extension’s settings in the extensions dashboard (gear icon), and click `Save`. After that, the extensions gallery will update the `PUBLIC_WT_URL` secret based on the selected runtime.

Si vous ne mettez pas à jour le secret caché `PUBLIC_WT_URL`, vous obtiendrez l’erreur suivante :

<Frame>![Misconfiguration or Service Outage Error](/images/cdy7uua7fh8z/4mq5ebCa83XNLlbn28pp9s/beb869df9a11d188f30332030655ac9d/node-hidden-secret-error.png)</Frame>

### Mise à jour des modules épinglés

Si vous utilisez les modules intégrés suivants (c’est-à-dire les modules que vous n’avez pas explicitement requis), sachez que certaines versions ont été mises à jour pour fonctionner avec Node 12. Le tableau suivant résume les changements. Ces nouvelles versions devraient rester rétrocompatibles avec les versions précédentes.

<table class="table"><thead>
<tr>
<th>Module name</th>
<th>Old version</th>
<th>New version</th>
</tr>
</thead>
<tbody>
<tr>
<td>couchbase</td>
<td>~2.5.1</td>
<td>2.6.10</td>
</tr>
<tr>
<td>bcrypt</td>
<td>1.0.3</td>
<td>3.0.8</td>
</tr>
</tbody>
</table>

Si vous avez épinglé manuellement des modules, vous devrez peut-être les mettre à jour manuellement pour que votre code fonctionne avec Node 12.

Par exemple, vous devrez modifier :

`var bcrypt = require(‘bcrypt@1.0.3’);`

to

`var bcrypt = require(‘bcrypt’);`

ou, si le module doit être fixé à une version spécifique :

`var bcrypt = require(‘bcrypt@3.0.8’);`