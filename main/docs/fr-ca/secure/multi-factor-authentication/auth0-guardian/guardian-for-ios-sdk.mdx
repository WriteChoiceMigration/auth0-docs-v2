---
og:description: Describes how to install, use and configure options for the Guardian.swift
  iOS SDK.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: Trousse SDK Guardian.swift pour iOS
og:url: https://auth0.com/docs/
permalink: guardian-for-ios-sdk
title: Trousse SDK Guardian.swift pour iOS
twitter:description: Describes how to install, use and configure options for the Guardian.swift
  iOS SDK.
twitter:title: Trousse SDK Guardian.swift pour iOS
---

[Guardian.swift](https://github.com/auth0/Guardian.swift) allows you to integrate Auth0's Guardian multi-factor service in your own iOS app, transforming it into the second factor itself. Your users will get all the benefits of our frictionless <Tooltip tip="Multi-factor authentication (MFA): User authentication process that uses a factor in addition to username and password such as a code via SMS." cta="View Glossary" href="/docs/glossary?term=multi-factor+authentication">multi-factor authentication</Tooltip> from your app. To learn more, read [Getting Started with Apple Push Notification Service](/docs/secure/multi-factor-authentication/multi-factor-authentication-factors/configure-push-notifications-for-mfa#configure-push-notifications-for-apple-using-apn-).

## Exigences

* iOS 10+ et Swift 4.1 sont nécessaires pour utiliser Guardian.
* To use this SDK you have to configure your tenant's Guardian service with your own push notification credentials, otherwise, you would not receive any push notifications. To learn more, read [Configure Push Notifications for MFA](/docs/secure/multi-factor-authentication/multi-factor-authentication-factors/configure-push-notifications-for-mfa).

## Installer la trousse SDK Guardian pour iOS

### CocoaPods

Guardian.swift is available through [CocoaPods](http://cocoapods.org). To install it, add the following line to your Podfile:

```bash lines
pod 'Guardian', '~> 1.1.0'
```






### Carthage

Ajoutez cette ligne à votre cartfile :

```bash lines
github "auth0/Guardian.swift" ~> 1.1.0
```






## Activer les notifications poussées de Guardian

1. Go to [Dashboard > Security > Multi-factor Auth](https://manage.auth0.com/#/guardian).
2. Toggle **Push Notification** on to enable it.
3. [Configure push notifications](/docs/secure/multi-factor-authentication/multi-factor-authentication-factors/configure-push-notifications-for-mfa#configure-push-notifications-for-apple-using-apn-).

## Utilisation

`Guardian` is the core of the SDK. To use the SDK, import the library:

```swift lines
import Guardian
```



Set the domain for your tenant. Or, use the <Tooltip tip="Custom Domain: Third-party domain with a specialized, or vanity, name." cta="View Glossary" href="/docs/glossary?term=custom+domain">custom domain</Tooltip> if you configured one for your tenant:

```swift lines
let domain = "<tenant>.<region>.auth0.com"
```






### Inscription

An enrollment is a link between the second factor and an Auth0 account. When an account is enrolled you'll need it to provide the second factor required to verify the identity. If your app is not yet using push notifications or you're not familiar with it, see [Apple Push Notification Service Overview](https://developer.apple.com/go/?id=push-notifications) for details.

Vous avez besoin des informations suivantes en plus de votre domaine de locataire pour vous inscrire :

<table class="table"><thead>
<tr>
<th>Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Enrollment URI</strong></td>
<td>Value encoded in the QR code scanned from Guardian Web Widget or your enrollment ticket sent to you in email or SMS.</td>
</tr>
<tr>
<td><strong>APNS Token</strong></td>
<td>Apple APNS token for the device. It must be a string containing the 64 bytes (in hexidecimal format).</td>
</tr>
<tr>
<td><strong>Key Pair</strong></td>
<td>An RSA (private/public) key pair used to assert your identity with Auth0 Guardian.</td>
</tr>
</tbody>
</table>

Vous pourrez ensuite inscrire votre appareil :

```swift lines
Guardian
        .enroll(forDomain: "{yourTenantDomain}",
                usingUri: "{enrollmentUri}",
                notificationToken: "{apnsToken}",
                signingKey: signingKey,
                verificationKey: verificationKey
                )
        .start { result in
            switch result {
            case .success(let enrolledDevice):
                // success, we have the enrollment device data available
            case .failure(let cause):
                // something failed, check cause to see what went wrong
            }
        }
```






Vous obtiendrez ensuite les informations d’inscription, qui devraient être stockées en toute sécurité dans votre application. Elles comprennent l’identifiant de l’inscription, et le jeton de l’API Guardian associée à votre appareil pour la mise à jour ou la suppression de votre inscription.

#### Clés de signature et de vérification

Guardian.swift fournit une classe de commodité pour générer une clé de connexion :

```swift lines
let signingKey = try DataRSAPrivateKey.new()
```






Cette clé n’existe qu’en mémoire, mais vous pouvez obtenir sa représentation `Data` et la stocker en toute sécurité, par exemple dans une SQLiteDB chiffrée.

```javascript lines
// Store data
let data = signingKey.data
// perform the storage

// Load from Storage
let loadedKey = try DataRSAPrivateKey(data: data)
```






Si vous voulez simplement la stocker dans le trousseau d’iOS :

```swift wrap lines
let signingKey = try KeychainRSAPrivateKey.new(with: "com.myapp.mytag")
```






Dans l’exemple ci-dessus, une clé est créée et stockée automatiquement sous la balise fournie. Si vous souhaitez la récupérer, vous pouvez utiliser la balise :

```swift wrap lines
let signingKey = try KeychainRSAPrivateKey(tag: "com.myapp.mytag")
```






Quant à la clé de vérification, vous pouvez l’obtenir à partir de n’importe quelle `SigningKey`. Par exemple :

```swift lines
let verificationKey = try signingKey.verificationKey()
```






### Autoriser les demandes de connexion

Une fois l’inscription configurée, vous recevrez une notification poussée chaque fois que l’utilisateur devra valider son identité avec l’authentification multifacteur. Guardian fournit une méthode pour analyser les données reçues des noms de point d’accès et renvoyer une instance de `notification` prête à l’emploi.

```swift lines
if let notification = Guardian.notification(from: notificationPayload) {
    // we have received a Guardian push notification
}
```






Une fois que vous avez l’instance de notification, vous pouvez facilement autoriser la demande d’authentification en utilisant la méthode `allow`. Vous aurez également besoin de certaines informations sur l’appareil inscrit que vous avez obtenues précédemment. Si vous avez plus d’une inscription, vous devrez trouver celle qui a le même `id` que la notification (la propriété `enrollmentId`).

Lorsque vous disposez de ces informations, le paramètre `device` met en œuvre le protocole `AuthenticatedDevice` :

```swift lines
struct Authenticator: Guardian.AuthenticationDevice {
    let signingKey: SigningKey
    let localIdentifier: String
}
```






L’identifiant local est celui de l’appareil, se trouvant par défaut dans l’inscription `UIDevice.current.identifierForVendor`. Il ne vous reste plus qu’à faire l’appel suivant :

```swift lines
Guardian
        .authentication(forDomain: "{yourTenantDomain}", device: device)
        .allow(notification: notification)
        .start { result in
            switch result {
            case .success:
                // the auth request was successfuly allowed
            case .failure(let cause):
                // something failed, check cause to see what went wrong
            }
        }
```






### Rejeter les demandes de connexion

Pour refuser une demande d’authentification, appelez `reject`. Vous pouvez également envoyer un motif de rejet (facultatif). Celui-ci apparaîtra dans les journaux de Guardian.

```swift lines
Guardian
        .authentication(forDomain: "{yourTenantDomain}", device: device)
        .reject(notification: notification)
        // or reject(notification: notification, withReason: "hacked")
        .start { result in
            switch result {
            case .success:
                // the auth request was successfuly rejected
            case .failure(let cause):
                // something failed, check cause to see what went wrong
            }
        }
```






### Désinscription

Si vous souhaitez supprimer une inscription, par exemple si vous voulez désactiver l’authentification multifacteur, vous pouvez effectuer la demande suivante :

```swift lines
Guardian
        .api(forDomain: "{yourTenantDomain}")
        .device(forEnrollmentId: "{userEnrollmentId}", token: "{enrollmentDeviceToken}")
        .delete()
        .start { result in
            switch result {
            case .success:
                // success, the enrollment was deleted
            case .failure(let cause):
                // something failed, check cause to see what went wrong
            }
        }
```






### Configurer une inscription avec un mot de passe à usage unique pour les appareils mobiles

You can enable one-time passwords (OTP) as an MFA factor using the <Tooltip tip="Auth0 Dashboard: Auth0's main product to configure your services." cta="View Glossary" href="/docs/glossary?term=Auth0+Dashboard">Auth0 Dashboard</Tooltip> or <Tooltip tip="Management API: A product to allow customers to perform administrative tasks." cta="View Glossary" href="/docs/glossary?term=Management+API">Management API</Tooltip>. This option does not require a QR code and allows users to enroll manually.

To invite a user to enroll, navigate to the [Auth0 Dashboard > User Management > Users](https://manage.auth0.com/#/users) and select a user. Then, access their Details tab and use the Multi-Factor Authentication section to send an enrollment invitation.

#### Connect a resource

Vous pouvez connecter une ressource à partir du Auth0 Dashboard ou de la trousse SDK Guardian.

##### Utilisation de Auth0 Dashboard

1. Access the Auth0 login prompt and copy the provided code or a similar base32 encoded key obtained from another source. In the next step, you will enter this code into an authentication application.

   <Frame>![An example login prompt displaying a one-time code](/images/cdy7uua7fh8z/1yoqiIuERVTwCU8yfx6IM8/047513dfe1d40a22ce811b131d5ea289/OTP_Challenge_2_-_English.png)</Frame>
2. Add the code you copied to an authentication application, such as Guardian.

##### Utiliser la trousse SDK

1. Import the Guardian library.

   ```swift lines
   import Guardian
   ```


   

   
2. Create a code generator.

   ```swift lines
   let codeGenerator = try Guardian.totp(

      base32Secret: enrollmentCode,  // Enrollment code entered by user

      algorithm: .sha1			// Algorithm used by TOTP

   )
   ```


   

   
3. Retrieve generated code.

   ```swift lines
   codeGenerator.code()
   ```


   

   

#### Enter one-time code

Dans l’invite de connexion Auth0, saisissez le code que vous avez généré à l’étape précédente.

<Frame>![An example login prompt displaying a one-time code](/images/cdy7uua7fh8z/1yoqiIuERVTwCU8yfx6IM8/047513dfe1d40a22ce811b131d5ea289/OTP_Challenge_2_-_English.png)</Frame>

En sélectionnant Continue (Continuer), un message s’affiche indiquant que votre application a été ajoutée en tant que facteur d’authentification pour votre utilisateur.

#### Log in with your app

Une fois le facteur inscrit, votre utilisateur peut se connecter à l’aide de votre application. Tout d’abord, choisissez l’application Guardian comme méthode d’authentification.

<Frame>![The authentication method selection screen](/images/cdy7uua7fh8z/1k7IsU9kfP5mrXU2jfGHuT/d61e0dcd09b633dbeb2cb54e1fd49018/2025-01-27_14-47-32.png)</Frame>

Saisissez ensuite le code à usage unique dans l’invite de connexion pour vérifier votre identité.

<Frame>![The Verify Your Identity screen prompting the user for a one-time code](/images/cdy7uua7fh8z/S6uTieLjtuNUrQRMh8uch/21f1671d21ae9f61b63154ffaa21b5a2/OTP_Challenge_-_English.png)</Frame>