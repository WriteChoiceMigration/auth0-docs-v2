---
description: ''
og:description: Describes the Auth0 SDK for Angular Single Page Apps
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: Trousse SDK Auth0 pour Angular pour les applications à page unique
og:url: https://auth0.com/docs/
permalink: auth0-angular-spa
title: Trousse SDK Auth0 pour Angular pour les applications à page unique
twitter:description: Describes the Auth0 SDK for Angular Single Page Apps
twitter:title: Trousse SDK Auth0 pour Angular pour les applications à page unique
---

La trousse SDK Auth0 pour Angular est une bibliothèque JavaScript permettant de mettre en œuvre l’authentification et l’autorisation dans les applications Angular avec Auth0. Elle fournit un service, un garde d’authentification et un intercepteur HTTP pour vous permettre d’effectuer des tâches d’authentification courantes dans vos applications Angular.

The Auth0 Angular SDK handles grant and protocol details, token expiration and renewal, as well as token storage and caching. Under the hood, it implements [Universal Login](/docs/authenticate/login/auth0-universal-login) and the [Authorization Code Grant Flow with PKCE](/docs/get-started/authentication-and-authorization-flow/authorization-code-flow-with-pkce).

The library is [hosted on GitHub](https://github.com/auth0/auth0-angular) where you can [read more about the API](https://auth0.github.io/auth0-angular/).

## Installation

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

The Angular SDK is compatible with Angular SPAs version 14 and above.

</Callout>

Use the [Angular CLI](https://cli.angular.io/) to install the SDK into your project:

`ng add @auth0/auth0-angular`

## Démarrage

Commencez à intégrer la trousse SDK en important `AuthModule` dans votre projet et en le configurant pour votre application client Auth0 :

```jsx lines
import { BrowserModule } from '@angular/platform-browser';
import { NgModule } from '@angular/core';
import { AppComponent } from './app.component';

// Import the module from the SDK
import { AuthModule } from '@auth0/auth0-angular';

@NgModule({
  declarations: [AppComponent],
  imports: [
    BrowserModule,

    // Import the module into the application, with configuration
    AuthModule.forRoot({
      domain: 'YOUR_AUTH0_DOMAIN',
      clientId: 'YOUR_AUTH0_CLIENT_ID',
      authorizationParams: {
        redirect_uri: window.location.origin,
      },
    }),
  ],

  bootstrap: [AppComponent],
})
export class AppModule {}
```

## Connexion

La trousse SDK prend entièrement en charge le système d’injection de dépendances d’Angular. Pour commencer, importez le type `AuthService` dans un composant et injectez-le dans le constructeur.

Ensuite, pour lancer la connexion de l’utilisateur, utilisez la méthode `loginWithRedirect` ou `loginWithPopup` sur le service :

```jsx lines
import { Component } from '@angular/core';

// Import the AuthService type from the SDK
import { AuthService } from '@auth0/auth0-angular';

@Component({
  selector: 'app-login',
  template: '<button (click)="login">Log in</button>',
  styles: [],
})
export class LoginComponent {
  // Inject the authentication service into your component through the constructor
  constructor(public auth: AuthService) {}

  login(): void {
    // Call this to redirect the user to the login page
    this.auth.loginWithRedirect();
  }
}
```

## Déconnexion

Use `logout` to log your users out. Make sure `returnTo` is specified in **Allowed Déconnexion URLs** in your <Tooltip tip="Auth0 Dashboard: Auth0's main product to configure your services." cta="View Glossary" href="/docs/glossary?term=Auth0+Dashboard">Auth0 Dashboard</Tooltip>.

```jsx lines
import { Component } from '@angular/core';

// Import the AuthService type from the SDK
import { AuthService } from '@auth0/auth0-angular';

@Component({
  selector: 'app-logout',
  template: '<button (click)="logout">Log out</button>',
  styles: [],
})
export class LogoutComponent {
  // Inject the authentication service into your component through the constructor
  constructor(@Inject(DOCUMENT) private doc: Document, public auth: AuthService) {}

  login(): void {
    // Call this to redirect the user to the login page
    this.auth.logout({ 
      logoutParams: { 
        returnTo: this.doc.location.origin 
      }
    });
  }
}
```

## État de l’authentification

L’état de l’authentification est exposé via l’observable `isAuthenticated$` :

```html lines
<div *ngIf="auth.isAuthenticated$ | async">
  <app-login></app-login>
</div>
```

## Profil utilisateur

Le profil utilisateur de l’utilisateur authentifié est exposé via l’observable `user$` :

```html lines
<ul *ngIf="auth.user$ | async as user">
  <li>{{ user.name }}</li>
  <li>{{ user.email }}</li>
</ul>
```

En interne, cet observable est enchaîné à partir de l’observable `isAuthenticated$`, il n’est donc pas nécessaire de vérifier manuellement si l’utilisateur est connecté. Il commencera à émettre des valeurs une fois qu’un utilisateur authentifié sera disponible.

## Protéger une route

Protégez un composant d’une route à l’aide de la fonction intégrée `AuthGuard`. Les visites vers cette route en l’absence d’authentification redirigeront l’utilisateur vers la page de connexion et le renverront vers cette page après la connexion.

Le garde d’authentification doit être ajouté à une définition de route à l’aide du hook `canActivate` (ou `canActivateChild` si vous utilisez des routes enfants) :

```jsx lines expandable
import { NgModule } from '@angular/core';
import { Routes, RouterModule } from '@angular/router';
import { HomeComponent } from './unprotected/unprotected.component';
import { ProtectedComponent } from './protected/protected.component';

// Import the authentication guard
import { AuthGuard } from '@auth0/auth0-angular';

const routes: Routes = [
  {
    path: 'protected',
    component: ProtectedComponent,

    // Protéger une route by registering the auth guard in the `canActivate` hook
    canActivate: [AuthGuard],
  },
  {
    path: '',
    component: HomeComponent,
    pathMatch: 'full',
  },
];

@NgModule({
  imports: [RouterModule.forRoot(routes)],
  exports: [RouterModule],
})
export class AppRoutingModule {}
```

Le garde d’authentification prend également en charge le hook `canLoad` pour empêcher le chargement différé des modules lorsque l’utilisateur n’est pas authentifié.

## Appeler une API

The SDK contains a built-in `HttpInterceptor` that automatically attaches <Tooltip tip="Access Token: Authorization credential, in the form of an opaque string or JWT, used to access an API." cta="View Glossary" href="/docs/glossary?term=access+tokens">access tokens</Tooltip> by injecting an `Authorization` header when requests are made using Angular's `HttpClient` service.

Vous devez configurer la trousse SDK pour spécifier à quelles routes vers l’API cet en-tête doit être ajouté automatiquement, afin d’éviter toute fuite de jeton d’accès vers des destinataires que vous n’attendiez pas.

### Importer l’intercepteur HTTP

Pour commencer, importez les types dont vous aurez besoin pour intégrer l’intercepteur HTTP Auth0 dans votre application :

```jsx lines
// Import the interceptor module and the Angular types you'll need
import { HttpClientModule, HTTP_INTERCEPTORS } from '@angular/common/http';
import { AuthHttpInterceptor } from '@auth0/auth0-angular';

// Register the interceptor with your app module in the `providers` array
@NgModule({
  declarations: [],
  imports: [
    BrowserModule,
    HttpClientModule,     // Register this so that you can make API calls using HttpClient
    AppRoutingModule,
    AuthModule.forRoot(...),
  ],
  providers: [
    { provide: HTTP_INTERCEPTORS, useClass: AuthHttpInterceptor, multi: true },
  ],
  bootstrap: [AppComponent],
})
```

**Remarque :** L’intercepteur doit être enregistré manuellement auprès de votre module d’application (au lieu de l’enregistrer automatiquement), car il est conçu pour être enchaîné avec d’autres intercepteurs, et nous ne pouvons pas garantir que nous l’insérerons au bon endroit.

### Configurer l’intercepteur HTTP

Il existe différentes manières de configurer l’intercepteur en fonction de vos besoins. Une route peut être spécifiée à l’aide d’une chaîne de caractères, d’un objet contenant des options qui influencent le jeton envoyé, et elle peut également être adaptée en fonction du verbe HTTP utilisé. Les URI de route peuvent également inclure un caractère générique pour spécifier un groupe de routes.

**Note:** If an HTTP call is made but does not match a route specified in the configuration, the interceptor will be bypassed and the `Authorization` header will not be included.

Cet exemple montre des méthodes courantes pour indiquer à la trousse SDK quelles routes doivent avoir un en-tête `Authorization` :

```jsx lines expandable
// Modify your existing SDK configuration to include the httpInterceptor config
AuthModule.forRoot({
  domain: 'YOUR_AUTH0_DOMAIN',
  clientId: 'YOUR_AUTH0_CLIENT_ID',
  authorizationParams: {
    redirect_uri: window.location.origin,
  },

  // The AuthHttpInterceptor configuration
  httpInterceptor: {
    allowedList: [
      // Attach access tokens to any calls to '/api' (exact match)
      '/api',

      // Attach access tokens to any calls that start with '/api/'
      '/api/*',

      // Match anything starting with /api/accounts, but also specify the audience and scope the attached
      // access token must have
      {
        uri: '/api/accounts/*',
        tokenOptions: {
          authorizationParams: {
            audience: 'http://my-api/',
            scope: 'read:accounts',
          }
        },
      },

      // Matching on HTTP method
      {
        uri: '/api/orders',
        httpMethod: 'post',
        tokenOptions: {
          authorizationParams: {
            audience: 'http://my-api/',
            scope: 'write:orders',
          }
        },
      },

      // Using an absolute URI
      {
        uri: 'https://your-domain.auth0.com/api/v2/users',
        tokenOptions: {
          authorizationParams: {
            audience: 'https://your-domain.com/api/v2/',
            scope: 'read:users',
          }
        },
      },
    ],
  },
});
```

**Note:** `tokenOptions` is passed directly to the `getTokenSilently` method on the underlying SPA SDK. Please see [the documentation](https://auth0.github.io/auth0-spa-js/interfaces/gettokensilentlyoptions.html) for more detail on the properties that are accepted.

### Appeler une API

Effectuez votre appel API en utilisant le service `HttpClient` d’Angular. Les jetons d’accès doivent être automatiquement inclus via l’en-tête `Authorization` pour les routes qui correspondent à la configuration.

```jsx lines
export class MyComponent {
  constructor(private http: HttpClient) {}

  callApi(): void {
    this.http.get('/api').subscribe(result => console.log(result));
  }
}
```

Veuillez noter qu’aucune opération supplémentaire n’est requise sur le site d’appel pour fournir des jetons ou d’autres files d’attente d’autorisation; tout cela est géré par l’intercepteur et la configuration du module.