---
description: ''
og:description: Describes how browser changes, such as the SameSite cookie attribute,
  affects your web applications that embed content from third-party domains.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: Modifications des attributs du témoin SameSite
og:url: https://auth0.com/docs/
permalink: samesite-cookie-attribute-changes
title: Modifications des attributs du témoin SameSite
twitter:description: Describes how browser changes, such as the SameSite cookie attribute,
  affects your web applications that embed content from third-party domains.
twitter:title: Modifications des attributs du témoin SameSite
---

Les témoins, qui sont utilisés pour l’authentification et le maintien des sessions, peuvent être sécurisés en définissant des attributs. Auth0 utilise des témoins dans les cas suivants :

* OIDC Enterprise avec `form_post`
* <Tooltip tip="Security Assertion Markup Language (SAML): Standardized protocol allowing two parties to exchange authentication information without a password." cta="View Glossary" href="/docs/glossary?term=SAML">SAML</Tooltip> HTTP-POST Binding
* Message Web (appelé également `checkSession`)

## Attributs SameSite

You can add [SameSite cookie](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie/SameSite) attributes in the `set-cookie` HTTP response header to restricts browser behavior. It may prevent the browser from sending the cookie's `key=value` pair based on the type of interaction that triggered the HTTP request.

Les valeurs d’attribut acceptées sont les suivantes :

| Attribute | Description |
| --- | --- |
| `strict` | Send the cookie if the user is navigating within the website origin bounds |
| `lax` | Send the cookie if the user is navigating between domains but not for 3rd party contexts (iframes or posts) |
| `none` | Send the cookie with requests crossing the website origin bounds. Unless other conditions are present (i.e., third-party cookies are blocked), do not send the cookie. |

Voici quelques-uns des attributs de témoin qui vous sont peut-être familiers :

| Attribute | Description |
| --- | --- |
| `httpOnly` | Allows a cookie to be sent only with HTTP requests; not readable using Javascript's `document.cookie` |
| `secure` | Allows the browser to send the cookie only to a secure context; whether the context is considered secure or not is browser-dependent, but this typically requires the use of HTTPS |
| `max-age / expires` | Controls whether the cookie is a **session** cookie (e.g., dropped when your browser terminates its session) or **persistent** (e.g., the cookie persists beyond the browser session) |

Le navigateur, dès réception, analyse les en-têtes et met à jour sa boîte à témoins en conséquence.

## Modifications des témoins des navigateurs

Depuis février 2020, Google Chrome v80 gère les témoins d’une manière différente. Auth0 a mis en œuvre les changements suivants dans la manière dont les témoins sont traités :

* La valeur des témoins dont l'attribut `SameSite` n'a pas été défini sera `lax`.
* Cookies with `SameSite=none` must be secured; otherwise they cannot be saved in the browser’s cookie jar

L’objectif de ces modifications était d’améliorer la sécurité et de réduire les attaques CSRF.

Ces modifications concernent les témoins suivants :

* `auth0` (traite les sessions utilisateur)
* `auth0-mf` (handles information relevant to <Tooltip tip="Multi-factor authentication (MFA): User authentication process that uses a factor in addition to username and password such as a code via SMS." cta="View Glossary" href="/docs/glossary?term=multi-factor+authentication">multi-factor authentication</Tooltip>)
* `did` (identifiant d’un appareil/agent utilisateur)

Pour ces témoins, Auth0 :

* Définira l’attribut `SameSite` sur `none`, le témoin exigeant l’utilisation de HTTPS (quel que soit l’environnement).
* Définira des témoins de secours au cas où un navigateur ancien ne prendrait pas en charge le réglage de `SameSite` sur `None`. Ces témoins de secours sont `auth0_compat`, `auth0-mf_compat` et `did_compat`.

L’illustration ci-dessous montre ce qu’il se passe lors d’une nouvelle interaction. L’utilisateur final demande une page qu’il n’a pas encore visitée. Le serveur modifie le rendu de la page lorsque le visiteur revient et met en place un témoin seen. La partie grise de l’en-tête `set-cookie` est la véritable `key=value` du témoin. La partie rouge correspond aux attributs du témoin que le navigateur stocke dans la boîte à témoins pour décider ultérieurement s’il doit inclure la paire `key+value` dans les requêtes.

<Frame>![sameSite Cookie Attributes Fresh Interaction Flow](/images/cdy7uua7fh8z/ItaoOzUnri9dkCkZ3V0dj/e64711c0f3ae5c361fe2321e3666b1cf/cookie-fresh-interaction.png)</Frame>

The following diagram shows what happens if you make the same request using the same browsing session. The request goes to the same server, and because the cookie attributes don’t prohibit the seen cookie to be sent, it is automatically included as a cookie header in the request. The server will now respond differently based on the fact that it received this cookie.

<Frame>![sameSite Cookie Attributes Cookie Return Interaction flow](/images/cdy7uua7fh8z/4dc2HWnmPBOV6cvdKbNM6g/50149f55e38fdf7453944932a3ef9d1c/cookie-return-interaction.png)</Frame>

## Caractéristiques affectées

Le tableau ci-dessous montre comment les modifications de l’attribut `SameSite` peut affecter vos applications.

| App Behavior | Affected by Change |
| --- | --- |
| Cookies set as `sameSite=none` when the website is not `https://` | Yes |
| Cookies don't have explicit `sameSite` attribute value set and are required in a cross-origin context (such as HTTP form\_post, embedding an iframe) | Yes |
| Native apps (everything not cookies + web based) | No (M2M) |
| Already setting an explicit `sameSite` cookie attribute value | No |
| Different subdomain on the same eTLD+1 (app is on the same eTLD+1 as the custom domain Auth0 tenant) | Potentially |

If you are using a web app with sessions (e.g. for saving user preferences, shopping carts, etc.), and you allow users to sign in using <Tooltip tip="Identity Provider (IdP): Service that stores and manages digital identities." cta="View Glossary" href="/docs/glossary?term=identity+providers">identity providers</Tooltip> such as Google, Github, or Auth0, then you rely on cookies to achieve that functionality. There are browser cookie behavior changes that may break the user experience. Google Chrome, for example, is the first browser vendor to roll out a change that might not be compatible with your web application.

Vous remarquerez peut-être que les spécifications de Google Chrome et de Microsoft Edge concernant le réglage de `SameSite` à un état indéfini ont changé, passant de `SameSite` à `none` par défaut, puis à `lax`.

For example, let’s say you build a new UI and have several services that you proxy to via an Auth0 gateway. At this gateway, you create a cookie session. If you make a cross-origin request, you may see this warning in the Javascript console:

`A cookie associated with a cross-site resource (URL) was set without the SameSite attribute. A future release of Chrome will only deliver cookies with cross-site requests if they are set with SameSite=None and Secure. You can review cookies in developer tools under Application>Storage>Cookies and see more details at https://www.chromestatus.com/feature/5088147346030592 and https://www.chromestatus.com/feature/5633521622188032`

## Mesures à prendre

Pour vous préparer à ce changement, vous devez :

* Review the list of [unsupported browsers](https://www.chromium.org/updates/same-site/incompatible-clients).
* Définir votre application pour qu’elle utilise `SameSite=none` si elle utilise `response_mode=form_post` lors des interactions avec Auth0 (notez que Chrome n’accepte aucune exception, même pour `localhost`).
* Set your cookie as secure if its `SameSite` attribute equals `None.` Otherwise, it will be rejected by the browser. If you use HTTP for your Callback URLs, these will break if you use such cookies for binding the authorization request state/<Tooltip tip="Nonce: Arbitrary number issued once in an authentication protocol to detect and prevent replay attacks." cta="View Glossary" href="/docs/glossary?term=nonce">nonce</Tooltip>. Therefore, you must either use HTTPS or set `SameSite=lax`