---
og:description: Describes the workflow with the auth0-spa-js SDK to support multi-site
  session management.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: Gérer les sessions multisites avec la trousse SDK Auth0
og:url: https://auth0.com/docs/
permalink: manage-multi-site-sessions
title: Gérer les sessions multisites avec la trousse SDK Auth0
twitter:description: Describes the workflow with the auth0-spa-js SDK to support multi-site
  session management.
twitter:title: Gérer les sessions multisites avec la trousse SDK Auth0
---

## Sessions de courte durée

This workflow shows how the auth0-spa-js SDK should be implemented to support multi-site session management. In this scenario, it is assumed that the tenant <Tooltip tip="Single Sign-On (SSO): Service that, after a user logs into one applicaton, automatically logs that user in to other applications." cta="View Glossary" href="/docs/glossary?term=SSO">SSO</Tooltip> Inactivity Timeout is set to 300 seconds, and the <Tooltip tip="ID Token: Credential meant for the client itself, rather than for accessing a resource." cta="View Glossary" href="/docs/glossary?term=ID+Token">ID Token</Tooltip> Expiration of each SPA application is set to 150 seconds. This is considered a "short-lived" session.

### Caractéristiques de la trousse SDK

#### Flux PKCE

For all methods of retrieving an ID Token or <Tooltip tip="Access Token: Authorization credential, in the form of an opaque string or JWT, used to access an API." cta="View Glossary" href="/docs/glossary?term=Access+Token">Access Token</Tooltip>, the SDK manages all the intricacies of the Proof Key for Code Exchange workflow. No additional effort or configuration is needed for this to work.

#### Lien profond

Pour améliorer l’expérience utilisateur, la trousse SDK inclut un paramètre `appState` pour la méthode `loginWithRedirect()`. Les détails sur l’application actuelle sont regroupés dans le cadre de la requête adressée au serveur d’authentification qui sera renvoyée une fois l’authentification réussie. Permettre une continuation fluide du parcours utilisateur.

Dans le Démarrage rapide, le composant `PrivateRoute` définit un paramètre d’état de `targetUrl` et la fonction `onRedirectCallback` de `index.js` extrait cette valeur pour rediriger l’utilisateur une fois l’authentification terminée.

#### Stockage des jetons

To keep the returned tokens stored in the safest manner possible all tokens are placed into a local cache. The ID and Access Tokens are stored as pairs with the <Tooltip tip="Audience: Unique identifier of the audience for an issued token. Named aud in a token, its value contains the ID of either an application (Client ID) for an ID Token or an API (API Identifier) for an Access Token." cta="View Glossary" href="/docs/glossary?term=audience">audience</Tooltip> and scope values being used to retrieve the tokens as needed.

De plus, les jetons de cache sont supprimés une fois que le jeton d’ID ou d’accès expire, de sorte que si un jeton se trouve dans le cache, il peut être considéré comme étant toujours valide.

#### Appeler des API

The `getTokenSilently()` method is used to leverage the token cache first, and if none exists, will launch an invisible iframe to retrieve a new token. For this purpose all requests to APIs can use this method to construct the bearer token header without the need for additional logic to handle for expired tokens.

Dans le Démarrage rapide, l’affichage `ExternalService` fait une requête à l’API express en utilisant cette caractéristique.

#### Avertir les utilisateurs de continuer leurs sessions

Dans le cas où un utilisateur n’a effectué aucune action susceptible d’entraîner la mise à jour de la session Auth0, Auth0 vous recommande d’envoyer un avertissement à l’utilisateur pour qu’il choisisse de poursuivre explicitement sa session.

L’intention de cette approche permet à la session de devenir inactive si l’utilisateur n’est plus présent, mais fournit par ailleurs un moyen de déclencher l’actualisation silencieuse du jeton afin que l’utilisateur puisse poursuivre sa session sans avoir besoin d’être à nouveau invité à fournir ses informations d’identification.

To learn more about inactivity timers and timeout modals, read [Application-specific logout URLs](/docs/manage-users/sessions/configure-session-lifetime-settings).

### Exemple de flux de travail

1. Initial Authentication
2. Maintaining Auth0 Session
3. SSO fluide
4. Prompting user to extend session
5. L’utilisateur se déconnecte explicitement de l’application
6. User returns to initial app after logging out

#### Authentification initiale

1. New tab is opened
2. Requests to login
3. User enters credentials
4. SSO cookie (with expiration) is set
5. Token exchange performed

<Frame>![Diagram of Initial Authentication flow](/images/cdy7uua7fh8z/2voC3vs36CJJlpDu4xl06Y/310fe5afe79ad7d083833baa2690dfa4/initial-authentication.png)</Frame>

#### Maintien de la session Auth0

1. User requests data from protected resource
2. `getTokenSilently()` called
3. Resource retrieved
4. User updates data from protected resource
5. `getTokenSilently()` called

   1. Iframe opened
   2. Token exchange performed
6. Resource is updated

<Frame>![Diagram of maintaining a session](/images/cdy7uua7fh8z/7CI29ouvhuJ4TFC1G2C5n8/4d2bd0c9372a6cc16e75fc76f438a0bd/maintain-auth0-session.png)</Frame>

#### SSO fluide

1. User navigates to a private route
2. Check with `isAuthenticated()`
3. If false, `loginWithRedirect()`

<Frame>![Diagram of seamless SSO flow for sessions](/images/cdy7uua7fh8z/38heJlnN0letWMVhpTtXad/4d4127150fb818522ea29eea28ccc00e/seamless-sso.png)</Frame>

#### Inviter l’utilisateur à prolonger la session

1. At 240 seconds prompt user with keep session alive with modal that lasts 60 seconds
2. If they choose to maintain session, `getTokenSilently()`

<Frame>![Diagram of prompting a user to maintain a session](/images/cdy7uua7fh8z/6kH2G3oclCfSudwd0hJEUM/70651da37771c9945c5a34dcad409d9f/prompt-user-extend-session.png)</Frame>

#### L’utilisateur se déconnecte explicitement de l’application

1. User chooses to logout
2. `logout()` called

   1. Token cache cleared
   2. Call `/oidc/logout`
   3. Clear SSO cookie & delete session data
   4. Redirect user to logout page

<Frame>![Diagram of a user logging out](/images/cdy7uua7fh8z/4b55FKM2vZBoskXTPY4nxs/1a9e69437677f2cfac9a3d8e6bff7ffe/user-explicitly-logs-out-of-app.png)</Frame>

#### L’utilisateur est renvoyé à l’application initiale après s’être déconnecté

1. User requests data from protected resource
2. `getTokenSilently()` called
3. Application-dependent behavior

<Frame>![Diagram of user returning to application after logging out](/images/cdy7uua7fh8z/3geXGwsXkIgFkwopoGoLMx/01685b6b8e8473c6ce6f26e59b402cf3/user-returns-to-initial-app.png)</Frame>

## Sessions de longue durée

Auth0 supporte les sessions de longue durée pour les forfaits d’entreprise. Avec les sessions de longue durée, vous pouvez configurer des limites de session avec jusqu’à 100 jours d’inactivité (délai d’inactivité) et jusqu’à un an de durée totale (délai d’expiration absolu). Si vous disposez d’échéanciers trimestriels, mensuels ou autres, cela vous permet de réduire les frictions pour les utilisateurs finaux et de fournir un accès à du contenu et des fonctionnalités à faible risque. De plus, les sociétés de médias peuvent tirer parti de sessions de longue durée pour améliorer l’expérience utilisateur grâce à un accès transparent au contenu. Vous pouvez également faire des choix entre des sessions de longue durée et une validation de mot de passe en fonction de vos exigences en matière d’expérience utilisateur et de sécurité

Workflow details would change in the case of a long-lived session where the application session would most likely be shorter than the [Single Sign-on (SSO)](/docs/authenticate/single-sign-on) session.

To learn more, read [Configure Session Lifetime Limits](/docs/manage-users/sessions/configure-session-lifetime-settings) and [Update Access Token Lifetime](/docs/secure/tokens/access-tokens/update-access-token-lifetime).

##

## Learn more

* [Troubleshoot Invalid Token Errors](/docs/troubleshoot/basic-issues/invalid-token-errors)
* [Check API Calls](/docs/troubleshoot/authentication-issues/check-api-calls)