---
og:description: Learn how to enable automatic user migration with your custom database.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: Configurer la migration automatique à partir de votre base de données
og:url: https://auth0.com/docs/
permalink: configure-automatic-migration-from-your-database
title: Configurer la migration automatique à partir de votre base de données
twitter:description: Learn how to enable automatic user migration with your custom
  database.
twitter:title: Configurer la migration automatique à partir de votre base de données
---

Configure your Database connection to automatically migrate your users from an external user store to Auth0 with [custom database action scripts](/docs/authenticate/database-connections/custom-db/templates).

<Warning>

If you try to use more than one migration method (for example, automatic migration then bulk user import), you may encounter a `DUPLICATED_USER` error. This error indicates that the user exists in Auth0's internal user store but not in your tenant. To correct this error, delete the user with the Auth0 Management API [Delete a Connection User](https://auth0.com/docs/api/management/v2#!/Connections/delete_users_by_email) endpoint and then re-attempt the import.

</Warning>

## Configurez la connexion à la base de données en tant que personnalisée.

Créez une connexion à la base de données, puis définissez-la comme personnalisée.

1. Go to [Auth0 Dashboard > Authentication > Database](https://manage.auth0.com/#/connections/database) and select the database to view.
2. Select the **Custom Database** view, and toggle on **Use my own database**.

   <Frame>![Auth0 Dashboard Authentication Database Connection Custom Database Settings Use Own Database Enabled](/images/cdy7uua7fh8z/11HPAdVwJMmnWbzMVjHCJ8/f75ff47f613a41778f266643f29ab2b1/2025-02-27_17-25-36.png)</Frame>
3. Select the **Settings** view, toggle on **Import Users to Auth0**, and select **Save**.

## Configurez les scripts d’action de base de données.

Sélectionnez l’aperçu **Base de données personnalisée**, puis localisez **Scripts d’action de base de données**.

<Frame>![Dashboard Authentication Database Connection Custom Database tab Database Action Scripts](/images/cdy7uua7fh8z/4LBIvvjaABo51It4eVCmX3/4ef14765c79cc5b7ecfa3f3155caa9eb/Screen_Shot_2021-05-18_at_8.54.55_PM.png)</Frame>

### Connexion

The [Login](/docs/authenticate/database-connections/custom-db/templates/login) script executes each time a user who is not found in the Auth0 attempts to log in. It verifies that the user exists in the external user store without reprompting the user for their password.

### Obtenir un utilisateur

The [Get User](/docs/authenticate/database-connections/custom-db/templates/get-user) script executes after any of the following scenarios:

* Un utilisateur initie une tentative d’inscription.
* Un utilisateur initie un processus de changement de mot de passe.
* Un utilisateur saisit son identifiant de connexion lorsqu’il utilise Identifier First + Données biométriques.
* The <Tooltip tip="Management API: A product to allow customers to perform administrative tasks." cta="View Glossary" href="/docs/glossary?term=Management+API">Management API</Tooltip> [Update a User's Email or Username](https://auth0.com/docs/api/v2#!/Users/patch_users_by_id) or [Create User](https://auth0.com/docs/api/management/v2#!/Users/post_users) endpoint is called.

Si un utilisateur qui n’a pas été migré confirme un changement de mot de passe et se connecte avec succès, son profil utilisateur sera créé dans Auth0 avec le nouveau mot de passe. Ce profil utilisateur contient toutes les données renvoyées dans le script Obtenir l’utilisateur. Toutes les connexions ultérieures pour cet utilisateur seront effectuées directement dans Auth0.

## Vérifiez que la migration des utilisateurs est complète.

Verify that all users have been migrated to the Auth0 user store using the <Tooltip tip="Auth0 Dashboard: Auth0's main product to configure your services." cta="View Glossary" href="/docs/glossary?term=Auth0+Dashboard">Auth0 Dashboard</Tooltip> or the Auth0 Management API.

1. Go to [Auth0 Dashboard > User Management > Users](https://manage.auth0.com/#/users), and review the list of users.
2. Use the Management API [List or Search Users](https://auth0.com/docs/api/v2#!/Users/get_users) endpoint.

## Déconnectez le magasin d’utilisateurs externe.

Reconfigurer les scripts d’action de base de données car aucune opération ne fonctionne. Cela empêchera Auth0 d’accéder à votre magasin d’utilisateurs externe pour authentifier les utilisateurs.

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

Make sure to leave the **Import Users to Auth0** option turned on. If you turn this option off Auth0 will only use the scripts to authenticate and perform other user actions instead of using the users that were imported locally.

</Callout>

1. Go to [Auth0 Dashboard > Authentication > Database](https://manage.auth0.com/#/connections/database), and then select your Database connection.
2. Switch to the **Custom Database** view, and then locate **Database Action Scripts.**
3. Update the **Login** script.

   ```javascript lines
   function login (email, password, callback) {
     return callback(null, null);
   }
   ```


   

   
4. Update the **Get User** script.

   ```javascript lines
   function getByEmail (email, callback) {
     return callback(null, null);
   }
   ```


   

   

## Résoudre les problèmes de migration des utilisateurs.

If you encounter any issues with automatic migration, first read [Custom Database Connection and Action Script Best Practices](/docs/authenticate/database-connections/custom-db/custom-database-connections-scripts).

### L’utilisateur existe déjà.

Les scénarios les plus courants relatifs à quand vous pourriez rencontrer ce problème :

* Vous supprimez un utilisateur de votre connexion à la base de données, puis vous essayez de le recréer.
* Vous essayez de créer un nouvel utilisateur sur votre connexion à la base de données alors que ledit utilisateur existe déjà dans votre magasin d’utilisateurs externe.
* Un processus de migration d’un utilisateur a été interrompu.

Au cours du processus de migration de l’utilisateur, Auth0 crée premièrement un profil utilisateur partiel dans un magasin d’utilisateurs interne, puis crée un profil utilisateur complet dans votre connexion à la base de données. Si un problème survient qui empêche la création de ce profil utilisateur complet, vous pourriez faire face à l’erreur `The user already exists` .

Vous pouvez généralement résoudre ce problème en supprimant l’utilisateur de la connexion à la base de données, en supprimant l’utilisateur du magasin d’utilisateurs interne, puis en réessayant le processus de migration.

1. Check the `console.log()` statements with the [Real-time Webtask Logs extension](/docs/customize/extensions/real-time-webtask-logs).
2. Delete the user with the Management API [Delete a User](https://auth0.com/docs/api/management/v2#!/Users/delete_users_by_id) endpoint.
3. Delete the user with the Management API [Delete a Connection User](https://auth0.com/docs/api/management/v2#!/Connections/delete_users_by_email) endpoint.
4. Instruct the user to log in or change their password to reattempt migration.

### Métadonnées manquantes.

Si un utilisateur est interrompu pendant le processus de connexion ou de changement de mot de passe qui initie la migration, Auth0 peut ne pas être en mesure de transférer ses métadonnées (`user_metadata` ou `app_metadata`) avec ses autres données de profil.

You can mitigate this scenario by creating an [Action](/docs/customize/actions) that verifies the user's profile is missing metadata, retrieves it from the external use store, and then stores it in Auth0.

## Learn more

* [Bulk User Imports](/docs/manage-users/user-migration/bulk-user-imports)
* [User Import / Export Extension](/docs/manage-users/user-migration/user-import-export-extension)