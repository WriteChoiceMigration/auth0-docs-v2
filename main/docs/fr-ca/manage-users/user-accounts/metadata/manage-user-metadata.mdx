---
og:description: Learn how to use the post-login Action trigger to modify user_metadata
  and app_metadata as part of a user’s login flow.
og:image: https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
og:title: Gérer les métadonnées des utilisateurs avec le déclencheur d’action après
  l’ouverture de session
og:url: https://auth0.com/docs/
permalink: manage-user-metadata
title: Gérer les métadonnées des utilisateurs avec le déclencheur d’action après l’ouverture
  de session
twitter:description: Learn how to use the post-login Action trigger to modify user_metadata
  and app_metadata as part of a user’s login flow.
twitter:title: Gérer les métadonnées des utilisateurs avec le déclencheur d’action
  après l’ouverture de session
---

Auth0 provides a rich system for storing [metadata](/docs/manage-users/user-accounts/metadata) on the Auth0 user profile. You can configure a `post-login` trigger to modify `user_metadata` and `app_metadata` as part of a user’s login flow. Post-login triggers are useful for tasks such as storing application-specific data on the user profile, capturing user operation logs, mapping <Tooltip tip="Security Assertion Markup Language (SAML): Standardized protocol allowing two parties to exchange authentication information without a password." cta="View Glossary" href="/docs/glossary?term=SAML">SAML</Tooltip> attributes to the metadata field, or caching expensive operation values on the User profile for re-used in future logins.

L’objet `post-login``api` fournit des opérations communes qui peuvent être effectuées dans ce déclencheur. Pour gérer les métadonnées de l’utilisateur, nous voulons utiliser les méthodes `api.user.setAppMetadata` et `api.user.setUserMetadata`. Par exemple, pour éviter qu’un comportement ne s’exécute plusieurs fois pour un utilisateur spécifique, réfléchissons une action qui ressemble à ceci :

```js lines
exports.onExecutePostLogin = async (event, api) => {
  if (event.user.app_metadata.didAnExpensiveTask) {
    console.log(`Skipping the expensive task because it already occurred for ${event.user.email}.`);
    return;
  }
  // do and expensive task
  api.user.setAppMetadata("didAnExpensiveTask", true);
};
```






Ici, nous avons ajouté une vérification au début de l’action pour voir si nous avons déjà effectué la tâche volumineuse pour cet utilisateur. Si le champ de métadonnées existe, nous retournons à la fonction.

À la fin de l’action, nous appelons `api.user.setAppMetadata` pour signaler que nous souhaitons stocker des métadonnées dans l’objet utilisateur. À la fin de l’exécution de chaque déclencheur, les actions mettront à jour le profil utilisateur en une seule opération. Si plusieurs appels sont faits aux actions `setUserMetadata`, même s’ils sont faits dans différentes actions faisant partie du même flux, les actions ne mettront à jour le profil utilisateur qu’une seule fois, à la fin de l’exécution du déclencheur.

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

Multiple `setUserMetadata` or `setAppMetadata` calls will be batched together into a single user profile update at the end of the trigger’s execution, even if they are made by different Actions.

</Callout>

## Meilleures pratiques

Veillez à ne pas stocker trop de données dans le profil Auth0. Ces données sont destinées à être utilisées à des fins d’authentification et d’autorisation, et les utilisateurs peuvent modifier leur propre champ `user_metadata`; il convient donc de ne pas y stocker de données sensibles. Les métadonnées et les capacités de recherche d’Auth0 ne sont pas conçues pour la recherche marketing ou toute autre activité nécessitant une fréquence de recherche ou de mise à jour élevée. Votre système risque de rencontrer des problèmes de croissance et de performance si vous utilisez Auth0 à cette fin. Une meilleure approche consiste à stocker les données dans un système externe et à stocker un pointeur (l’ID de l’utilisateur) dans Auth0 afin que les systèmes dorsaux puissent récupérer les données en cas de besoin.

## Limites anti-attaques

<Warning>

Setting user and app metadata is subject to your tenant’s rate limits and may affect login throughput.

</Warning>

Even though a single call is made to update the user profile, that operation is still subject to your tenant’s "Write User" [rate limits](/docs/troubleshoot/customer-support/operational-policies/rate-limit-policy/management-api-endpoint-rate-limits). If the Rate Limit is hit when attempting to update metadata, Actions will retry the request as long as a `429` HTTP status code is returned. The delay between retries is governed by the value of the `X-RateLimit-Reset` header returned as part of the `429` response.

## Redirections

In the event of a Redirect invoked with `api.redirect.sendUserTo()`, any pending user or app metadata updates will be applied to the user profile before the user is redirected to the external site. To learn more, see [Redirecting With Actions](/docs/customize/actions/explore-triggers/signup-and-login-triggers/login-trigger/redirect-with-actions).

## Learn more

* [Redirect with Actions](/docs/customize/actions/explore-triggers/signup-and-login-triggers/login-trigger/redirect-with-actions)